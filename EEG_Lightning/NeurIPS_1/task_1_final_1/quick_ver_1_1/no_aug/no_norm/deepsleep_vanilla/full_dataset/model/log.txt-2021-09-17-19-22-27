use determinstic 
use cross channel norm :  none
generate predict :  True
load test data from file /data1/wduong_experiment_data/EEG_Dassl_Lightning/da_dataset/NeurIPS_1/task_1_final_test_case_1/full_test_sleep.mat
current r_op file :  /data1/wduong_experiment_data/EEG_Dassl_Lightning/da_dataset/NeurIPS_1/task_1_final_test_case_1/_r_op.mat
generate new list r op
current dataset 
source_data subject_idx 0 has shape : (1674, 2, 3000), with range scale (158.5289306640625,-144.13113403320312) 
source_data subject_idx 1 has shape : (1467, 2, 3000), with range scale (171.13333129882812,-167.977783203125) 
source_data subject_idx 2 has shape : (1402, 2, 3000), with range scale (137.38583374023438,-127.95970916748047) 
source_data subject_idx 3 has shape : (1782, 2, 3000), with range scale (141.63003540039062,-156.5120849609375) 
source_data subject_idx 4 has shape : (1611, 2, 3000), with range scale (197.0,-183.23736572265625) 
source_data subject_idx 5 has shape : (1019, 2, 3000), with range scale (146.006591796875,-154.1604461669922) 
source_data subject_idx 6 has shape : (1284, 2, 3000), with range scale (186.0,-207.0) 
source_data subject_idx 7 has shape : (1278, 2, 3000), with range scale (176.0,-176.0) 
source_data subject_idx 8 has shape : (1230, 2, 3000), with range scale (139.41880798339844,-150.93528747558594) 
source_data subject_idx 9 has shape : (2005, 2, 3000), with range scale (124.29669952392578,-137.06593322753906) 
source_data subject_idx 10 has shape : (1927, 2, 3000), with range scale (179.60220336914062,-207.0) 
source_data subject_idx 11 has shape : (978, 2, 3000), with range scale (166.0,-173.72821044921875) 
source_data subject_idx 12 has shape : (987, 2, 3000), with range scale (184.0,-184.0) 
source_data subject_idx 13 has shape : (1087, 2, 3000), with range scale (141.13845825195312,-162.45079040527344) 
source_data subject_idx 14 has shape : (1020, 2, 3000), with range scale (140.40072631835938,-165.1575164794922) 
source_data subject_idx 15 has shape : (1066, 2, 3000), with range scale (127.63320922851562,-127.4949951171875) 
source_data subject_idx 16 has shape : (1986, 2, 3000), with range scale (190.0,-189.0) 
source_data subject_idx 17 has shape : (1953, 2, 3000), with range scale (189.0,-167.0) 
data shape before predict :  (25756, 1, 2, 3000)
Loading dataset: MultiDatasetV1
data root :  /data1/wduong_experiment_data/EEG_Dassl_Lightning/da_dataset/NeurIPS_1
dataset dir :  task_1_final_case_1
file name :  full_target_sleep.mat
r_op file path :  None
test subject idx after split :  None
train-valid idx after split :  [30 53 42 59 22 38  2 55 26  8 68 13 71 76 16 27 45 57 80 73 43 60 40 62
 54 82 69  6  3 78 50  7 33 72 48  4 15 17  5 75 41 63 34 28 11 61 23 10
 31 52 66  1 32 74 14 56 19 29 51 49 24 35 18  0 81 20 77 25 37 46 39 65
 58 12 70 36 21  9 79 67 64 47 44]
cross subject split for valid data
train subject after split :  [57, 80, 73, 43, 60, 40, 62, 54, 82, 69, 6, 3, 78, 50, 7, 33, 72, 48, 4, 15, 17, 5, 75, 41, 63, 34, 28, 11, 61, 23, 10, 31, 52, 66, 1, 32, 74, 14, 56, 19, 29, 51, 49, 24, 35, 18, 0, 81, 20, 77, 25, 37, 46, 39, 65, 58, 12, 70, 36, 21, 9, 79, 67, 64, 47, 44]
valid subject after split :  [30, 53, 42, 59, 22, 38, 2, 55, 26, 8, 68, 13, 71, 76, 16, 27, 45]
there is no test file 
train subjects :  [57, 80, 73, 43, 60, 40, 62, 54, 82, 69, 6, 3, 78, 50, 7, 33, 72, 48, 4, 15, 17, 5, 75, 41, 63, 34, 28, 11, 61, 23, 10, 31, 52, 66, 1, 32, 74, 14, 56, 19, 29, 51, 49, 24, 35, 18, 0, 81, 20, 77, 25, 37, 46, 39, 65, 58, 12, 70, 36, 21, 9, 79, 67, 64, 47, 44]
Train subject 57 has shape : (972, 1, 2, 3000), with range scale (146.44615173339844,-143.03076171875) 
Train subject 80 has shape : (1752, 1, 2, 3000), with range scale (187.40512084960938,-192.0) 
Train subject 73 has shape : (1770, 1, 2, 3000), with range scale (195.23419189453125,-194.0) 
Train subject 43 has shape : (1701, 1, 2, 3000), with range scale (183.6600799560547,-196.0) 
Train subject 60 has shape : (1581, 1, 2, 3000), with range scale (177.0,-175.1846160888672) 
Train subject 40 has shape : (969, 1, 2, 3000), with range scale (158.65615844726562,-185.22052001953125) 
Train subject 62 has shape : (978, 1, 2, 3000), with range scale (201.0,-201.0) 
Train subject 54 has shape : (917, 1, 2, 3000), with range scale (152.43174743652344,-174.1714324951172) 
Train subject 82 has shape : (1361, 1, 2, 3000), with range scale (182.0,-182.0) 
Train subject 69 has shape : (818, 1, 2, 3000), with range scale (176.0,-178.0) 
Train subject 6 has shape : (1240, 1, 2, 3000), with range scale (153.6827850341797,-152.89743041992188) 
Train subject 3 has shape : (3024, 1, 2, 3000), with range scale (182.0,-193.0) 
Train subject 78 has shape : (797, 1, 2, 3000), with range scale (149.3025665283203,-160.010986328125) 
Train subject 50 has shape : (1012, 1, 2, 3000), with range scale (200.0,-201.0) 
Train subject 7 has shape : (1234, 1, 2, 3000), with range scale (193.0,-193.5274658203125) 
Train subject 33 has shape : (891, 1, 2, 3000), with range scale (188.0,-166.46739196777344) 
Train subject 72 has shape : (1506, 1, 2, 3000), with range scale (176.0,-176.0) 
Train subject 48 has shape : (1179, 1, 2, 3000), with range scale (168.1758270263672,-176.0) 
Train subject 4 has shape : (4482, 1, 2, 3000), with range scale (199.0,-199.0) 
Train subject 15 has shape : (941, 1, 2, 3000), with range scale (128.11428833007812,-143.77142333984375) 
Train subject 17 has shape : (951, 1, 2, 3000), with range scale (169.06593322753906,-177.72918701171875) 
Train subject 5 has shape : (969, 1, 2, 3000), with range scale (111.14725494384766,-126.79560089111328) 
Train subject 75 has shape : (1087, 1, 2, 3000), with range scale (171.56410217285156,-179.40170288085938) 
Train subject 41 has shape : (940, 1, 2, 3000), with range scale (137.87960815429688,-155.41734313964844) 
Train subject 63 has shape : (1245, 1, 2, 3000), with range scale (180.0,-182.0) 
Train subject 34 has shape : (1649, 1, 2, 3000), with range scale (179.0,-181.0) 
Train subject 28 has shape : (1097, 1, 2, 3000), with range scale (178.0,-178.0) 
Train subject 11 has shape : (827, 1, 2, 3000), with range scale (196.0,-194.0) 
Train subject 61 has shape : (1115, 1, 2, 3000), with range scale (203.39926147460938,-208.0) 
Train subject 23 has shape : (1591, 1, 2, 3000), with range scale (187.0,-186.0) 
Train subject 10 has shape : (1027, 1, 2, 3000), with range scale (189.0,-188.0) 
Train subject 31 has shape : (1731, 1, 2, 3000), with range scale (138.56044006347656,-164.38461303710938) 
Train subject 52 has shape : (1007, 1, 2, 3000), with range scale (161.41026306152344,-164.91453552246094) 
Train subject 66 has shape : (1182, 1, 2, 3000), with range scale (192.0,-190.0) 
Train subject 1 has shape : (3187, 1, 2, 3000), with range scale (182.0,-175.92308044433594) 
Train subject 32 has shape : (950, 1, 2, 3000), with range scale (196.0,-194.0) 
Train subject 74 has shape : (1007, 1, 2, 3000), with range scale (179.26739501953125,-193.08668518066406) 
Train subject 14 has shape : (1139, 1, 2, 3000), with range scale (209.0,-211.0) 
Train subject 56 has shape : (1770, 1, 2, 3000), with range scale (189.0,-189.7008514404297) 
Train subject 19 has shape : (1005, 1, 2, 3000), with range scale (198.0,-197.0) 
Train subject 29 has shape : (1020, 1, 2, 3000), with range scale (182.07667541503906,-203.61318969726562) 
Train subject 51 has shape : (1013, 1, 2, 3000), with range scale (177.44175720214844,-190.0) 
Train subject 49 has shape : (1089, 1, 2, 3000), with range scale (206.0,-205.0) 
Train subject 24 has shape : (670, 1, 2, 3000), with range scale (182.0,-180.0) 
Train subject 35 has shape : (1518, 1, 2, 3000), with range scale (143.05250549316406,-156.92308044433594) 
Train subject 18 has shape : (1049, 1, 2, 3000), with range scale (154.2100067138672,-168.73309326171875) 
Train subject 0 has shape : (2570, 1, 2, 3000), with range scale (200.0,-200.0) 
Train subject 81 has shape : (1597, 1, 2, 3000), with range scale (199.14602661132812,-201.0) 
Train subject 20 has shape : (1130, 1, 2, 3000), with range scale (150.8385772705078,-190.39950561523438) 
Train subject 77 has shape : (1243, 1, 2, 3000), with range scale (200.0,-199.0) 
Train subject 25 has shape : (924, 1, 2, 3000), with range scale (157.42857360839844,-174.028564453125) 
Train subject 37 has shape : (902, 1, 2, 3000), with range scale (181.95237731933594,-199.0) 
Train subject 46 has shape : (1198, 1, 2, 3000), with range scale (198.0,-201.0) 
Train subject 39 has shape : (1577, 1, 2, 3000), with range scale (187.03443908691406,-195.06007385253906) 
Train subject 65 has shape : (1149, 1, 2, 3000), with range scale (171.1802215576172,-199.0) 
Train subject 58 has shape : (1006, 1, 2, 3000), with range scale (167.63735961914062,-188.0) 
Train subject 12 has shape : (1123, 1, 2, 3000), with range scale (160.25714111328125,-182.0) 
Train subject 70 has shape : (1870, 1, 2, 3000), with range scale (185.1965789794922,-189.93162536621094) 
Train subject 36 has shape : (1097, 1, 2, 3000), with range scale (183.13308715820312,-172.8285675048828) 
Train subject 21 has shape : (1480, 1, 2, 3000), with range scale (180.7150115966797,-180.62588500976562) 
Train subject 9 has shape : (1028, 1, 2, 3000), with range scale (167.55213928222656,-177.0) 
Train subject 79 has shape : (1271, 1, 2, 3000), with range scale (180.0,-185.13845825195312) 
Train subject 67 has shape : (1106, 1, 2, 3000), with range scale (167.0,-248.0) 
Train subject 64 has shape : (788, 1, 2, 3000), with range scale (199.0,-199.0) 
Train subject 47 has shape : (948, 1, 2, 3000), with range scale (178.0,-178.0) 
Train subject 44 has shape : (962, 1, 2, 3000), with range scale (168.96043395996094,-180.2153778076172) 
test subjects :  [30, 53, 42, 59, 22, 38, 2, 55, 26, 8, 68, 13, 71, 76, 16, 27, 45]
test subject 30 has shape : (919, 1, 2, 3000), with range scale (183.994140625,-186.0)  
test subject 53 has shape : (1002, 1, 2, 3000), with range scale (188.0,-188.0)  
test subject 42 has shape : (1128, 1, 2, 3000), with range scale (187.0,-189.0)  
test subject 59 has shape : (1103, 1, 2, 3000), with range scale (196.0,-196.0)  
test subject 22 has shape : (836, 1, 2, 3000), with range scale (196.0,-192.0)  
test subject 38 has shape : (1523, 1, 2, 3000), with range scale (174.95555114746094,-183.0)  
test subject 2 has shape : (3305, 1, 2, 3000), with range scale (162.62197875976562,-177.0)  
test subject 55 has shape : (1053, 1, 2, 3000), with range scale (187.0,-202.0)  
test subject 26 has shape : (1087, 1, 2, 3000), with range scale (184.77069091796875,-188.85568237304688)  
test subject 8 has shape : (1003, 1, 2, 3000), with range scale (187.0,-178.14089965820312)  
test subject 68 has shape : (1008, 1, 2, 3000), with range scale (190.0,-193.0)  
test subject 13 has shape : (949, 1, 2, 3000), with range scale (187.26007080078125,-186.0)  
test subject 71 has shape : (902, 1, 2, 3000), with range scale (176.42906188964844,-190.36068725585938)  
test subject 76 has shape : (1728, 1, 2, 3000), with range scale (148.92283630371094,-186.7855987548828)  
test subject 16 has shape : (1127, 1, 2, 3000), with range scale (129.90989685058594,-140.84835815429688)  
test subject 27 has shape : (1284, 1, 2, 3000), with range scale (186.46446228027344,-192.24981689453125)  
test subject 45 has shape : (1227, 1, 2, 3000), with range scale (206.0,-205.0)  
valid subjects :  [30, 53, 42, 59, 22, 38, 2, 55, 26, 8, 68, 13, 71, 76, 16, 27, 45]
valid subject 30 has shape : (919, 1, 2, 3000), with range scale (183.994140625,-186.0)  
valid subject 53 has shape : (1002, 1, 2, 3000), with range scale (188.0,-188.0)  
valid subject 42 has shape : (1128, 1, 2, 3000), with range scale (187.0,-189.0)  
valid subject 59 has shape : (1103, 1, 2, 3000), with range scale (196.0,-196.0)  
valid subject 22 has shape : (836, 1, 2, 3000), with range scale (196.0,-192.0)  
valid subject 38 has shape : (1523, 1, 2, 3000), with range scale (174.95555114746094,-183.0)  
valid subject 2 has shape : (3305, 1, 2, 3000), with range scale (162.62197875976562,-177.0)  
valid subject 55 has shape : (1053, 1, 2, 3000), with range scale (187.0,-202.0)  
valid subject 26 has shape : (1087, 1, 2, 3000), with range scale (184.77069091796875,-188.85568237304688)  
valid subject 8 has shape : (1003, 1, 2, 3000), with range scale (187.0,-178.14089965820312)  
valid subject 68 has shape : (1008, 1, 2, 3000), with range scale (190.0,-193.0)  
valid subject 13 has shape : (949, 1, 2, 3000), with range scale (187.26007080078125,-186.0)  
valid subject 71 has shape : (902, 1, 2, 3000), with range scale (176.42906188964844,-190.36068725585938)  
valid subject 76 has shape : (1728, 1, 2, 3000), with range scale (148.92283630371094,-186.7855987548828)  
valid subject 16 has shape : (1127, 1, 2, 3000), with range scale (129.90989685058594,-140.84835815429688)  
valid subject 27 has shape : (1284, 1, 2, 3000), with range scale (186.46446228027344,-192.24981689453125)  
valid subject 45 has shape : (1227, 1, 2, 3000), with range scale (206.0,-205.0)  
Loading trainer: BaseModel
Building model
Backbone: deepsleep
params set up :  {'kern_length_1': 200, 'kern_length_2': 100, 'num_ch': 2, 'samples': 3000, 'F1': 8, 'F2': 8, 'drop_prob': 0.25, 'avg_pool_1': 10, 'avg_pool_2': 10}
pretrain :  False
pretrain path : 
use max norm 0.5 constraint on last FC
# params: 11,086
save checkpoint keys :  dict_keys(['epoch', 'global_step', 'pytorch-lightning_version', 'state_dict', 'callbacks', 'optimizer_states', 'lr_schedulers'])
combine predict folder :  /data1/wduong_experiment_data/EEG_Dassl_Lightning/NeurIPS_1/task_1_final_1/quick_ver_1_1/no_aug/no_norm/deepsleep_vanilla/full_dataset/model/predict_folder/test_fold_1/valid_fold_1
Loading dataset: MultiDatasetV1
data root :  /data1/wduong_experiment_data/EEG_Dassl_Lightning/da_dataset/NeurIPS_1
dataset dir :  task_1_final_case_1
file name :  full_target_sleep.mat
r_op file path :  None
test subject idx after split :  None
train-valid idx after split :  [30 53 42 59 22 38  2 55 26  8 68 13 71 76 16 27 45 57 80 73 43 60 40 62
 54 82 69  6  3 78 50  7 33 72 48  4 15 17  5 75 41 63 34 28 11 61 23 10
 31 52 66  1 32 74 14 56 19 29 51 49 24 35 18  0 81 20 77 25 37 46 39 65
 58 12 70 36 21  9 79 67 64 47 44]
cross subject split for valid data
train subject after split :  [30, 53, 42, 59, 22, 38, 2, 55, 26, 8, 68, 13, 71, 76, 16, 27, 45, 48, 4, 15, 17, 5, 75, 41, 63, 34, 28, 11, 61, 23, 10, 31, 52, 66, 1, 32, 74, 14, 56, 19, 29, 51, 49, 24, 35, 18, 0, 81, 20, 77, 25, 37, 46, 39, 65, 58, 12, 70, 36, 21, 9, 79, 67, 64, 47, 44]
valid subject after split :  [57, 80, 73, 43, 60, 40, 62, 54, 82, 69, 6, 3, 78, 50, 7, 33, 72]
there is no test file 
train subjects :  [30, 53, 42, 59, 22, 38, 2, 55, 26, 8, 68, 13, 71, 76, 16, 27, 45, 48, 4, 15, 17, 5, 75, 41, 63, 34, 28, 11, 61, 23, 10, 31, 52, 66, 1, 32, 74, 14, 56, 19, 29, 51, 49, 24, 35, 18, 0, 81, 20, 77, 25, 37, 46, 39, 65, 58, 12, 70, 36, 21, 9, 79, 67, 64, 47, 44]
Train subject 30 has shape : (919, 1, 2, 3000), with range scale (183.994140625,-186.0) 
Train subject 53 has shape : (1002, 1, 2, 3000), with range scale (188.0,-188.0) 
Train subject 42 has shape : (1128, 1, 2, 3000), with range scale (187.0,-189.0) 
Train subject 59 has shape : (1103, 1, 2, 3000), with range scale (196.0,-196.0) 
Train subject 22 has shape : (836, 1, 2, 3000), with range scale (196.0,-192.0) 
Train subject 38 has shape : (1523, 1, 2, 3000), with range scale (174.95555114746094,-183.0) 
Train subject 2 has shape : (3305, 1, 2, 3000), with range scale (162.62197875976562,-177.0) 
Train subject 55 has shape : (1053, 1, 2, 3000), with range scale (187.0,-202.0) 
Train subject 26 has shape : (1087, 1, 2, 3000), with range scale (184.77069091796875,-188.85568237304688) 
Train subject 8 has shape : (1003, 1, 2, 3000), with range scale (187.0,-178.14089965820312) 
Train subject 68 has shape : (1008, 1, 2, 3000), with range scale (190.0,-193.0) 
Train subject 13 has shape : (949, 1, 2, 3000), with range scale (187.26007080078125,-186.0) 
Train subject 71 has shape : (902, 1, 2, 3000), with range scale (176.42906188964844,-190.36068725585938) 
Train subject 76 has shape : (1728, 1, 2, 3000), with range scale (148.92283630371094,-186.7855987548828) 
Train subject 16 has shape : (1127, 1, 2, 3000), with range scale (129.90989685058594,-140.84835815429688) 
Train subject 27 has shape : (1284, 1, 2, 3000), with range scale (186.46446228027344,-192.24981689453125) 
Train subject 45 has shape : (1227, 1, 2, 3000), with range scale (206.0,-205.0) 
Train subject 48 has shape : (1179, 1, 2, 3000), with range scale (168.1758270263672,-176.0) 
Train subject 4 has shape : (4482, 1, 2, 3000), with range scale (199.0,-199.0) 
Train subject 15 has shape : (941, 1, 2, 3000), with range scale (128.11428833007812,-143.77142333984375) 
Train subject 17 has shape : (951, 1, 2, 3000), with range scale (169.06593322753906,-177.72918701171875) 
Train subject 5 has shape : (969, 1, 2, 3000), with range scale (111.14725494384766,-126.79560089111328) 
Train subject 75 has shape : (1087, 1, 2, 3000), with range scale (171.56410217285156,-179.40170288085938) 
Train subject 41 has shape : (940, 1, 2, 3000), with range scale (137.87960815429688,-155.41734313964844) 
Train subject 63 has shape : (1245, 1, 2, 3000), with range scale (180.0,-182.0) 
Train subject 34 has shape : (1649, 1, 2, 3000), with range scale (179.0,-181.0) 
Train subject 28 has shape : (1097, 1, 2, 3000), with range scale (178.0,-178.0) 
Train subject 11 has shape : (827, 1, 2, 3000), with range scale (196.0,-194.0) 
Train subject 61 has shape : (1115, 1, 2, 3000), with range scale (203.39926147460938,-208.0) 
Train subject 23 has shape : (1591, 1, 2, 3000), with range scale (187.0,-186.0) 
Train subject 10 has shape : (1027, 1, 2, 3000), with range scale (189.0,-188.0) 
Train subject 31 has shape : (1731, 1, 2, 3000), with range scale (138.56044006347656,-164.38461303710938) 
Train subject 52 has shape : (1007, 1, 2, 3000), with range scale (161.41026306152344,-164.91453552246094) 
Train subject 66 has shape : (1182, 1, 2, 3000), with range scale (192.0,-190.0) 
Train subject 1 has shape : (3187, 1, 2, 3000), with range scale (182.0,-175.92308044433594) 
Train subject 32 has shape : (950, 1, 2, 3000), with range scale (196.0,-194.0) 
Train subject 74 has shape : (1007, 1, 2, 3000), with range scale (179.26739501953125,-193.08668518066406) 
Train subject 14 has shape : (1139, 1, 2, 3000), with range scale (209.0,-211.0) 
Train subject 56 has shape : (1770, 1, 2, 3000), with range scale (189.0,-189.7008514404297) 
Train subject 19 has shape : (1005, 1, 2, 3000), with range scale (198.0,-197.0) 
Train subject 29 has shape : (1020, 1, 2, 3000), with range scale (182.07667541503906,-203.61318969726562) 
Train subject 51 has shape : (1013, 1, 2, 3000), with range scale (177.44175720214844,-190.0) 
Train subject 49 has shape : (1089, 1, 2, 3000), with range scale (206.0,-205.0) 
Train subject 24 has shape : (670, 1, 2, 3000), with range scale (182.0,-180.0) 
Train subject 35 has shape : (1518, 1, 2, 3000), with range scale (143.05250549316406,-156.92308044433594) 
Train subject 18 has shape : (1049, 1, 2, 3000), with range scale (154.2100067138672,-168.73309326171875) 
Train subject 0 has shape : (2570, 1, 2, 3000), with range scale (200.0,-200.0) 
Train subject 81 has shape : (1597, 1, 2, 3000), with range scale (199.14602661132812,-201.0) 
Train subject 20 has shape : (1130, 1, 2, 3000), with range scale (150.8385772705078,-190.39950561523438) 
Train subject 77 has shape : (1243, 1, 2, 3000), with range scale (200.0,-199.0) 
Train subject 25 has shape : (924, 1, 2, 3000), with range scale (157.42857360839844,-174.028564453125) 
Train subject 37 has shape : (902, 1, 2, 3000), with range scale (181.95237731933594,-199.0) 
Train subject 46 has shape : (1198, 1, 2, 3000), with range scale (198.0,-201.0) 
Train subject 39 has shape : (1577, 1, 2, 3000), with range scale (187.03443908691406,-195.06007385253906) 
Train subject 65 has shape : (1149, 1, 2, 3000), with range scale (171.1802215576172,-199.0) 
Train subject 58 has shape : (1006, 1, 2, 3000), with range scale (167.63735961914062,-188.0) 
Train subject 12 has shape : (1123, 1, 2, 3000), with range scale (160.25714111328125,-182.0) 
Train subject 70 has shape : (1870, 1, 2, 3000), with range scale (185.1965789794922,-189.93162536621094) 
Train subject 36 has shape : (1097, 1, 2, 3000), with range scale (183.13308715820312,-172.8285675048828) 
Train subject 21 has shape : (1480, 1, 2, 3000), with range scale (180.7150115966797,-180.62588500976562) 
Train subject 9 has shape : (1028, 1, 2, 3000), with range scale (167.55213928222656,-177.0) 
Train subject 79 has shape : (1271, 1, 2, 3000), with range scale (180.0,-185.13845825195312) 
Train subject 67 has shape : (1106, 1, 2, 3000), with range scale (167.0,-248.0) 
Train subject 64 has shape : (788, 1, 2, 3000), with range scale (199.0,-199.0) 
Train subject 47 has shape : (948, 1, 2, 3000), with range scale (178.0,-178.0) 
Train subject 44 has shape : (962, 1, 2, 3000), with range scale (168.96043395996094,-180.2153778076172) 
test subjects :  [57, 80, 73, 43, 60, 40, 62, 54, 82, 69, 6, 3, 78, 50, 7, 33, 72]
test subject 57 has shape : (972, 1, 2, 3000), with range scale (146.44615173339844,-143.03076171875)  
test subject 80 has shape : (1752, 1, 2, 3000), with range scale (187.40512084960938,-192.0)  
test subject 73 has shape : (1770, 1, 2, 3000), with range scale (195.23419189453125,-194.0)  
test subject 43 has shape : (1701, 1, 2, 3000), with range scale (183.6600799560547,-196.0)  
test subject 60 has shape : (1581, 1, 2, 3000), with range scale (177.0,-175.1846160888672)  
test subject 40 has shape : (969, 1, 2, 3000), with range scale (158.65615844726562,-185.22052001953125)  
test subject 62 has shape : (978, 1, 2, 3000), with range scale (201.0,-201.0)  
test subject 54 has shape : (917, 1, 2, 3000), with range scale (152.43174743652344,-174.1714324951172)  
test subject 82 has shape : (1361, 1, 2, 3000), with range scale (182.0,-182.0)  
test subject 69 has shape : (818, 1, 2, 3000), with range scale (176.0,-178.0)  
test subject 6 has shape : (1240, 1, 2, 3000), with range scale (153.6827850341797,-152.89743041992188)  
test subject 3 has shape : (3024, 1, 2, 3000), with range scale (182.0,-193.0)  
test subject 78 has shape : (797, 1, 2, 3000), with range scale (149.3025665283203,-160.010986328125)  
test subject 50 has shape : (1012, 1, 2, 3000), with range scale (200.0,-201.0)  
test subject 7 has shape : (1234, 1, 2, 3000), with range scale (193.0,-193.5274658203125)  
test subject 33 has shape : (891, 1, 2, 3000), with range scale (188.0,-166.46739196777344)  
test subject 72 has shape : (1506, 1, 2, 3000), with range scale (176.0,-176.0)  
valid subjects :  [57, 80, 73, 43, 60, 40, 62, 54, 82, 69, 6, 3, 78, 50, 7, 33, 72]
valid subject 57 has shape : (972, 1, 2, 3000), with range scale (146.44615173339844,-143.03076171875)  
valid subject 80 has shape : (1752, 1, 2, 3000), with range scale (187.40512084960938,-192.0)  
valid subject 73 has shape : (1770, 1, 2, 3000), with range scale (195.23419189453125,-194.0)  
valid subject 43 has shape : (1701, 1, 2, 3000), with range scale (183.6600799560547,-196.0)  
valid subject 60 has shape : (1581, 1, 2, 3000), with range scale (177.0,-175.1846160888672)  
valid subject 40 has shape : (969, 1, 2, 3000), with range scale (158.65615844726562,-185.22052001953125)  
valid subject 62 has shape : (978, 1, 2, 3000), with range scale (201.0,-201.0)  
valid subject 54 has shape : (917, 1, 2, 3000), with range scale (152.43174743652344,-174.1714324951172)  
valid subject 82 has shape : (1361, 1, 2, 3000), with range scale (182.0,-182.0)  
valid subject 69 has shape : (818, 1, 2, 3000), with range scale (176.0,-178.0)  
valid subject 6 has shape : (1240, 1, 2, 3000), with range scale (153.6827850341797,-152.89743041992188)  
valid subject 3 has shape : (3024, 1, 2, 3000), with range scale (182.0,-193.0)  
valid subject 78 has shape : (797, 1, 2, 3000), with range scale (149.3025665283203,-160.010986328125)  
valid subject 50 has shape : (1012, 1, 2, 3000), with range scale (200.0,-201.0)  
valid subject 7 has shape : (1234, 1, 2, 3000), with range scale (193.0,-193.5274658203125)  
valid subject 33 has shape : (891, 1, 2, 3000), with range scale (188.0,-166.46739196777344)  
valid subject 72 has shape : (1506, 1, 2, 3000), with range scale (176.0,-176.0)  
Loading trainer: BaseModel
Building model
Backbone: deepsleep
params set up :  {'kern_length_1': 200, 'kern_length_2': 100, 'num_ch': 2, 'samples': 3000, 'F1': 8, 'F2': 8, 'drop_prob': 0.25, 'avg_pool_1': 10, 'avg_pool_2': 10}
pretrain :  False
pretrain path : 
use max norm 0.5 constraint on last FC
# params: 11,086
save checkpoint keys :  dict_keys(['epoch', 'global_step', 'pytorch-lightning_version', 'state_dict', 'callbacks', 'optimizer_states', 'lr_schedulers'])
combine predict folder :  /data1/wduong_experiment_data/EEG_Dassl_Lightning/NeurIPS_1/task_1_final_1/quick_ver_1_1/no_aug/no_norm/deepsleep_vanilla/full_dataset/model/predict_folder/test_fold_1/valid_fold_2
Loading dataset: MultiDatasetV1
data root :  /data1/wduong_experiment_data/EEG_Dassl_Lightning/da_dataset/NeurIPS_1
dataset dir :  task_1_final_case_1
file name :  full_target_sleep.mat
r_op file path :  None
test subject idx after split :  None
train-valid idx after split :  [30 53 42 59 22 38  2 55 26  8 68 13 71 76 16 27 45 57 80 73 43 60 40 62
 54 82 69  6  3 78 50  7 33 72 48  4 15 17  5 75 41 63 34 28 11 61 23 10
 31 52 66  1 32 74 14 56 19 29 51 49 24 35 18  0 81 20 77 25 37 46 39 65
 58 12 70 36 21  9 79 67 64 47 44]
cross subject split for valid data
train subject after split :  [30, 53, 42, 59, 22, 38, 2, 55, 26, 8, 68, 13, 71, 76, 16, 27, 45, 57, 80, 73, 43, 60, 40, 62, 54, 82, 69, 6, 3, 78, 50, 7, 33, 72, 1, 32, 74, 14, 56, 19, 29, 51, 49, 24, 35, 18, 0, 81, 20, 77, 25, 37, 46, 39, 65, 58, 12, 70, 36, 21, 9, 79, 67, 64, 47, 44]
valid subject after split :  [48, 4, 15, 17, 5, 75, 41, 63, 34, 28, 11, 61, 23, 10, 31, 52, 66]
there is no test file 
train subjects :  [30, 53, 42, 59, 22, 38, 2, 55, 26, 8, 68, 13, 71, 76, 16, 27, 45, 57, 80, 73, 43, 60, 40, 62, 54, 82, 69, 6, 3, 78, 50, 7, 33, 72, 1, 32, 74, 14, 56, 19, 29, 51, 49, 24, 35, 18, 0, 81, 20, 77, 25, 37, 46, 39, 65, 58, 12, 70, 36, 21, 9, 79, 67, 64, 47, 44]
Train subject 30 has shape : (919, 1, 2, 3000), with range scale (183.994140625,-186.0) 
Train subject 53 has shape : (1002, 1, 2, 3000), with range scale (188.0,-188.0) 
Train subject 42 has shape : (1128, 1, 2, 3000), with range scale (187.0,-189.0) 
Train subject 59 has shape : (1103, 1, 2, 3000), with range scale (196.0,-196.0) 
Train subject 22 has shape : (836, 1, 2, 3000), with range scale (196.0,-192.0) 
Train subject 38 has shape : (1523, 1, 2, 3000), with range scale (174.95555114746094,-183.0) 
Train subject 2 has shape : (3305, 1, 2, 3000), with range scale (162.62197875976562,-177.0) 
Train subject 55 has shape : (1053, 1, 2, 3000), with range scale (187.0,-202.0) 
Train subject 26 has shape : (1087, 1, 2, 3000), with range scale (184.77069091796875,-188.85568237304688) 
Train subject 8 has shape : (1003, 1, 2, 3000), with range scale (187.0,-178.14089965820312) 
Train subject 68 has shape : (1008, 1, 2, 3000), with range scale (190.0,-193.0) 
Train subject 13 has shape : (949, 1, 2, 3000), with range scale (187.26007080078125,-186.0) 
Train subject 71 has shape : (902, 1, 2, 3000), with range scale (176.42906188964844,-190.36068725585938) 
Train subject 76 has shape : (1728, 1, 2, 3000), with range scale (148.92283630371094,-186.7855987548828) 
Train subject 16 has shape : (1127, 1, 2, 3000), with range scale (129.90989685058594,-140.84835815429688) 
Train subject 27 has shape : (1284, 1, 2, 3000), with range scale (186.46446228027344,-192.24981689453125) 
Train subject 45 has shape : (1227, 1, 2, 3000), with range scale (206.0,-205.0) 
Train subject 57 has shape : (972, 1, 2, 3000), with range scale (146.44615173339844,-143.03076171875) 
Train subject 80 has shape : (1752, 1, 2, 3000), with range scale (187.40512084960938,-192.0) 
Train subject 73 has shape : (1770, 1, 2, 3000), with range scale (195.23419189453125,-194.0) 
Train subject 43 has shape : (1701, 1, 2, 3000), with range scale (183.6600799560547,-196.0) 
Train subject 60 has shape : (1581, 1, 2, 3000), with range scale (177.0,-175.1846160888672) 
Train subject 40 has shape : (969, 1, 2, 3000), with range scale (158.65615844726562,-185.22052001953125) 
Train subject 62 has shape : (978, 1, 2, 3000), with range scale (201.0,-201.0) 
Train subject 54 has shape : (917, 1, 2, 3000), with range scale (152.43174743652344,-174.1714324951172) 
Train subject 82 has shape : (1361, 1, 2, 3000), with range scale (182.0,-182.0) 
Train subject 69 has shape : (818, 1, 2, 3000), with range scale (176.0,-178.0) 
Train subject 6 has shape : (1240, 1, 2, 3000), with range scale (153.6827850341797,-152.89743041992188) 
Train subject 3 has shape : (3024, 1, 2, 3000), with range scale (182.0,-193.0) 
Train subject 78 has shape : (797, 1, 2, 3000), with range scale (149.3025665283203,-160.010986328125) 
Train subject 50 has shape : (1012, 1, 2, 3000), with range scale (200.0,-201.0) 
Train subject 7 has shape : (1234, 1, 2, 3000), with range scale (193.0,-193.5274658203125) 
Train subject 33 has shape : (891, 1, 2, 3000), with range scale (188.0,-166.46739196777344) 
Train subject 72 has shape : (1506, 1, 2, 3000), with range scale (176.0,-176.0) 
Train subject 1 has shape : (3187, 1, 2, 3000), with range scale (182.0,-175.92308044433594) 
Train subject 32 has shape : (950, 1, 2, 3000), with range scale (196.0,-194.0) 
Train subject 74 has shape : (1007, 1, 2, 3000), with range scale (179.26739501953125,-193.08668518066406) 
Train subject 14 has shape : (1139, 1, 2, 3000), with range scale (209.0,-211.0) 
Train subject 56 has shape : (1770, 1, 2, 3000), with range scale (189.0,-189.7008514404297) 
Train subject 19 has shape : (1005, 1, 2, 3000), with range scale (198.0,-197.0) 
Train subject 29 has shape : (1020, 1, 2, 3000), with range scale (182.07667541503906,-203.61318969726562) 
Train subject 51 has shape : (1013, 1, 2, 3000), with range scale (177.44175720214844,-190.0) 
Train subject 49 has shape : (1089, 1, 2, 3000), with range scale (206.0,-205.0) 
Train subject 24 has shape : (670, 1, 2, 3000), with range scale (182.0,-180.0) 
Train subject 35 has shape : (1518, 1, 2, 3000), with range scale (143.05250549316406,-156.92308044433594) 
Train subject 18 has shape : (1049, 1, 2, 3000), with range scale (154.2100067138672,-168.73309326171875) 
Train subject 0 has shape : (2570, 1, 2, 3000), with range scale (200.0,-200.0) 
Train subject 81 has shape : (1597, 1, 2, 3000), with range scale (199.14602661132812,-201.0) 
Train subject 20 has shape : (1130, 1, 2, 3000), with range scale (150.8385772705078,-190.39950561523438) 
Train subject 77 has shape : (1243, 1, 2, 3000), with range scale (200.0,-199.0) 
Train subject 25 has shape : (924, 1, 2, 3000), with range scale (157.42857360839844,-174.028564453125) 
Train subject 37 has shape : (902, 1, 2, 3000), with range scale (181.95237731933594,-199.0) 
Train subject 46 has shape : (1198, 1, 2, 3000), with range scale (198.0,-201.0) 
Train subject 39 has shape : (1577, 1, 2, 3000), with range scale (187.03443908691406,-195.06007385253906) 
Train subject 65 has shape : (1149, 1, 2, 3000), with range scale (171.1802215576172,-199.0) 
Train subject 58 has shape : (1006, 1, 2, 3000), with range scale (167.63735961914062,-188.0) 
Train subject 12 has shape : (1123, 1, 2, 3000), with range scale (160.25714111328125,-182.0) 
Train subject 70 has shape : (1870, 1, 2, 3000), with range scale (185.1965789794922,-189.93162536621094) 
Train subject 36 has shape : (1097, 1, 2, 3000), with range scale (183.13308715820312,-172.8285675048828) 
Train subject 21 has shape : (1480, 1, 2, 3000), with range scale (180.7150115966797,-180.62588500976562) 
Train subject 9 has shape : (1028, 1, 2, 3000), with range scale (167.55213928222656,-177.0) 
Train subject 79 has shape : (1271, 1, 2, 3000), with range scale (180.0,-185.13845825195312) 
Train subject 67 has shape : (1106, 1, 2, 3000), with range scale (167.0,-248.0) 
Train subject 64 has shape : (788, 1, 2, 3000), with range scale (199.0,-199.0) 
Train subject 47 has shape : (948, 1, 2, 3000), with range scale (178.0,-178.0) 
Train subject 44 has shape : (962, 1, 2, 3000), with range scale (168.96043395996094,-180.2153778076172) 
test subjects :  [48, 4, 15, 17, 5, 75, 41, 63, 34, 28, 11, 61, 23, 10, 31, 52, 66]
test subject 48 has shape : (1179, 1, 2, 3000), with range scale (168.1758270263672,-176.0)  
test subject 4 has shape : (4482, 1, 2, 3000), with range scale (199.0,-199.0)  
test subject 15 has shape : (941, 1, 2, 3000), with range scale (128.11428833007812,-143.77142333984375)  
test subject 17 has shape : (951, 1, 2, 3000), with range scale (169.06593322753906,-177.72918701171875)  
test subject 5 has shape : (969, 1, 2, 3000), with range scale (111.14725494384766,-126.79560089111328)  
test subject 75 has shape : (1087, 1, 2, 3000), with range scale (171.56410217285156,-179.40170288085938)  
test subject 41 has shape : (940, 1, 2, 3000), with range scale (137.87960815429688,-155.41734313964844)  
test subject 63 has shape : (1245, 1, 2, 3000), with range scale (180.0,-182.0)  
test subject 34 has shape : (1649, 1, 2, 3000), with range scale (179.0,-181.0)  
test subject 28 has shape : (1097, 1, 2, 3000), with range scale (178.0,-178.0)  
test subject 11 has shape : (827, 1, 2, 3000), with range scale (196.0,-194.0)  
test subject 61 has shape : (1115, 1, 2, 3000), with range scale (203.39926147460938,-208.0)  
test subject 23 has shape : (1591, 1, 2, 3000), with range scale (187.0,-186.0)  
test subject 10 has shape : (1027, 1, 2, 3000), with range scale (189.0,-188.0)  
test subject 31 has shape : (1731, 1, 2, 3000), with range scale (138.56044006347656,-164.38461303710938)  
test subject 52 has shape : (1007, 1, 2, 3000), with range scale (161.41026306152344,-164.91453552246094)  
test subject 66 has shape : (1182, 1, 2, 3000), with range scale (192.0,-190.0)  
valid subjects :  [48, 4, 15, 17, 5, 75, 41, 63, 34, 28, 11, 61, 23, 10, 31, 52, 66]
valid subject 48 has shape : (1179, 1, 2, 3000), with range scale (168.1758270263672,-176.0)  
valid subject 4 has shape : (4482, 1, 2, 3000), with range scale (199.0,-199.0)  
valid subject 15 has shape : (941, 1, 2, 3000), with range scale (128.11428833007812,-143.77142333984375)  
valid subject 17 has shape : (951, 1, 2, 3000), with range scale (169.06593322753906,-177.72918701171875)  
valid subject 5 has shape : (969, 1, 2, 3000), with range scale (111.14725494384766,-126.79560089111328)  
valid subject 75 has shape : (1087, 1, 2, 3000), with range scale (171.56410217285156,-179.40170288085938)  
valid subject 41 has shape : (940, 1, 2, 3000), with range scale (137.87960815429688,-155.41734313964844)  
valid subject 63 has shape : (1245, 1, 2, 3000), with range scale (180.0,-182.0)  
valid subject 34 has shape : (1649, 1, 2, 3000), with range scale (179.0,-181.0)  
valid subject 28 has shape : (1097, 1, 2, 3000), with range scale (178.0,-178.0)  
valid subject 11 has shape : (827, 1, 2, 3000), with range scale (196.0,-194.0)  
valid subject 61 has shape : (1115, 1, 2, 3000), with range scale (203.39926147460938,-208.0)  
valid subject 23 has shape : (1591, 1, 2, 3000), with range scale (187.0,-186.0)  
valid subject 10 has shape : (1027, 1, 2, 3000), with range scale (189.0,-188.0)  
valid subject 31 has shape : (1731, 1, 2, 3000), with range scale (138.56044006347656,-164.38461303710938)  
valid subject 52 has shape : (1007, 1, 2, 3000), with range scale (161.41026306152344,-164.91453552246094)  
valid subject 66 has shape : (1182, 1, 2, 3000), with range scale (192.0,-190.0)  
Loading trainer: BaseModel
Building model
Backbone: deepsleep
params set up :  {'kern_length_1': 200, 'kern_length_2': 100, 'num_ch': 2, 'samples': 3000, 'F1': 8, 'F2': 8, 'drop_prob': 0.25, 'avg_pool_1': 10, 'avg_pool_2': 10}
pretrain :  False
pretrain path : 
use max norm 0.5 constraint on last FC
# params: 11,086
save checkpoint keys :  dict_keys(['epoch', 'global_step', 'pytorch-lightning_version', 'state_dict', 'callbacks', 'optimizer_states', 'lr_schedulers'])
combine predict folder :  /data1/wduong_experiment_data/EEG_Dassl_Lightning/NeurIPS_1/task_1_final_1/quick_ver_1_1/no_aug/no_norm/deepsleep_vanilla/full_dataset/model/predict_folder/test_fold_1/valid_fold_3
Loading dataset: MultiDatasetV1
data root :  /data1/wduong_experiment_data/EEG_Dassl_Lightning/da_dataset/NeurIPS_1
dataset dir :  task_1_final_case_1
file name :  full_target_sleep.mat
r_op file path :  None
test subject idx after split :  None
train-valid idx after split :  [30 53 42 59 22 38  2 55 26  8 68 13 71 76 16 27 45 57 80 73 43 60 40 62
 54 82 69  6  3 78 50  7 33 72 48  4 15 17  5 75 41 63 34 28 11 61 23 10
 31 52 66  1 32 74 14 56 19 29 51 49 24 35 18  0 81 20 77 25 37 46 39 65
 58 12 70 36 21  9 79 67 64 47 44]
cross subject split for valid data
train subject after split :  [30, 53, 42, 59, 22, 38, 2, 55, 26, 8, 68, 13, 71, 76, 16, 27, 45, 57, 80, 73, 43, 60, 40, 62, 54, 82, 69, 6, 3, 78, 50, 7, 33, 72, 48, 4, 15, 17, 5, 75, 41, 63, 34, 28, 11, 61, 23, 10, 31, 52, 66, 25, 37, 46, 39, 65, 58, 12, 70, 36, 21, 9, 79, 67, 64, 47, 44]
valid subject after split :  [1, 32, 74, 14, 56, 19, 29, 51, 49, 24, 35, 18, 0, 81, 20, 77]
there is no test file 
train subjects :  [30, 53, 42, 59, 22, 38, 2, 55, 26, 8, 68, 13, 71, 76, 16, 27, 45, 57, 80, 73, 43, 60, 40, 62, 54, 82, 69, 6, 3, 78, 50, 7, 33, 72, 48, 4, 15, 17, 5, 75, 41, 63, 34, 28, 11, 61, 23, 10, 31, 52, 66, 25, 37, 46, 39, 65, 58, 12, 70, 36, 21, 9, 79, 67, 64, 47, 44]
Train subject 30 has shape : (919, 1, 2, 3000), with range scale (183.994140625,-186.0) 
Train subject 53 has shape : (1002, 1, 2, 3000), with range scale (188.0,-188.0) 
Train subject 42 has shape : (1128, 1, 2, 3000), with range scale (187.0,-189.0) 
Train subject 59 has shape : (1103, 1, 2, 3000), with range scale (196.0,-196.0) 
Train subject 22 has shape : (836, 1, 2, 3000), with range scale (196.0,-192.0) 
Train subject 38 has shape : (1523, 1, 2, 3000), with range scale (174.95555114746094,-183.0) 
Train subject 2 has shape : (3305, 1, 2, 3000), with range scale (162.62197875976562,-177.0) 
Train subject 55 has shape : (1053, 1, 2, 3000), with range scale (187.0,-202.0) 
Train subject 26 has shape : (1087, 1, 2, 3000), with range scale (184.77069091796875,-188.85568237304688) 
Train subject 8 has shape : (1003, 1, 2, 3000), with range scale (187.0,-178.14089965820312) 
Train subject 68 has shape : (1008, 1, 2, 3000), with range scale (190.0,-193.0) 
Train subject 13 has shape : (949, 1, 2, 3000), with range scale (187.26007080078125,-186.0) 
Train subject 71 has shape : (902, 1, 2, 3000), with range scale (176.42906188964844,-190.36068725585938) 
Train subject 76 has shape : (1728, 1, 2, 3000), with range scale (148.92283630371094,-186.7855987548828) 
Train subject 16 has shape : (1127, 1, 2, 3000), with range scale (129.90989685058594,-140.84835815429688) 
Train subject 27 has shape : (1284, 1, 2, 3000), with range scale (186.46446228027344,-192.24981689453125) 
Train subject 45 has shape : (1227, 1, 2, 3000), with range scale (206.0,-205.0) 
Train subject 57 has shape : (972, 1, 2, 3000), with range scale (146.44615173339844,-143.03076171875) 
Train subject 80 has shape : (1752, 1, 2, 3000), with range scale (187.40512084960938,-192.0) 
Train subject 73 has shape : (1770, 1, 2, 3000), with range scale (195.23419189453125,-194.0) 
Train subject 43 has shape : (1701, 1, 2, 3000), with range scale (183.6600799560547,-196.0) 
Train subject 60 has shape : (1581, 1, 2, 3000), with range scale (177.0,-175.1846160888672) 
Train subject 40 has shape : (969, 1, 2, 3000), with range scale (158.65615844726562,-185.22052001953125) 
Train subject 62 has shape : (978, 1, 2, 3000), with range scale (201.0,-201.0) 
Train subject 54 has shape : (917, 1, 2, 3000), with range scale (152.43174743652344,-174.1714324951172) 
Train subject 82 has shape : (1361, 1, 2, 3000), with range scale (182.0,-182.0) 
Train subject 69 has shape : (818, 1, 2, 3000), with range scale (176.0,-178.0) 
Train subject 6 has shape : (1240, 1, 2, 3000), with range scale (153.6827850341797,-152.89743041992188) 
Train subject 3 has shape : (3024, 1, 2, 3000), with range scale (182.0,-193.0) 
Train subject 78 has shape : (797, 1, 2, 3000), with range scale (149.3025665283203,-160.010986328125) 
Train subject 50 has shape : (1012, 1, 2, 3000), with range scale (200.0,-201.0) 
Train subject 7 has shape : (1234, 1, 2, 3000), with range scale (193.0,-193.5274658203125) 
Train subject 33 has shape : (891, 1, 2, 3000), with range scale (188.0,-166.46739196777344) 
Train subject 72 has shape : (1506, 1, 2, 3000), with range scale (176.0,-176.0) 
Train subject 48 has shape : (1179, 1, 2, 3000), with range scale (168.1758270263672,-176.0) 
Train subject 4 has shape : (4482, 1, 2, 3000), with range scale (199.0,-199.0) 
Train subject 15 has shape : (941, 1, 2, 3000), with range scale (128.11428833007812,-143.77142333984375) 
Train subject 17 has shape : (951, 1, 2, 3000), with range scale (169.06593322753906,-177.72918701171875) 
Train subject 5 has shape : (969, 1, 2, 3000), with range scale (111.14725494384766,-126.79560089111328) 
Train subject 75 has shape : (1087, 1, 2, 3000), with range scale (171.56410217285156,-179.40170288085938) 
Train subject 41 has shape : (940, 1, 2, 3000), with range scale (137.87960815429688,-155.41734313964844) 
Train subject 63 has shape : (1245, 1, 2, 3000), with range scale (180.0,-182.0) 
Train subject 34 has shape : (1649, 1, 2, 3000), with range scale (179.0,-181.0) 
Train subject 28 has shape : (1097, 1, 2, 3000), with range scale (178.0,-178.0) 
Train subject 11 has shape : (827, 1, 2, 3000), with range scale (196.0,-194.0) 
Train subject 61 has shape : (1115, 1, 2, 3000), with range scale (203.39926147460938,-208.0) 
Train subject 23 has shape : (1591, 1, 2, 3000), with range scale (187.0,-186.0) 
Train subject 10 has shape : (1027, 1, 2, 3000), with range scale (189.0,-188.0) 
Train subject 31 has shape : (1731, 1, 2, 3000), with range scale (138.56044006347656,-164.38461303710938) 
Train subject 52 has shape : (1007, 1, 2, 3000), with range scale (161.41026306152344,-164.91453552246094) 
Train subject 66 has shape : (1182, 1, 2, 3000), with range scale (192.0,-190.0) 
Train subject 25 has shape : (924, 1, 2, 3000), with range scale (157.42857360839844,-174.028564453125) 
Train subject 37 has shape : (902, 1, 2, 3000), with range scale (181.95237731933594,-199.0) 
Train subject 46 has shape : (1198, 1, 2, 3000), with range scale (198.0,-201.0) 
Train subject 39 has shape : (1577, 1, 2, 3000), with range scale (187.03443908691406,-195.06007385253906) 
Train subject 65 has shape : (1149, 1, 2, 3000), with range scale (171.1802215576172,-199.0) 
Train subject 58 has shape : (1006, 1, 2, 3000), with range scale (167.63735961914062,-188.0) 
Train subject 12 has shape : (1123, 1, 2, 3000), with range scale (160.25714111328125,-182.0) 
Train subject 70 has shape : (1870, 1, 2, 3000), with range scale (185.1965789794922,-189.93162536621094) 
Train subject 36 has shape : (1097, 1, 2, 3000), with range scale (183.13308715820312,-172.8285675048828) 
Train subject 21 has shape : (1480, 1, 2, 3000), with range scale (180.7150115966797,-180.62588500976562) 
Train subject 9 has shape : (1028, 1, 2, 3000), with range scale (167.55213928222656,-177.0) 
Train subject 79 has shape : (1271, 1, 2, 3000), with range scale (180.0,-185.13845825195312) 
Train subject 67 has shape : (1106, 1, 2, 3000), with range scale (167.0,-248.0) 
Train subject 64 has shape : (788, 1, 2, 3000), with range scale (199.0,-199.0) 
Train subject 47 has shape : (948, 1, 2, 3000), with range scale (178.0,-178.0) 
Train subject 44 has shape : (962, 1, 2, 3000), with range scale (168.96043395996094,-180.2153778076172) 
test subjects :  [1, 32, 74, 14, 56, 19, 29, 51, 49, 24, 35, 18, 0, 81, 20, 77]
test subject 1 has shape : (3187, 1, 2, 3000), with range scale (182.0,-175.92308044433594)  
test subject 32 has shape : (950, 1, 2, 3000), with range scale (196.0,-194.0)  
test subject 74 has shape : (1007, 1, 2, 3000), with range scale (179.26739501953125,-193.08668518066406)  
test subject 14 has shape : (1139, 1, 2, 3000), with range scale (209.0,-211.0)  
test subject 56 has shape : (1770, 1, 2, 3000), with range scale (189.0,-189.7008514404297)  
test subject 19 has shape : (1005, 1, 2, 3000), with range scale (198.0,-197.0)  
test subject 29 has shape : (1020, 1, 2, 3000), with range scale (182.07667541503906,-203.61318969726562)  
test subject 51 has shape : (1013, 1, 2, 3000), with range scale (177.44175720214844,-190.0)  
test subject 49 has shape : (1089, 1, 2, 3000), with range scale (206.0,-205.0)  
test subject 24 has shape : (670, 1, 2, 3000), with range scale (182.0,-180.0)  
test subject 35 has shape : (1518, 1, 2, 3000), with range scale (143.05250549316406,-156.92308044433594)  
test subject 18 has shape : (1049, 1, 2, 3000), with range scale (154.2100067138672,-168.73309326171875)  
test subject 0 has shape : (2570, 1, 2, 3000), with range scale (200.0,-200.0)  
test subject 81 has shape : (1597, 1, 2, 3000), with range scale (199.14602661132812,-201.0)  
test subject 20 has shape : (1130, 1, 2, 3000), with range scale (150.8385772705078,-190.39950561523438)  
test subject 77 has shape : (1243, 1, 2, 3000), with range scale (200.0,-199.0)  
valid subjects :  [1, 32, 74, 14, 56, 19, 29, 51, 49, 24, 35, 18, 0, 81, 20, 77]
valid subject 1 has shape : (3187, 1, 2, 3000), with range scale (182.0,-175.92308044433594)  
valid subject 32 has shape : (950, 1, 2, 3000), with range scale (196.0,-194.0)  
valid subject 74 has shape : (1007, 1, 2, 3000), with range scale (179.26739501953125,-193.08668518066406)  
valid subject 14 has shape : (1139, 1, 2, 3000), with range scale (209.0,-211.0)  
valid subject 56 has shape : (1770, 1, 2, 3000), with range scale (189.0,-189.7008514404297)  
valid subject 19 has shape : (1005, 1, 2, 3000), with range scale (198.0,-197.0)  
valid subject 29 has shape : (1020, 1, 2, 3000), with range scale (182.07667541503906,-203.61318969726562)  
valid subject 51 has shape : (1013, 1, 2, 3000), with range scale (177.44175720214844,-190.0)  
valid subject 49 has shape : (1089, 1, 2, 3000), with range scale (206.0,-205.0)  
valid subject 24 has shape : (670, 1, 2, 3000), with range scale (182.0,-180.0)  
valid subject 35 has shape : (1518, 1, 2, 3000), with range scale (143.05250549316406,-156.92308044433594)  
valid subject 18 has shape : (1049, 1, 2, 3000), with range scale (154.2100067138672,-168.73309326171875)  
valid subject 0 has shape : (2570, 1, 2, 3000), with range scale (200.0,-200.0)  
valid subject 81 has shape : (1597, 1, 2, 3000), with range scale (199.14602661132812,-201.0)  
valid subject 20 has shape : (1130, 1, 2, 3000), with range scale (150.8385772705078,-190.39950561523438)  
valid subject 77 has shape : (1243, 1, 2, 3000), with range scale (200.0,-199.0)  
Loading trainer: BaseModel
Building model
Backbone: deepsleep
params set up :  {'kern_length_1': 200, 'kern_length_2': 100, 'num_ch': 2, 'samples': 3000, 'F1': 8, 'F2': 8, 'drop_prob': 0.25, 'avg_pool_1': 10, 'avg_pool_2': 10}
pretrain :  False
pretrain path : 
use max norm 0.5 constraint on last FC
# params: 11,086
save checkpoint keys :  dict_keys(['epoch', 'global_step', 'pytorch-lightning_version', 'state_dict', 'callbacks', 'optimizer_states', 'lr_schedulers'])
combine predict folder :  /data1/wduong_experiment_data/EEG_Dassl_Lightning/NeurIPS_1/task_1_final_1/quick_ver_1_1/no_aug/no_norm/deepsleep_vanilla/full_dataset/model/predict_folder/test_fold_1/valid_fold_4
Loading dataset: MultiDatasetV1
data root :  /data1/wduong_experiment_data/EEG_Dassl_Lightning/da_dataset/NeurIPS_1
dataset dir :  task_1_final_case_1
file name :  full_target_sleep.mat
r_op file path :  None
test subject idx after split :  None
train-valid idx after split :  [30 53 42 59 22 38  2 55 26  8 68 13 71 76 16 27 45 57 80 73 43 60 40 62
 54 82 69  6  3 78 50  7 33 72 48  4 15 17  5 75 41 63 34 28 11 61 23 10
 31 52 66  1 32 74 14 56 19 29 51 49 24 35 18  0 81 20 77 25 37 46 39 65
 58 12 70 36 21  9 79 67 64 47 44]
cross subject split for valid data
train subject after split :  [30, 53, 42, 59, 22, 38, 2, 55, 26, 8, 68, 13, 71, 76, 16, 27, 45, 57, 80, 73, 43, 60, 40, 62, 54, 82, 69, 6, 3, 78, 50, 7, 33, 72, 48, 4, 15, 17, 5, 75, 41, 63, 34, 28, 11, 61, 23, 10, 31, 52, 66, 1, 32, 74, 14, 56, 19, 29, 51, 49, 24, 35, 18, 0, 81, 20, 77]
valid subject after split :  [25, 37, 46, 39, 65, 58, 12, 70, 36, 21, 9, 79, 67, 64, 47, 44]
there is no test file 
train subjects :  [30, 53, 42, 59, 22, 38, 2, 55, 26, 8, 68, 13, 71, 76, 16, 27, 45, 57, 80, 73, 43, 60, 40, 62, 54, 82, 69, 6, 3, 78, 50, 7, 33, 72, 48, 4, 15, 17, 5, 75, 41, 63, 34, 28, 11, 61, 23, 10, 31, 52, 66, 1, 32, 74, 14, 56, 19, 29, 51, 49, 24, 35, 18, 0, 81, 20, 77]
Train subject 30 has shape : (919, 1, 2, 3000), with range scale (183.994140625,-186.0) 
Train subject 53 has shape : (1002, 1, 2, 3000), with range scale (188.0,-188.0) 
Train subject 42 has shape : (1128, 1, 2, 3000), with range scale (187.0,-189.0) 
Train subject 59 has shape : (1103, 1, 2, 3000), with range scale (196.0,-196.0) 
Train subject 22 has shape : (836, 1, 2, 3000), with range scale (196.0,-192.0) 
Train subject 38 has shape : (1523, 1, 2, 3000), with range scale (174.95555114746094,-183.0) 
Train subject 2 has shape : (3305, 1, 2, 3000), with range scale (162.62197875976562,-177.0) 
Train subject 55 has shape : (1053, 1, 2, 3000), with range scale (187.0,-202.0) 
Train subject 26 has shape : (1087, 1, 2, 3000), with range scale (184.77069091796875,-188.85568237304688) 
Train subject 8 has shape : (1003, 1, 2, 3000), with range scale (187.0,-178.14089965820312) 
Train subject 68 has shape : (1008, 1, 2, 3000), with range scale (190.0,-193.0) 
Train subject 13 has shape : (949, 1, 2, 3000), with range scale (187.26007080078125,-186.0) 
Train subject 71 has shape : (902, 1, 2, 3000), with range scale (176.42906188964844,-190.36068725585938) 
Train subject 76 has shape : (1728, 1, 2, 3000), with range scale (148.92283630371094,-186.7855987548828) 
Train subject 16 has shape : (1127, 1, 2, 3000), with range scale (129.90989685058594,-140.84835815429688) 
Train subject 27 has shape : (1284, 1, 2, 3000), with range scale (186.46446228027344,-192.24981689453125) 
Train subject 45 has shape : (1227, 1, 2, 3000), with range scale (206.0,-205.0) 
Train subject 57 has shape : (972, 1, 2, 3000), with range scale (146.44615173339844,-143.03076171875) 
Train subject 80 has shape : (1752, 1, 2, 3000), with range scale (187.40512084960938,-192.0) 
Train subject 73 has shape : (1770, 1, 2, 3000), with range scale (195.23419189453125,-194.0) 
Train subject 43 has shape : (1701, 1, 2, 3000), with range scale (183.6600799560547,-196.0) 
Train subject 60 has shape : (1581, 1, 2, 3000), with range scale (177.0,-175.1846160888672) 
Train subject 40 has shape : (969, 1, 2, 3000), with range scale (158.65615844726562,-185.22052001953125) 
Train subject 62 has shape : (978, 1, 2, 3000), with range scale (201.0,-201.0) 
Train subject 54 has shape : (917, 1, 2, 3000), with range scale (152.43174743652344,-174.1714324951172) 
Train subject 82 has shape : (1361, 1, 2, 3000), with range scale (182.0,-182.0) 
Train subject 69 has shape : (818, 1, 2, 3000), with range scale (176.0,-178.0) 
Train subject 6 has shape : (1240, 1, 2, 3000), with range scale (153.6827850341797,-152.89743041992188) 
Train subject 3 has shape : (3024, 1, 2, 3000), with range scale (182.0,-193.0) 
Train subject 78 has shape : (797, 1, 2, 3000), with range scale (149.3025665283203,-160.010986328125) 
Train subject 50 has shape : (1012, 1, 2, 3000), with range scale (200.0,-201.0) 
Train subject 7 has shape : (1234, 1, 2, 3000), with range scale (193.0,-193.5274658203125) 
Train subject 33 has shape : (891, 1, 2, 3000), with range scale (188.0,-166.46739196777344) 
Train subject 72 has shape : (1506, 1, 2, 3000), with range scale (176.0,-176.0) 
Train subject 48 has shape : (1179, 1, 2, 3000), with range scale (168.1758270263672,-176.0) 
Train subject 4 has shape : (4482, 1, 2, 3000), with range scale (199.0,-199.0) 
Train subject 15 has shape : (941, 1, 2, 3000), with range scale (128.11428833007812,-143.77142333984375) 
Train subject 17 has shape : (951, 1, 2, 3000), with range scale (169.06593322753906,-177.72918701171875) 
Train subject 5 has shape : (969, 1, 2, 3000), with range scale (111.14725494384766,-126.79560089111328) 
Train subject 75 has shape : (1087, 1, 2, 3000), with range scale (171.56410217285156,-179.40170288085938) 
Train subject 41 has shape : (940, 1, 2, 3000), with range scale (137.87960815429688,-155.41734313964844) 
Train subject 63 has shape : (1245, 1, 2, 3000), with range scale (180.0,-182.0) 
Train subject 34 has shape : (1649, 1, 2, 3000), with range scale (179.0,-181.0) 
Train subject 28 has shape : (1097, 1, 2, 3000), with range scale (178.0,-178.0) 
Train subject 11 has shape : (827, 1, 2, 3000), with range scale (196.0,-194.0) 
Train subject 61 has shape : (1115, 1, 2, 3000), with range scale (203.39926147460938,-208.0) 
Train subject 23 has shape : (1591, 1, 2, 3000), with range scale (187.0,-186.0) 
Train subject 10 has shape : (1027, 1, 2, 3000), with range scale (189.0,-188.0) 
Train subject 31 has shape : (1731, 1, 2, 3000), with range scale (138.56044006347656,-164.38461303710938) 
Train subject 52 has shape : (1007, 1, 2, 3000), with range scale (161.41026306152344,-164.91453552246094) 
Train subject 66 has shape : (1182, 1, 2, 3000), with range scale (192.0,-190.0) 
Train subject 1 has shape : (3187, 1, 2, 3000), with range scale (182.0,-175.92308044433594) 
Train subject 32 has shape : (950, 1, 2, 3000), with range scale (196.0,-194.0) 
Train subject 74 has shape : (1007, 1, 2, 3000), with range scale (179.26739501953125,-193.08668518066406) 
Train subject 14 has shape : (1139, 1, 2, 3000), with range scale (209.0,-211.0) 
Train subject 56 has shape : (1770, 1, 2, 3000), with range scale (189.0,-189.7008514404297) 
Train subject 19 has shape : (1005, 1, 2, 3000), with range scale (198.0,-197.0) 
Train subject 29 has shape : (1020, 1, 2, 3000), with range scale (182.07667541503906,-203.61318969726562) 
Train subject 51 has shape : (1013, 1, 2, 3000), with range scale (177.44175720214844,-190.0) 
Train subject 49 has shape : (1089, 1, 2, 3000), with range scale (206.0,-205.0) 
Train subject 24 has shape : (670, 1, 2, 3000), with range scale (182.0,-180.0) 
Train subject 35 has shape : (1518, 1, 2, 3000), with range scale (143.05250549316406,-156.92308044433594) 
Train subject 18 has shape : (1049, 1, 2, 3000), with range scale (154.2100067138672,-168.73309326171875) 
Train subject 0 has shape : (2570, 1, 2, 3000), with range scale (200.0,-200.0) 
Train subject 81 has shape : (1597, 1, 2, 3000), with range scale (199.14602661132812,-201.0) 
Train subject 20 has shape : (1130, 1, 2, 3000), with range scale (150.8385772705078,-190.39950561523438) 
Train subject 77 has shape : (1243, 1, 2, 3000), with range scale (200.0,-199.0) 
test subjects :  [25, 37, 46, 39, 65, 58, 12, 70, 36, 21, 9, 79, 67, 64, 47, 44]
test subject 25 has shape : (924, 1, 2, 3000), with range scale (157.42857360839844,-174.028564453125)  
test subject 37 has shape : (902, 1, 2, 3000), with range scale (181.95237731933594,-199.0)  
test subject 46 has shape : (1198, 1, 2, 3000), with range scale (198.0,-201.0)  
test subject 39 has shape : (1577, 1, 2, 3000), with range scale (187.03443908691406,-195.06007385253906)  
test subject 65 has shape : (1149, 1, 2, 3000), with range scale (171.1802215576172,-199.0)  
test subject 58 has shape : (1006, 1, 2, 3000), with range scale (167.63735961914062,-188.0)  
test subject 12 has shape : (1123, 1, 2, 3000), with range scale (160.25714111328125,-182.0)  
test subject 70 has shape : (1870, 1, 2, 3000), with range scale (185.1965789794922,-189.93162536621094)  
test subject 36 has shape : (1097, 1, 2, 3000), with range scale (183.13308715820312,-172.8285675048828)  
test subject 21 has shape : (1480, 1, 2, 3000), with range scale (180.7150115966797,-180.62588500976562)  
test subject 9 has shape : (1028, 1, 2, 3000), with range scale (167.55213928222656,-177.0)  
test subject 79 has shape : (1271, 1, 2, 3000), with range scale (180.0,-185.13845825195312)  
test subject 67 has shape : (1106, 1, 2, 3000), with range scale (167.0,-248.0)  
test subject 64 has shape : (788, 1, 2, 3000), with range scale (199.0,-199.0)  
test subject 47 has shape : (948, 1, 2, 3000), with range scale (178.0,-178.0)  
test subject 44 has shape : (962, 1, 2, 3000), with range scale (168.96043395996094,-180.2153778076172)  
valid subjects :  [25, 37, 46, 39, 65, 58, 12, 70, 36, 21, 9, 79, 67, 64, 47, 44]
valid subject 25 has shape : (924, 1, 2, 3000), with range scale (157.42857360839844,-174.028564453125)  
valid subject 37 has shape : (902, 1, 2, 3000), with range scale (181.95237731933594,-199.0)  
valid subject 46 has shape : (1198, 1, 2, 3000), with range scale (198.0,-201.0)  
valid subject 39 has shape : (1577, 1, 2, 3000), with range scale (187.03443908691406,-195.06007385253906)  
valid subject 65 has shape : (1149, 1, 2, 3000), with range scale (171.1802215576172,-199.0)  
valid subject 58 has shape : (1006, 1, 2, 3000), with range scale (167.63735961914062,-188.0)  
valid subject 12 has shape : (1123, 1, 2, 3000), with range scale (160.25714111328125,-182.0)  
valid subject 70 has shape : (1870, 1, 2, 3000), with range scale (185.1965789794922,-189.93162536621094)  
valid subject 36 has shape : (1097, 1, 2, 3000), with range scale (183.13308715820312,-172.8285675048828)  
valid subject 21 has shape : (1480, 1, 2, 3000), with range scale (180.7150115966797,-180.62588500976562)  
valid subject 9 has shape : (1028, 1, 2, 3000), with range scale (167.55213928222656,-177.0)  
valid subject 79 has shape : (1271, 1, 2, 3000), with range scale (180.0,-185.13845825195312)  
valid subject 67 has shape : (1106, 1, 2, 3000), with range scale (167.0,-248.0)  
valid subject 64 has shape : (788, 1, 2, 3000), with range scale (199.0,-199.0)  
valid subject 47 has shape : (948, 1, 2, 3000), with range scale (178.0,-178.0)  
valid subject 44 has shape : (962, 1, 2, 3000), with range scale (168.96043395996094,-180.2153778076172)  
Loading trainer: BaseModel
Building model
Backbone: deepsleep
params set up :  {'kern_length_1': 200, 'kern_length_2': 100, 'num_ch': 2, 'samples': 3000, 'F1': 8, 'F2': 8, 'drop_prob': 0.25, 'avg_pool_1': 10, 'avg_pool_2': 10}
pretrain :  False
pretrain path : 
use max norm 0.5 constraint on last FC
# params: 11,086
save checkpoint keys :  dict_keys(['epoch', 'global_step', 'pytorch-lightning_version', 'state_dict', 'callbacks', 'optimizer_states', 'lr_schedulers'])
combine predict folder :  /data1/wduong_experiment_data/EEG_Dassl_Lightning/NeurIPS_1/task_1_final_1/quick_ver_1_1/no_aug/no_norm/deepsleep_vanilla/full_dataset/model/predict_folder/test_fold_1/valid_fold_5
