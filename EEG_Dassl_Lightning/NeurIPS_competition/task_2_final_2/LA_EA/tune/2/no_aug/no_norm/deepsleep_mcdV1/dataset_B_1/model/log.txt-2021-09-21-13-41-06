use determinstic 
use cross channel norm :  none
generate predict :  True
load test data from file /data1/wduong_experiment_data/EEG_Dassl_Lightning/da_dataset/NeurIPS_competition/final_MI_test_B_1/dataset_B_1/NeurIPS_TL.mat
current r_op file :  /data1/wduong_experiment_data/EEG_Dassl_Lightning/da_dataset/NeurIPS_competition/final_MI_test_B_1/dataset_B_1/dataset_B_1_r_op.mat
path /data1/wduong_experiment_data/EEG_Dassl_Lightning/da_dataset/NeurIPS_competition/final_MI_test_B_1/dataset_B_1/dataset_B_1_r_op.mat exist 
use the r-op list
use r_op
use exist r_op
load test predict data ------------------
current dataset dataset_B_1
source_data subject_idx 0 has shape : (200, 17, 384), with range scale (0.5334919095039368,-0.5923439264297485) 
data shape before predict :  (200, 1, 17, 384)
use data manager for domain adaptation
Loading dataset: MultiDataset
data root :  /data1/wduong_experiment_data/EEG_Dassl_Lightning/da_dataset/NeurIPS_competition
dataset dir :  final_MI_B_1
file name :  dataset_B_1/NeurIPS_TL.mat
r_op file path :  /data1/wduong_experiment_data/EEG_Dassl_Lightning/da_dataset/NeurIPS_competition/final_MI_B_1/dataset_B_1/dataset_B_1_r_op.mat

there is test file 
run custom EA
only use r-op for subjects [0]
only use r-op for subjects [0]
only use r-op for subjects [0]
use exist r_op
use exist r_op
use exist r_op
train subjects :  [0]
Train subject 0 has shape : (96, 1, 17, 384), with range scale (0.3807092308998108,-0.502068042755127) 
test subjects :  [0]
test subject 0 has shape : (24, 1, 17, 384), with range scale (0.3695358633995056,-0.453306645154953)  
valid subjects :  [0]
valid subject 0 has shape : (24, 1, 17, 384), with range scale (0.3695358633995056,-0.453306645154953)  
the labels ratio of whole dataset : [4.571428571428571, 3.6923076923076925, 3.6923076923076925, 4.173913043478261]
source dataset idx :  0
run custom EA
generate new r_op
source_data subject_idx 0 has shape : (200, 17, 384), with range scale (2.937211513519287,-2.9535114765167236) 
source_data subject_idx 1 has shape : (200, 17, 384), with range scale (2.2420995235443115,-1.6411738395690918) 
source_data subject_idx 2 has shape : (200, 17, 384), with range scale (0.42077529430389404,-0.49243679642677307) 
source_data subject_idx 3 has shape : (200, 17, 384), with range scale (0.6385318040847778,-0.9029411673545837) 
source_data subject_idx 4 has shape : (200, 17, 384), with range scale (1.3227447271347046,-1.3087131977081299) 
source_data subject_idx 5 has shape : (200, 17, 384), with range scale (0.5790106058120728,-0.4991726577281952) 
source_data subject_idx 6 has shape : (240, 17, 384), with range scale (1.6301624774932861,-1.9021148681640625) 
source_data subject_idx 7 has shape : (200, 17, 384), with range scale (0.5079960823059082,-0.6796099543571472) 
source_data subject_idx 8 has shape : (240, 17, 384), with range scale (0.9807745814323425,-0.6181060671806335) 
source_data subject_idx 9 has shape : (200, 17, 384), with range scale (0.7310105562210083,-0.6360090374946594) 
source_data subject_idx 10 has shape : (200, 17, 384), with range scale (2.182422637939453,-2.3545570373535156) 
source_data subject_idx 11 has shape : (200, 17, 384), with range scale (0.5849239826202393,-0.46077996492385864) 
source_data subject_idx 12 has shape : (200, 17, 384), with range scale (0.3581774830818176,-0.3923951983451843) 
source_data subject_idx 13 has shape : (200, 17, 384), with range scale (0.49750474095344543,-0.5461628437042236) 
source_data subject_idx 14 has shape : (200, 17, 384), with range scale (0.6717751622200012,-0.5970268249511719) 
source_data subject_idx 15 has shape : (200, 17, 384), with range scale (0.8569704294204712,-0.9682243466377258) 
source_data subject_idx 16 has shape : (200, 17, 384), with range scale (0.6669617891311646,-0.6813054084777832) 
source_data subject_idx 17 has shape : (200, 17, 384), with range scale (1.2486547231674194,-1.3154757022857666) 
source_data subject_idx 18 has shape : (200, 17, 384), with range scale (1.672460913658142,-1.4018559455871582) 
source_data subject_idx 19 has shape : (200, 17, 384), with range scale (0.572260856628418,-0.5666975975036621) 
source_data subject_idx 20 has shape : (200, 17, 384), with range scale (0.9893567562103271,-0.7230420112609863) 
source_data subject_idx 21 has shape : (200, 17, 384), with range scale (1.9801862239837646,-1.3604015111923218) 
source_data subject_idx 22 has shape : (200, 17, 384), with range scale (1.2965723276138306,-1.036598801612854) 
source_data subject_idx 23 has shape : (200, 17, 384), with range scale (0.9192706346511841,-0.9534139633178711) 
source_data subject_idx 24 has shape : (200, 17, 384), with range scale (1.116424798965454,-1.1121643781661987) 
source_data subject_idx 25 has shape : (200, 17, 384), with range scale (2.459531545639038,-2.6785178184509277) 
source_data subject_idx 26 has shape : (200, 17, 384), with range scale (1.5890514850616455,-1.281723141670227) 
source_data subject_idx 27 has shape : (200, 17, 384), with range scale (1.3877383470535278,-1.0557307004928589) 
source_data subject_idx 28 has shape : (200, 17, 384), with range scale (1.9566757678985596,-1.6071120500564575) 
source_data subject_idx 29 has shape : (200, 17, 384), with range scale (0.5512663722038269,-0.609350323677063) 
source_data subject_idx 30 has shape : (200, 17, 384), with range scale (0.4813094139099121,-0.48981910943984985) 
source_data subject_idx 31 has shape : (200, 17, 384), with range scale (0.5656993389129639,-0.8480314612388611) 
source_data subject_idx 32 has shape : (200, 17, 384), with range scale (0.6819071769714355,-0.8403823375701904) 
source_data subject_idx 33 has shape : (200, 17, 384), with range scale (2.3148536682128906,-2.7210330963134766) 
source_data subject_idx 34 has shape : (200, 17, 384), with range scale (2.089512348175049,-2.6984357833862305) 
source_data subject_idx 35 has shape : (200, 17, 384), with range scale (2.4760074615478516,-2.414722442626953) 
source_data subject_idx 36 has shape : (200, 17, 384), with range scale (0.9220066070556641,-0.6450681686401367) 
source_data subject_idx 37 has shape : (200, 17, 384), with range scale (0.49564045667648315,-0.49382665753364563) 
source_data subject_idx 38 has shape : (200, 17, 384), with range scale (1.0751450061798096,-1.2182161808013916) 
source_data subject_idx 39 has shape : (200, 17, 384), with range scale (0.6863770484924316,-0.6525247097015381) 
source_data subject_idx 40 has shape : (200, 17, 384), with range scale (1.3930364847183228,-1.1220901012420654) 
source_data subject_idx 41 has shape : (200, 17, 384), with range scale (0.5036118626594543,-0.5589024424552917) 
source_data subject_idx 42 has shape : (200, 17, 384), with range scale (1.3904081583023071,-1.0540223121643066) 
source_data subject_idx 43 has shape : (200, 17, 384), with range scale (1.2192082405090332,-1.0318437814712524) 
source_data subject_idx 44 has shape : (200, 17, 384), with range scale (0.9187331199645996,-0.908098578453064) 
source_data subject_idx 45 has shape : (200, 17, 384), with range scale (0.9566273093223572,-0.9004712104797363) 
source_data subject_idx 46 has shape : (200, 17, 384), with range scale (1.576845407485962,-1.735642433166504) 
source_data subject_idx 47 has shape : (200, 17, 384), with range scale (1.3826144933700562,-1.5235035419464111) 
source_data subject_idx 48 has shape : (200, 17, 384), with range scale (1.0879173278808594,-0.7645584940910339) 
source dataset idx :  1
run custom EA
generate new r_op
source_data subject_idx 0 has shape : (92, 17, 384), with range scale (0.5638633966445923,-0.5482823848724365) 
source_data subject_idx 1 has shape : (89, 17, 384), with range scale (0.679806649684906,-0.8863694667816162) 
source_data subject_idx 2 has shape : (92, 17, 384), with range scale (1.0189460515975952,-1.0658504962921143) 
source_data subject_idx 3 has shape : (91, 17, 384), with range scale (0.6971561908721924,-0.79520183801651) 
source_data subject_idx 4 has shape : (88, 17, 384), with range scale (0.8715847730636597,-1.0444920063018799) 
source_data subject_idx 5 has shape : (92, 17, 384), with range scale (0.768071174621582,-0.8455631136894226) 
source_data subject_idx 6 has shape : (91, 17, 384), with range scale (0.46242257952690125,-0.49877360463142395) 
source_data subject_idx 7 has shape : (89, 17, 384), with range scale (1.3714354038238525,-1.1344454288482666) 
source_data subject_idx 8 has shape : (91, 17, 384), with range scale (0.47265124320983887,-0.43275973200798035) 
source_data subject_idx 9 has shape : (91, 17, 384), with range scale (0.42050957679748535,-0.5299843549728394) 
source_data subject_idx 10 has shape : (91, 17, 384), with range scale (1.119200587272644,-1.0912851095199585) 
source_data subject_idx 11 has shape : (89, 17, 384), with range scale (0.8202286958694458,-0.892993688583374) 
source_data subject_idx 12 has shape : (91, 17, 384), with range scale (0.649591326713562,-0.6170377135276794) 
source_data subject_idx 13 has shape : (88, 17, 384), with range scale (0.33575108647346497,-0.39282917976379395) 
source_data subject_idx 14 has shape : (91, 17, 384), with range scale (0.4218626618385315,-0.4483439028263092) 
source_data subject_idx 15 has shape : (88, 17, 384), with range scale (0.4868757724761963,-0.6685137152671814) 
source_data subject_idx 16 has shape : (89, 17, 384), with range scale (0.8764855861663818,-1.1013879776000977) 
source_data subject_idx 17 has shape : (90, 17, 384), with range scale (0.4978681206703186,-0.4512631595134735) 
source_data subject_idx 18 has shape : (91, 17, 384), with range scale (0.636901319026947,-0.49383869767189026) 
source_data subject_idx 19 has shape : (90, 17, 384), with range scale (0.757491946220398,-0.757056713104248) 
source_data subject_idx 20 has shape : (90, 17, 384), with range scale (0.40994933247566223,-0.5223227739334106) 
source_data subject_idx 21 has shape : (91, 17, 384), with range scale (0.5789008736610413,-0.8493967056274414) 
source_data subject_idx 22 has shape : (89, 17, 384), with range scale (0.8768098950386047,-0.9855356812477112) 
source_data subject_idx 23 has shape : (90, 17, 384), with range scale (0.7157535552978516,-0.8285601139068604) 
source_data subject_idx 24 has shape : (88, 17, 384), with range scale (0.9941021203994751,-1.1720207929611206) 
source_data subject_idx 25 has shape : (93, 17, 384), with range scale (0.8490782976150513,-0.7285485863685608) 
source_data subject_idx 26 has shape : (91, 17, 384), with range scale (1.2558207511901855,-1.277968406677246) 
source_data subject_idx 27 has shape : (89, 17, 384), with range scale (0.6583918333053589,-0.621597170829773) 
source_data subject_idx 28 has shape : (91, 17, 384), with range scale (0.7394693493843079,-0.6982314586639404) 
source_data subject_idx 29 has shape : (90, 17, 384), with range scale (1.7151150703430176,-1.4713311195373535) 
source_data subject_idx 30 has shape : (89, 17, 384), with range scale (0.42816561460494995,-0.5719523429870605) 
source_data subject_idx 31 has shape : (89, 17, 384), with range scale (1.042502999305725,-0.8498942255973816) 
source_data subject_idx 32 has shape : (91, 17, 384), with range scale (0.5484166741371155,-0.5430121421813965) 
source_data subject_idx 33 has shape : (89, 17, 384), with range scale (0.8400627970695496,-0.7982834577560425) 
source_data subject_idx 34 has shape : (88, 17, 384), with range scale (1.0013279914855957,-0.9534577131271362) 
source_data subject_idx 35 has shape : (91, 17, 384), with range scale (0.960991382598877,-0.9867477416992188) 
source_data subject_idx 36 has shape : (91, 17, 384), with range scale (0.5659653544425964,-0.5192583203315735) 
source_data subject_idx 37 has shape : (90, 17, 384), with range scale (0.3507167398929596,-0.39414751529693604) 
source_data subject_idx 38 has shape : (90, 17, 384), with range scale (0.4863676130771637,-0.45357435941696167) 
source_data subject_idx 39 has shape : (89, 17, 384), with range scale (0.8522043824195862,-1.5034983158111572) 
source_data subject_idx 40 has shape : (91, 17, 384), with range scale (0.6915305852890015,-0.6028938889503479) 
source_data subject_idx 41 has shape : (88, 17, 384), with range scale (0.986255407333374,-0.5629887580871582) 
source_data subject_idx 42 has shape : (90, 17, 384), with range scale (1.3001811504364014,-1.307567834854126) 
source_data subject_idx 43 has shape : (89, 17, 384), with range scale (0.5708751678466797,-0.5241150856018066) 
source_data subject_idx 44 has shape : (89, 17, 384), with range scale (0.6771137118339539,-0.9859350919723511) 
source_data subject_idx 45 has shape : (91, 17, 384), with range scale (0.6246687769889832,-0.5844350457191467) 
source_data subject_idx 46 has shape : (91, 17, 384), with range scale (0.4800527095794678,-0.5416536331176758) 
source_data subject_idx 47 has shape : (88, 17, 384), with range scale (0.5693522691726685,-0.6677132844924927) 
source_data subject_idx 48 has shape : (92, 17, 384), with range scale (0.9205516576766968,-0.8768410086631775) 
source_data subject_idx 49 has shape : (89, 17, 384), with range scale (0.7967090010643005,-1.160675287246704) 
source_data subject_idx 50 has shape : (93, 17, 384), with range scale (1.1519333124160767,-1.3142057657241821) 
source_data subject_idx 51 has shape : (92, 17, 384), with range scale (0.804955780506134,-0.8479629158973694) 
source_data subject_idx 52 has shape : (89, 17, 384), with range scale (0.9077143669128418,-0.8258190155029297) 
source_data subject_idx 53 has shape : (90, 17, 384), with range scale (0.805095374584198,-0.9022083282470703) 
source_data subject_idx 54 has shape : (90, 17, 384), with range scale (0.431754469871521,-0.37092310190200806) 
source_data subject_idx 55 has shape : (89, 17, 384), with range scale (0.9005066156387329,-0.7366292476654053) 
source_data subject_idx 56 has shape : (92, 17, 384), with range scale (1.4034347534179688,-0.8618795871734619) 
source_data subject_idx 57 has shape : (91, 17, 384), with range scale (0.8537221550941467,-1.0078247785568237) 
source_data subject_idx 58 has shape : (92, 17, 384), with range scale (1.7057923078536987,-0.7320243716239929) 
source_data subject_idx 59 has shape : (92, 17, 384), with range scale (0.5328472852706909,-0.47529998421669006) 
source_data subject_idx 60 has shape : (88, 17, 384), with range scale (0.6880220174789429,-0.6352407336235046) 
source_data subject_idx 61 has shape : (90, 17, 384), with range scale (0.4711424708366394,-0.6535595059394836) 
source_data subject_idx 62 has shape : (90, 17, 384), with range scale (2.023756265640259,-1.409857988357544) 
source_data subject_idx 63 has shape : (91, 17, 384), with range scale (0.5283695459365845,-0.5711848735809326) 
source_data subject_idx 64 has shape : (92, 17, 384), with range scale (0.7145081758499146,-0.7330948114395142) 
source_data subject_idx 65 has shape : (90, 17, 384), with range scale (1.2235162258148193,-1.4619454145431519) 
source_data subject_idx 66 has shape : (89, 17, 384), with range scale (1.0331627130508423,-1.0288171768188477) 
source_data subject_idx 67 has shape : (90, 17, 384), with range scale (0.6840547323226929,-0.5434801578521729) 
source_data subject_idx 68 has shape : (92, 17, 384), with range scale (0.4364933669567108,-0.5389034152030945) 
source_data subject_idx 69 has shape : (89, 17, 384), with range scale (0.9241401553153992,-1.1681586503982544) 
source_data subject_idx 70 has shape : (89, 17, 384), with range scale (1.2446208000183105,-1.1488087177276611) 
source_data subject_idx 71 has shape : (90, 17, 384), with range scale (0.8950789570808411,-0.9990994334220886) 
source_data subject_idx 72 has shape : (90, 17, 384), with range scale (0.5328782796859741,-0.47304052114486694) 
source_data subject_idx 73 has shape : (91, 17, 384), with range scale (0.6197287440299988,-0.7455561757087708) 
source_data subject_idx 74 has shape : (91, 17, 384), with range scale (0.733546793460846,-0.8237082958221436) 
source_data subject_idx 75 has shape : (90, 17, 384), with range scale (0.37407878041267395,-0.42007991671562195) 
source_data subject_idx 76 has shape : (89, 17, 384), with range scale (0.6831617951393127,-0.5908737182617188) 
source_data subject_idx 77 has shape : (91, 17, 384), with range scale (1.4774165153503418,-1.3162128925323486) 
source_data subject_idx 78 has shape : (91, 17, 384), with range scale (0.6632785201072693,-0.5734943747520447) 
source_data subject_idx 79 has shape : (89, 17, 384), with range scale (1.751326084136963,-1.2494912147521973) 
source_data subject_idx 80 has shape : (90, 17, 384), with range scale (0.9104030132293701,-1.0246648788452148) 
source_data subject_idx 81 has shape : (89, 17, 384), with range scale (0.6369323134422302,-0.780366063117981) 
source_data subject_idx 82 has shape : (90, 17, 384), with range scale (0.9073994159698486,-0.9700566530227661) 
source_data subject_idx 83 has shape : (91, 17, 384), with range scale (0.8803746700286865,-1.0729601383209229) 
source_data subject_idx 84 has shape : (90, 17, 384), with range scale (0.6876152753829956,-0.4928995370864868) 
source_data subject_idx 85 has shape : (91, 17, 384), with range scale (0.9712923765182495,-1.1091554164886475) 
source_data subject_idx 86 has shape : (89, 17, 384), with range scale (0.6763917803764343,-0.6116368770599365) 
source_data subject_idx 87 has shape : (114, 17, 384), with range scale (0.5263667106628418,-0.4742523431777954) 
source_data subject_idx 88 has shape : (90, 17, 384), with range scale (0.9061106443405151,-0.9881685376167297) 
source_data subject_idx 89 has shape : (90, 17, 384), with range scale (0.8025200366973877,-0.8982192277908325) 
source_data subject_idx 90 has shape : (90, 17, 384), with range scale (0.733953058719635,-0.7217971086502075) 
source_data subject_idx 91 has shape : (111, 17, 384), with range scale (0.48737621307373047,-0.5109844207763672) 
source_data subject_idx 92 has shape : (90, 17, 384), with range scale (0.48517364263534546,-0.4014579653739929) 
source_data subject_idx 93 has shape : (90, 17, 384), with range scale (0.9814346432685852,-0.6558084487915039) 
source_data subject_idx 94 has shape : (91, 17, 384), with range scale (0.9813125729560852,-1.0905110836029053) 
source_data subject_idx 95 has shape : (92, 17, 384), with range scale (0.7885937690734863,-0.8598038554191589) 
source_data subject_idx 96 has shape : (90, 17, 384), with range scale (0.5824999809265137,-1.0244135856628418) 
source_data subject_idx 97 has shape : (92, 17, 384), with range scale (0.393033504486084,-0.5365230441093445) 
source_data subject_idx 98 has shape : (91, 17, 384), with range scale (1.173887014389038,-1.152586817741394) 
source_data subject_idx 99 has shape : (72, 17, 384), with range scale (0.6981063485145569,-0.4909856617450714) 
source_data subject_idx 100 has shape : (88, 17, 384), with range scale (0.45856189727783203,-0.4575580060482025) 
source_data subject_idx 101 has shape : (89, 17, 384), with range scale (1.2391998767852783,-1.198974847793579) 
source_data subject_idx 102 has shape : (90, 17, 384), with range scale (0.6253763437271118,-0.6874272227287292) 
source_data subject_idx 103 has shape : (88, 17, 384), with range scale (0.4124441146850586,-0.7602028846740723) 
source_data subject_idx 104 has shape : (89, 17, 384), with range scale (0.709300696849823,-0.5215746164321899) 
source_data subject_idx 105 has shape : (91, 17, 384), with range scale (0.564678966999054,-0.5981682538986206) 
source_data subject_idx 106 has shape : (92, 17, 384), with range scale (0.7406887412071228,-0.9357051849365234) 
source_data subject_idx 107 has shape : (90, 17, 384), with range scale (0.6246963739395142,-0.6020163297653198) 
source_data subject_idx 108 has shape : (90, 17, 384), with range scale (1.023264765739441,-1.142183780670166) 
source dataset idx :  2
run custom EA
generate new r_op
source_data subject_idx 0 has shape : (576, 17, 384), with range scale (0.7096089720726013,-1.0166282653808594) 
source_data subject_idx 1 has shape : (576, 17, 384), with range scale (0.9572643637657166,-0.8286310434341431) 
source_data subject_idx 2 has shape : (576, 17, 384), with range scale (1.1150165796279907,-1.509000539779663) 
source_data subject_idx 3 has shape : (576, 17, 384), with range scale (0.7865085601806641,-0.970901608467102) 
source_data subject_idx 4 has shape : (576, 17, 384), with range scale (1.446355938911438,-1.6417665481567383) 
source_data subject_idx 5 has shape : (576, 17, 384), with range scale (1.1056277751922607,-1.0119190216064453) 
source_data subject_idx 6 has shape : (576, 17, 384), with range scale (0.4489593505859375,-0.46363401412963867) 
source_data subject_idx 7 has shape : (576, 17, 384), with range scale (1.1157541275024414,-1.0221753120422363) 
source_data subject_idx 8 has shape : (576, 17, 384), with range scale (0.49145689606666565,-0.5175055861473083) 
only use r-op for subjects [0]
use exist r_op
unlabel data subject_idx 0 has shape : (200, 17, 384), with range scale (0.5334919095039368,-0.5923439264297485) 
Loading trainer: MultiDatasetMCDV1
Params :  FREEZE: False
NAME: deepsleep
PARAMS:
  F1: 4
  F2: 4
  avg_pool_1: 4
  avg_pool_2: 8
  drop_prob: 0.25
  kern_length_1: 64
  kern_length_2: 16
  num_ch: 17
  samples: 384
PRETRAINED: False
PRETRAINED_PATH: 
Building F
Building CommonFeature
Backbone: deepsleep
params set up :  {'kern_length_1': 64, 'kern_length_2': 16, 'num_ch': 17, 'samples': 384, 'F1': 4, 'F2': 4, 'drop_prob': 0.25, 'avg_pool_1': 4, 'avg_pool_2': 8}
pretrain :  False
pretrain path : 
Building Target Classifier
use max norm constraint on last FC
use max norm constraint on last FC
Building SourceClassifiers
source domains label size :  [2, 4, 4]
use max norm constraint on last FC
use max norm constraint on last FC
use max norm constraint on last FC
there is n_step_F :  5
save checkpoint keys :  dict_keys(['epoch', 'global_step', 'pytorch-lightning_version', 'state_dict', 'callbacks', 'optimizer_states', 'lr_schedulers'])
combine predict folder :  /data1/wduong_experiment_data/EEG_Dassl_Lightning//NeurIPS_competition/task_2_final_2/LA_EA/tune/2//no_aug/no_norm/deepsleep_mcdV1/dataset_B_1/model/predict_folder/increment_fold_1/test_fold_1/valid_fold_1
use data manager for domain adaptation
Loading dataset: MultiDataset
data root :  /data1/wduong_experiment_data/EEG_Dassl_Lightning/da_dataset/NeurIPS_competition
dataset dir :  final_MI_B_1
file name :  dataset_B_1/NeurIPS_TL.mat
r_op file path :  /data1/wduong_experiment_data/EEG_Dassl_Lightning/da_dataset/NeurIPS_competition/final_MI_B_1/dataset_B_1/dataset_B_1_r_op.mat

there is test file 
run custom EA
only use r-op for subjects [0]
only use r-op for subjects [0]
only use r-op for subjects [0]
use exist r_op
use exist r_op
use exist r_op
train subjects :  [0]
Train subject 0 has shape : (96, 1, 17, 384), with range scale (0.3695358633995056,-0.502068042755127) 
test subjects :  [0]
test subject 0 has shape : (24, 1, 17, 384), with range scale (0.3807092308998108,-0.3749361038208008)  
valid subjects :  [0]
valid subject 0 has shape : (24, 1, 17, 384), with range scale (0.3807092308998108,-0.3749361038208008)  
the labels ratio of whole dataset : [4.0, 4.0, 4.173913043478261, 3.84]
source dataset idx :  0
run custom EA
generate new r_op
source_data subject_idx 0 has shape : (200, 17, 384), with range scale (2.937211513519287,-2.9535114765167236) 
source_data subject_idx 1 has shape : (200, 17, 384), with range scale (2.2420995235443115,-1.6411738395690918) 
source_data subject_idx 2 has shape : (200, 17, 384), with range scale (0.42077529430389404,-0.49243679642677307) 
source_data subject_idx 3 has shape : (200, 17, 384), with range scale (0.6385318040847778,-0.9029411673545837) 
source_data subject_idx 4 has shape : (200, 17, 384), with range scale (1.3227447271347046,-1.3087131977081299) 
source_data subject_idx 5 has shape : (200, 17, 384), with range scale (0.5790106058120728,-0.4991726577281952) 
source_data subject_idx 6 has shape : (240, 17, 384), with range scale (1.6301624774932861,-1.9021148681640625) 
source_data subject_idx 7 has shape : (200, 17, 384), with range scale (0.5079960823059082,-0.6796099543571472) 
source_data subject_idx 8 has shape : (240, 17, 384), with range scale (0.9807745814323425,-0.6181060671806335) 
source_data subject_idx 9 has shape : (200, 17, 384), with range scale (0.7310105562210083,-0.6360090374946594) 
source_data subject_idx 10 has shape : (200, 17, 384), with range scale (2.182422637939453,-2.3545570373535156) 
source_data subject_idx 11 has shape : (200, 17, 384), with range scale (0.5849239826202393,-0.46077996492385864) 
source_data subject_idx 12 has shape : (200, 17, 384), with range scale (0.3581774830818176,-0.3923951983451843) 
source_data subject_idx 13 has shape : (200, 17, 384), with range scale (0.49750474095344543,-0.5461628437042236) 
source_data subject_idx 14 has shape : (200, 17, 384), with range scale (0.6717751622200012,-0.5970268249511719) 
source_data subject_idx 15 has shape : (200, 17, 384), with range scale (0.8569704294204712,-0.9682243466377258) 
source_data subject_idx 16 has shape : (200, 17, 384), with range scale (0.6669617891311646,-0.6813054084777832) 
source_data subject_idx 17 has shape : (200, 17, 384), with range scale (1.2486547231674194,-1.3154757022857666) 
source_data subject_idx 18 has shape : (200, 17, 384), with range scale (1.672460913658142,-1.4018559455871582) 
source_data subject_idx 19 has shape : (200, 17, 384), with range scale (0.572260856628418,-0.5666975975036621) 
source_data subject_idx 20 has shape : (200, 17, 384), with range scale (0.9893567562103271,-0.7230420112609863) 
source_data subject_idx 21 has shape : (200, 17, 384), with range scale (1.9801862239837646,-1.3604015111923218) 
source_data subject_idx 22 has shape : (200, 17, 384), with range scale (1.2965723276138306,-1.036598801612854) 
source_data subject_idx 23 has shape : (200, 17, 384), with range scale (0.9192706346511841,-0.9534139633178711) 
source_data subject_idx 24 has shape : (200, 17, 384), with range scale (1.116424798965454,-1.1121643781661987) 
source_data subject_idx 25 has shape : (200, 17, 384), with range scale (2.459531545639038,-2.6785178184509277) 
source_data subject_idx 26 has shape : (200, 17, 384), with range scale (1.5890514850616455,-1.281723141670227) 
source_data subject_idx 27 has shape : (200, 17, 384), with range scale (1.3877383470535278,-1.0557307004928589) 
source_data subject_idx 28 has shape : (200, 17, 384), with range scale (1.9566757678985596,-1.6071120500564575) 
source_data subject_idx 29 has shape : (200, 17, 384), with range scale (0.5512663722038269,-0.609350323677063) 
source_data subject_idx 30 has shape : (200, 17, 384), with range scale (0.4813094139099121,-0.48981910943984985) 
source_data subject_idx 31 has shape : (200, 17, 384), with range scale (0.5656993389129639,-0.8480314612388611) 
source_data subject_idx 32 has shape : (200, 17, 384), with range scale (0.6819071769714355,-0.8403823375701904) 
source_data subject_idx 33 has shape : (200, 17, 384), with range scale (2.3148536682128906,-2.7210330963134766) 
source_data subject_idx 34 has shape : (200, 17, 384), with range scale (2.089512348175049,-2.6984357833862305) 
source_data subject_idx 35 has shape : (200, 17, 384), with range scale (2.4760074615478516,-2.414722442626953) 
source_data subject_idx 36 has shape : (200, 17, 384), with range scale (0.9220066070556641,-0.6450681686401367) 
source_data subject_idx 37 has shape : (200, 17, 384), with range scale (0.49564045667648315,-0.49382665753364563) 
source_data subject_idx 38 has shape : (200, 17, 384), with range scale (1.0751450061798096,-1.2182161808013916) 
source_data subject_idx 39 has shape : (200, 17, 384), with range scale (0.6863770484924316,-0.6525247097015381) 
source_data subject_idx 40 has shape : (200, 17, 384), with range scale (1.3930364847183228,-1.1220901012420654) 
source_data subject_idx 41 has shape : (200, 17, 384), with range scale (0.5036118626594543,-0.5589024424552917) 
source_data subject_idx 42 has shape : (200, 17, 384), with range scale (1.3904081583023071,-1.0540223121643066) 
source_data subject_idx 43 has shape : (200, 17, 384), with range scale (1.2192082405090332,-1.0318437814712524) 
source_data subject_idx 44 has shape : (200, 17, 384), with range scale (0.9187331199645996,-0.908098578453064) 
source_data subject_idx 45 has shape : (200, 17, 384), with range scale (0.9566273093223572,-0.9004712104797363) 
source_data subject_idx 46 has shape : (200, 17, 384), with range scale (1.576845407485962,-1.735642433166504) 
source_data subject_idx 47 has shape : (200, 17, 384), with range scale (1.3826144933700562,-1.5235035419464111) 
source_data subject_idx 48 has shape : (200, 17, 384), with range scale (1.0879173278808594,-0.7645584940910339) 
source dataset idx :  1
run custom EA
generate new r_op
source_data subject_idx 0 has shape : (92, 17, 384), with range scale (0.5638633966445923,-0.5482823848724365) 
source_data subject_idx 1 has shape : (89, 17, 384), with range scale (0.679806649684906,-0.8863694667816162) 
source_data subject_idx 2 has shape : (92, 17, 384), with range scale (1.0189460515975952,-1.0658504962921143) 
source_data subject_idx 3 has shape : (91, 17, 384), with range scale (0.6971561908721924,-0.79520183801651) 
source_data subject_idx 4 has shape : (88, 17, 384), with range scale (0.8715847730636597,-1.0444920063018799) 
source_data subject_idx 5 has shape : (92, 17, 384), with range scale (0.768071174621582,-0.8455631136894226) 
source_data subject_idx 6 has shape : (91, 17, 384), with range scale (0.46242257952690125,-0.49877360463142395) 
source_data subject_idx 7 has shape : (89, 17, 384), with range scale (1.3714354038238525,-1.1344454288482666) 
source_data subject_idx 8 has shape : (91, 17, 384), with range scale (0.47265124320983887,-0.43275973200798035) 
source_data subject_idx 9 has shape : (91, 17, 384), with range scale (0.42050957679748535,-0.5299843549728394) 
source_data subject_idx 10 has shape : (91, 17, 384), with range scale (1.119200587272644,-1.0912851095199585) 
source_data subject_idx 11 has shape : (89, 17, 384), with range scale (0.8202286958694458,-0.892993688583374) 
source_data subject_idx 12 has shape : (91, 17, 384), with range scale (0.649591326713562,-0.6170377135276794) 
source_data subject_idx 13 has shape : (88, 17, 384), with range scale (0.33575108647346497,-0.39282917976379395) 
source_data subject_idx 14 has shape : (91, 17, 384), with range scale (0.4218626618385315,-0.4483439028263092) 
source_data subject_idx 15 has shape : (88, 17, 384), with range scale (0.4868757724761963,-0.6685137152671814) 
source_data subject_idx 16 has shape : (89, 17, 384), with range scale (0.8764855861663818,-1.1013879776000977) 
source_data subject_idx 17 has shape : (90, 17, 384), with range scale (0.4978681206703186,-0.4512631595134735) 
source_data subject_idx 18 has shape : (91, 17, 384), with range scale (0.636901319026947,-0.49383869767189026) 
source_data subject_idx 19 has shape : (90, 17, 384), with range scale (0.757491946220398,-0.757056713104248) 
source_data subject_idx 20 has shape : (90, 17, 384), with range scale (0.40994933247566223,-0.5223227739334106) 
source_data subject_idx 21 has shape : (91, 17, 384), with range scale (0.5789008736610413,-0.8493967056274414) 
source_data subject_idx 22 has shape : (89, 17, 384), with range scale (0.8768098950386047,-0.9855356812477112) 
source_data subject_idx 23 has shape : (90, 17, 384), with range scale (0.7157535552978516,-0.8285601139068604) 
source_data subject_idx 24 has shape : (88, 17, 384), with range scale (0.9941021203994751,-1.1720207929611206) 
source_data subject_idx 25 has shape : (93, 17, 384), with range scale (0.8490782976150513,-0.7285485863685608) 
source_data subject_idx 26 has shape : (91, 17, 384), with range scale (1.2558207511901855,-1.277968406677246) 
source_data subject_idx 27 has shape : (89, 17, 384), with range scale (0.6583918333053589,-0.621597170829773) 
source_data subject_idx 28 has shape : (91, 17, 384), with range scale (0.7394693493843079,-0.6982314586639404) 
source_data subject_idx 29 has shape : (90, 17, 384), with range scale (1.7151150703430176,-1.4713311195373535) 
source_data subject_idx 30 has shape : (89, 17, 384), with range scale (0.42816561460494995,-0.5719523429870605) 
source_data subject_idx 31 has shape : (89, 17, 384), with range scale (1.042502999305725,-0.8498942255973816) 
source_data subject_idx 32 has shape : (91, 17, 384), with range scale (0.5484166741371155,-0.5430121421813965) 
source_data subject_idx 33 has shape : (89, 17, 384), with range scale (0.8400627970695496,-0.7982834577560425) 
source_data subject_idx 34 has shape : (88, 17, 384), with range scale (1.0013279914855957,-0.9534577131271362) 
source_data subject_idx 35 has shape : (91, 17, 384), with range scale (0.960991382598877,-0.9867477416992188) 
source_data subject_idx 36 has shape : (91, 17, 384), with range scale (0.5659653544425964,-0.5192583203315735) 
source_data subject_idx 37 has shape : (90, 17, 384), with range scale (0.3507167398929596,-0.39414751529693604) 
source_data subject_idx 38 has shape : (90, 17, 384), with range scale (0.4863676130771637,-0.45357435941696167) 
source_data subject_idx 39 has shape : (89, 17, 384), with range scale (0.8522043824195862,-1.5034983158111572) 
source_data subject_idx 40 has shape : (91, 17, 384), with range scale (0.6915305852890015,-0.6028938889503479) 
source_data subject_idx 41 has shape : (88, 17, 384), with range scale (0.986255407333374,-0.5629887580871582) 
source_data subject_idx 42 has shape : (90, 17, 384), with range scale (1.3001811504364014,-1.307567834854126) 
source_data subject_idx 43 has shape : (89, 17, 384), with range scale (0.5708751678466797,-0.5241150856018066) 
source_data subject_idx 44 has shape : (89, 17, 384), with range scale (0.6771137118339539,-0.9859350919723511) 
source_data subject_idx 45 has shape : (91, 17, 384), with range scale (0.6246687769889832,-0.5844350457191467) 
source_data subject_idx 46 has shape : (91, 17, 384), with range scale (0.4800527095794678,-0.5416536331176758) 
source_data subject_idx 47 has shape : (88, 17, 384), with range scale (0.5693522691726685,-0.6677132844924927) 
source_data subject_idx 48 has shape : (92, 17, 384), with range scale (0.9205516576766968,-0.8768410086631775) 
source_data subject_idx 49 has shape : (89, 17, 384), with range scale (0.7967090010643005,-1.160675287246704) 
source_data subject_idx 50 has shape : (93, 17, 384), with range scale (1.1519333124160767,-1.3142057657241821) 
source_data subject_idx 51 has shape : (92, 17, 384), with range scale (0.804955780506134,-0.8479629158973694) 
source_data subject_idx 52 has shape : (89, 17, 384), with range scale (0.9077143669128418,-0.8258190155029297) 
source_data subject_idx 53 has shape : (90, 17, 384), with range scale (0.805095374584198,-0.9022083282470703) 
source_data subject_idx 54 has shape : (90, 17, 384), with range scale (0.431754469871521,-0.37092310190200806) 
source_data subject_idx 55 has shape : (89, 17, 384), with range scale (0.9005066156387329,-0.7366292476654053) 
source_data subject_idx 56 has shape : (92, 17, 384), with range scale (1.4034347534179688,-0.8618795871734619) 
source_data subject_idx 57 has shape : (91, 17, 384), with range scale (0.8537221550941467,-1.0078247785568237) 
source_data subject_idx 58 has shape : (92, 17, 384), with range scale (1.7057923078536987,-0.7320243716239929) 
source_data subject_idx 59 has shape : (92, 17, 384), with range scale (0.5328472852706909,-0.47529998421669006) 
source_data subject_idx 60 has shape : (88, 17, 384), with range scale (0.6880220174789429,-0.6352407336235046) 
source_data subject_idx 61 has shape : (90, 17, 384), with range scale (0.4711424708366394,-0.6535595059394836) 
source_data subject_idx 62 has shape : (90, 17, 384), with range scale (2.023756265640259,-1.409857988357544) 
source_data subject_idx 63 has shape : (91, 17, 384), with range scale (0.5283695459365845,-0.5711848735809326) 
source_data subject_idx 64 has shape : (92, 17, 384), with range scale (0.7145081758499146,-0.7330948114395142) 
source_data subject_idx 65 has shape : (90, 17, 384), with range scale (1.2235162258148193,-1.4619454145431519) 
source_data subject_idx 66 has shape : (89, 17, 384), with range scale (1.0331627130508423,-1.0288171768188477) 
source_data subject_idx 67 has shape : (90, 17, 384), with range scale (0.6840547323226929,-0.5434801578521729) 
source_data subject_idx 68 has shape : (92, 17, 384), with range scale (0.4364933669567108,-0.5389034152030945) 
source_data subject_idx 69 has shape : (89, 17, 384), with range scale (0.9241401553153992,-1.1681586503982544) 
source_data subject_idx 70 has shape : (89, 17, 384), with range scale (1.2446208000183105,-1.1488087177276611) 
source_data subject_idx 71 has shape : (90, 17, 384), with range scale (0.8950789570808411,-0.9990994334220886) 
source_data subject_idx 72 has shape : (90, 17, 384), with range scale (0.5328782796859741,-0.47304052114486694) 
source_data subject_idx 73 has shape : (91, 17, 384), with range scale (0.6197287440299988,-0.7455561757087708) 
source_data subject_idx 74 has shape : (91, 17, 384), with range scale (0.733546793460846,-0.8237082958221436) 
source_data subject_idx 75 has shape : (90, 17, 384), with range scale (0.37407878041267395,-0.42007991671562195) 
source_data subject_idx 76 has shape : (89, 17, 384), with range scale (0.6831617951393127,-0.5908737182617188) 
source_data subject_idx 77 has shape : (91, 17, 384), with range scale (1.4774165153503418,-1.3162128925323486) 
source_data subject_idx 78 has shape : (91, 17, 384), with range scale (0.6632785201072693,-0.5734943747520447) 
source_data subject_idx 79 has shape : (89, 17, 384), with range scale (1.751326084136963,-1.2494912147521973) 
source_data subject_idx 80 has shape : (90, 17, 384), with range scale (0.9104030132293701,-1.0246648788452148) 
source_data subject_idx 81 has shape : (89, 17, 384), with range scale (0.6369323134422302,-0.780366063117981) 
source_data subject_idx 82 has shape : (90, 17, 384), with range scale (0.9073994159698486,-0.9700566530227661) 
source_data subject_idx 83 has shape : (91, 17, 384), with range scale (0.8803746700286865,-1.0729601383209229) 
source_data subject_idx 84 has shape : (90, 17, 384), with range scale (0.6876152753829956,-0.4928995370864868) 
source_data subject_idx 85 has shape : (91, 17, 384), with range scale (0.9712923765182495,-1.1091554164886475) 
source_data subject_idx 86 has shape : (89, 17, 384), with range scale (0.6763917803764343,-0.6116368770599365) 
source_data subject_idx 87 has shape : (114, 17, 384), with range scale (0.5263667106628418,-0.4742523431777954) 
source_data subject_idx 88 has shape : (90, 17, 384), with range scale (0.9061106443405151,-0.9881685376167297) 
source_data subject_idx 89 has shape : (90, 17, 384), with range scale (0.8025200366973877,-0.8982192277908325) 
source_data subject_idx 90 has shape : (90, 17, 384), with range scale (0.733953058719635,-0.7217971086502075) 
source_data subject_idx 91 has shape : (111, 17, 384), with range scale (0.48737621307373047,-0.5109844207763672) 
source_data subject_idx 92 has shape : (90, 17, 384), with range scale (0.48517364263534546,-0.4014579653739929) 
source_data subject_idx 93 has shape : (90, 17, 384), with range scale (0.9814346432685852,-0.6558084487915039) 
source_data subject_idx 94 has shape : (91, 17, 384), with range scale (0.9813125729560852,-1.0905110836029053) 
source_data subject_idx 95 has shape : (92, 17, 384), with range scale (0.7885937690734863,-0.8598038554191589) 
source_data subject_idx 96 has shape : (90, 17, 384), with range scale (0.5824999809265137,-1.0244135856628418) 
source_data subject_idx 97 has shape : (92, 17, 384), with range scale (0.393033504486084,-0.5365230441093445) 
source_data subject_idx 98 has shape : (91, 17, 384), with range scale (1.173887014389038,-1.152586817741394) 
source_data subject_idx 99 has shape : (72, 17, 384), with range scale (0.6981063485145569,-0.4909856617450714) 
source_data subject_idx 100 has shape : (88, 17, 384), with range scale (0.45856189727783203,-0.4575580060482025) 
source_data subject_idx 101 has shape : (89, 17, 384), with range scale (1.2391998767852783,-1.198974847793579) 
source_data subject_idx 102 has shape : (90, 17, 384), with range scale (0.6253763437271118,-0.6874272227287292) 
source_data subject_idx 103 has shape : (88, 17, 384), with range scale (0.4124441146850586,-0.7602028846740723) 
source_data subject_idx 104 has shape : (89, 17, 384), with range scale (0.709300696849823,-0.5215746164321899) 
source_data subject_idx 105 has shape : (91, 17, 384), with range scale (0.564678966999054,-0.5981682538986206) 
source_data subject_idx 106 has shape : (92, 17, 384), with range scale (0.7406887412071228,-0.9357051849365234) 
source_data subject_idx 107 has shape : (90, 17, 384), with range scale (0.6246963739395142,-0.6020163297653198) 
source_data subject_idx 108 has shape : (90, 17, 384), with range scale (1.023264765739441,-1.142183780670166) 
source dataset idx :  2
run custom EA
generate new r_op
source_data subject_idx 0 has shape : (576, 17, 384), with range scale (0.7096089720726013,-1.0166282653808594) 
source_data subject_idx 1 has shape : (576, 17, 384), with range scale (0.9572643637657166,-0.8286310434341431) 
source_data subject_idx 2 has shape : (576, 17, 384), with range scale (1.1150165796279907,-1.509000539779663) 
source_data subject_idx 3 has shape : (576, 17, 384), with range scale (0.7865085601806641,-0.970901608467102) 
source_data subject_idx 4 has shape : (576, 17, 384), with range scale (1.446355938911438,-1.6417665481567383) 
source_data subject_idx 5 has shape : (576, 17, 384), with range scale (1.1056277751922607,-1.0119190216064453) 
source_data subject_idx 6 has shape : (576, 17, 384), with range scale (0.4489593505859375,-0.46363401412963867) 
source_data subject_idx 7 has shape : (576, 17, 384), with range scale (1.1157541275024414,-1.0221753120422363) 
source_data subject_idx 8 has shape : (576, 17, 384), with range scale (0.49145689606666565,-0.5175055861473083) 
only use r-op for subjects [0]
use exist r_op
unlabel data subject_idx 0 has shape : (200, 17, 384), with range scale (0.5334919095039368,-0.5923439264297485) 
Loading trainer: MultiDatasetMCDV1
Params :  FREEZE: False
NAME: deepsleep
PARAMS:
  F1: 4
  F2: 4
  avg_pool_1: 4
  avg_pool_2: 8
  drop_prob: 0.25
  kern_length_1: 64
  kern_length_2: 16
  num_ch: 17
  samples: 384
PRETRAINED: False
PRETRAINED_PATH: 
Building F
Building CommonFeature
Backbone: deepsleep
params set up :  {'kern_length_1': 64, 'kern_length_2': 16, 'num_ch': 17, 'samples': 384, 'F1': 4, 'F2': 4, 'drop_prob': 0.25, 'avg_pool_1': 4, 'avg_pool_2': 8}
pretrain :  False
pretrain path : 
Building Target Classifier
use max norm constraint on last FC
use max norm constraint on last FC
Building SourceClassifiers
source domains label size :  [2, 4, 4]
use max norm constraint on last FC
use max norm constraint on last FC
use max norm constraint on last FC
there is n_step_F :  5
save checkpoint keys :  dict_keys(['epoch', 'global_step', 'pytorch-lightning_version', 'state_dict', 'callbacks', 'optimizer_states', 'lr_schedulers'])
combine predict folder :  /data1/wduong_experiment_data/EEG_Dassl_Lightning//NeurIPS_competition/task_2_final_2/LA_EA/tune/2//no_aug/no_norm/deepsleep_mcdV1/dataset_B_1/model/predict_folder/increment_fold_1/test_fold_1/valid_fold_2
use data manager for domain adaptation
Loading dataset: MultiDataset
data root :  /data1/wduong_experiment_data/EEG_Dassl_Lightning/da_dataset/NeurIPS_competition
dataset dir :  final_MI_B_1
file name :  dataset_B_1/NeurIPS_TL.mat
r_op file path :  /data1/wduong_experiment_data/EEG_Dassl_Lightning/da_dataset/NeurIPS_competition/final_MI_B_1/dataset_B_1/dataset_B_1_r_op.mat

there is test file 
run custom EA
only use r-op for subjects [0]
only use r-op for subjects [0]
only use r-op for subjects [0]
use exist r_op
use exist r_op
use exist r_op
train subjects :  [0]
Train subject 0 has shape : (96, 1, 17, 384), with range scale (0.3807092308998108,-0.502068042755127) 
test subjects :  [0]
test subject 0 has shape : (24, 1, 17, 384), with range scale (0.32620519399642944,-0.4263991713523865)  
valid subjects :  [0]
valid subject 0 has shape : (24, 1, 17, 384), with range scale (0.32620519399642944,-0.4263991713523865)  
the labels ratio of whole dataset : [4.571428571428571, 3.6923076923076925, 3.6923076923076925, 4.173913043478261]
source dataset idx :  0
run custom EA
generate new r_op
source_data subject_idx 0 has shape : (200, 17, 384), with range scale (2.937211513519287,-2.9535114765167236) 
source_data subject_idx 1 has shape : (200, 17, 384), with range scale (2.2420995235443115,-1.6411738395690918) 
source_data subject_idx 2 has shape : (200, 17, 384), with range scale (0.42077529430389404,-0.49243679642677307) 
source_data subject_idx 3 has shape : (200, 17, 384), with range scale (0.6385318040847778,-0.9029411673545837) 
source_data subject_idx 4 has shape : (200, 17, 384), with range scale (1.3227447271347046,-1.3087131977081299) 
source_data subject_idx 5 has shape : (200, 17, 384), with range scale (0.5790106058120728,-0.4991726577281952) 
source_data subject_idx 6 has shape : (240, 17, 384), with range scale (1.6301624774932861,-1.9021148681640625) 
source_data subject_idx 7 has shape : (200, 17, 384), with range scale (0.5079960823059082,-0.6796099543571472) 
source_data subject_idx 8 has shape : (240, 17, 384), with range scale (0.9807745814323425,-0.6181060671806335) 
source_data subject_idx 9 has shape : (200, 17, 384), with range scale (0.7310105562210083,-0.6360090374946594) 
source_data subject_idx 10 has shape : (200, 17, 384), with range scale (2.182422637939453,-2.3545570373535156) 
source_data subject_idx 11 has shape : (200, 17, 384), with range scale (0.5849239826202393,-0.46077996492385864) 
source_data subject_idx 12 has shape : (200, 17, 384), with range scale (0.3581774830818176,-0.3923951983451843) 
source_data subject_idx 13 has shape : (200, 17, 384), with range scale (0.49750474095344543,-0.5461628437042236) 
source_data subject_idx 14 has shape : (200, 17, 384), with range scale (0.6717751622200012,-0.5970268249511719) 
source_data subject_idx 15 has shape : (200, 17, 384), with range scale (0.8569704294204712,-0.9682243466377258) 
source_data subject_idx 16 has shape : (200, 17, 384), with range scale (0.6669617891311646,-0.6813054084777832) 
source_data subject_idx 17 has shape : (200, 17, 384), with range scale (1.2486547231674194,-1.3154757022857666) 
source_data subject_idx 18 has shape : (200, 17, 384), with range scale (1.672460913658142,-1.4018559455871582) 
source_data subject_idx 19 has shape : (200, 17, 384), with range scale (0.572260856628418,-0.5666975975036621) 
source_data subject_idx 20 has shape : (200, 17, 384), with range scale (0.9893567562103271,-0.7230420112609863) 
source_data subject_idx 21 has shape : (200, 17, 384), with range scale (1.9801862239837646,-1.3604015111923218) 
source_data subject_idx 22 has shape : (200, 17, 384), with range scale (1.2965723276138306,-1.036598801612854) 
source_data subject_idx 23 has shape : (200, 17, 384), with range scale (0.9192706346511841,-0.9534139633178711) 
source_data subject_idx 24 has shape : (200, 17, 384), with range scale (1.116424798965454,-1.1121643781661987) 
source_data subject_idx 25 has shape : (200, 17, 384), with range scale (2.459531545639038,-2.6785178184509277) 
source_data subject_idx 26 has shape : (200, 17, 384), with range scale (1.5890514850616455,-1.281723141670227) 
source_data subject_idx 27 has shape : (200, 17, 384), with range scale (1.3877383470535278,-1.0557307004928589) 
source_data subject_idx 28 has shape : (200, 17, 384), with range scale (1.9566757678985596,-1.6071120500564575) 
source_data subject_idx 29 has shape : (200, 17, 384), with range scale (0.5512663722038269,-0.609350323677063) 
source_data subject_idx 30 has shape : (200, 17, 384), with range scale (0.4813094139099121,-0.48981910943984985) 
source_data subject_idx 31 has shape : (200, 17, 384), with range scale (0.5656993389129639,-0.8480314612388611) 
source_data subject_idx 32 has shape : (200, 17, 384), with range scale (0.6819071769714355,-0.8403823375701904) 
source_data subject_idx 33 has shape : (200, 17, 384), with range scale (2.3148536682128906,-2.7210330963134766) 
source_data subject_idx 34 has shape : (200, 17, 384), with range scale (2.089512348175049,-2.6984357833862305) 
source_data subject_idx 35 has shape : (200, 17, 384), with range scale (2.4760074615478516,-2.414722442626953) 
source_data subject_idx 36 has shape : (200, 17, 384), with range scale (0.9220066070556641,-0.6450681686401367) 
source_data subject_idx 37 has shape : (200, 17, 384), with range scale (0.49564045667648315,-0.49382665753364563) 
source_data subject_idx 38 has shape : (200, 17, 384), with range scale (1.0751450061798096,-1.2182161808013916) 
source_data subject_idx 39 has shape : (200, 17, 384), with range scale (0.6863770484924316,-0.6525247097015381) 
source_data subject_idx 40 has shape : (200, 17, 384), with range scale (1.3930364847183228,-1.1220901012420654) 
source_data subject_idx 41 has shape : (200, 17, 384), with range scale (0.5036118626594543,-0.5589024424552917) 
source_data subject_idx 42 has shape : (200, 17, 384), with range scale (1.3904081583023071,-1.0540223121643066) 
source_data subject_idx 43 has shape : (200, 17, 384), with range scale (1.2192082405090332,-1.0318437814712524) 
source_data subject_idx 44 has shape : (200, 17, 384), with range scale (0.9187331199645996,-0.908098578453064) 
source_data subject_idx 45 has shape : (200, 17, 384), with range scale (0.9566273093223572,-0.9004712104797363) 
source_data subject_idx 46 has shape : (200, 17, 384), with range scale (1.576845407485962,-1.735642433166504) 
source_data subject_idx 47 has shape : (200, 17, 384), with range scale (1.3826144933700562,-1.5235035419464111) 
source_data subject_idx 48 has shape : (200, 17, 384), with range scale (1.0879173278808594,-0.7645584940910339) 
source dataset idx :  1
run custom EA
generate new r_op
source_data subject_idx 0 has shape : (92, 17, 384), with range scale (0.5638633966445923,-0.5482823848724365) 
source_data subject_idx 1 has shape : (89, 17, 384), with range scale (0.679806649684906,-0.8863694667816162) 
source_data subject_idx 2 has shape : (92, 17, 384), with range scale (1.0189460515975952,-1.0658504962921143) 
source_data subject_idx 3 has shape : (91, 17, 384), with range scale (0.6971561908721924,-0.79520183801651) 
source_data subject_idx 4 has shape : (88, 17, 384), with range scale (0.8715847730636597,-1.0444920063018799) 
source_data subject_idx 5 has shape : (92, 17, 384), with range scale (0.768071174621582,-0.8455631136894226) 
source_data subject_idx 6 has shape : (91, 17, 384), with range scale (0.46242257952690125,-0.49877360463142395) 
source_data subject_idx 7 has shape : (89, 17, 384), with range scale (1.3714354038238525,-1.1344454288482666) 
source_data subject_idx 8 has shape : (91, 17, 384), with range scale (0.47265124320983887,-0.43275973200798035) 
source_data subject_idx 9 has shape : (91, 17, 384), with range scale (0.42050957679748535,-0.5299843549728394) 
source_data subject_idx 10 has shape : (91, 17, 384), with range scale (1.119200587272644,-1.0912851095199585) 
source_data subject_idx 11 has shape : (89, 17, 384), with range scale (0.8202286958694458,-0.892993688583374) 
source_data subject_idx 12 has shape : (91, 17, 384), with range scale (0.649591326713562,-0.6170377135276794) 
source_data subject_idx 13 has shape : (88, 17, 384), with range scale (0.33575108647346497,-0.39282917976379395) 
source_data subject_idx 14 has shape : (91, 17, 384), with range scale (0.4218626618385315,-0.4483439028263092) 
source_data subject_idx 15 has shape : (88, 17, 384), with range scale (0.4868757724761963,-0.6685137152671814) 
source_data subject_idx 16 has shape : (89, 17, 384), with range scale (0.8764855861663818,-1.1013879776000977) 
source_data subject_idx 17 has shape : (90, 17, 384), with range scale (0.4978681206703186,-0.4512631595134735) 
source_data subject_idx 18 has shape : (91, 17, 384), with range scale (0.636901319026947,-0.49383869767189026) 
source_data subject_idx 19 has shape : (90, 17, 384), with range scale (0.757491946220398,-0.757056713104248) 
source_data subject_idx 20 has shape : (90, 17, 384), with range scale (0.40994933247566223,-0.5223227739334106) 
source_data subject_idx 21 has shape : (91, 17, 384), with range scale (0.5789008736610413,-0.8493967056274414) 
source_data subject_idx 22 has shape : (89, 17, 384), with range scale (0.8768098950386047,-0.9855356812477112) 
source_data subject_idx 23 has shape : (90, 17, 384), with range scale (0.7157535552978516,-0.8285601139068604) 
source_data subject_idx 24 has shape : (88, 17, 384), with range scale (0.9941021203994751,-1.1720207929611206) 
source_data subject_idx 25 has shape : (93, 17, 384), with range scale (0.8490782976150513,-0.7285485863685608) 
source_data subject_idx 26 has shape : (91, 17, 384), with range scale (1.2558207511901855,-1.277968406677246) 
source_data subject_idx 27 has shape : (89, 17, 384), with range scale (0.6583918333053589,-0.621597170829773) 
source_data subject_idx 28 has shape : (91, 17, 384), with range scale (0.7394693493843079,-0.6982314586639404) 
source_data subject_idx 29 has shape : (90, 17, 384), with range scale (1.7151150703430176,-1.4713311195373535) 
source_data subject_idx 30 has shape : (89, 17, 384), with range scale (0.42816561460494995,-0.5719523429870605) 
source_data subject_idx 31 has shape : (89, 17, 384), with range scale (1.042502999305725,-0.8498942255973816) 
source_data subject_idx 32 has shape : (91, 17, 384), with range scale (0.5484166741371155,-0.5430121421813965) 
source_data subject_idx 33 has shape : (89, 17, 384), with range scale (0.8400627970695496,-0.7982834577560425) 
source_data subject_idx 34 has shape : (88, 17, 384), with range scale (1.0013279914855957,-0.9534577131271362) 
source_data subject_idx 35 has shape : (91, 17, 384), with range scale (0.960991382598877,-0.9867477416992188) 
source_data subject_idx 36 has shape : (91, 17, 384), with range scale (0.5659653544425964,-0.5192583203315735) 
source_data subject_idx 37 has shape : (90, 17, 384), with range scale (0.3507167398929596,-0.39414751529693604) 
source_data subject_idx 38 has shape : (90, 17, 384), with range scale (0.4863676130771637,-0.45357435941696167) 
source_data subject_idx 39 has shape : (89, 17, 384), with range scale (0.8522043824195862,-1.5034983158111572) 
source_data subject_idx 40 has shape : (91, 17, 384), with range scale (0.6915305852890015,-0.6028938889503479) 
source_data subject_idx 41 has shape : (88, 17, 384), with range scale (0.986255407333374,-0.5629887580871582) 
source_data subject_idx 42 has shape : (90, 17, 384), with range scale (1.3001811504364014,-1.307567834854126) 
source_data subject_idx 43 has shape : (89, 17, 384), with range scale (0.5708751678466797,-0.5241150856018066) 
source_data subject_idx 44 has shape : (89, 17, 384), with range scale (0.6771137118339539,-0.9859350919723511) 
source_data subject_idx 45 has shape : (91, 17, 384), with range scale (0.6246687769889832,-0.5844350457191467) 
source_data subject_idx 46 has shape : (91, 17, 384), with range scale (0.4800527095794678,-0.5416536331176758) 
source_data subject_idx 47 has shape : (88, 17, 384), with range scale (0.5693522691726685,-0.6677132844924927) 
source_data subject_idx 48 has shape : (92, 17, 384), with range scale (0.9205516576766968,-0.8768410086631775) 
source_data subject_idx 49 has shape : (89, 17, 384), with range scale (0.7967090010643005,-1.160675287246704) 
source_data subject_idx 50 has shape : (93, 17, 384), with range scale (1.1519333124160767,-1.3142057657241821) 
source_data subject_idx 51 has shape : (92, 17, 384), with range scale (0.804955780506134,-0.8479629158973694) 
source_data subject_idx 52 has shape : (89, 17, 384), with range scale (0.9077143669128418,-0.8258190155029297) 
source_data subject_idx 53 has shape : (90, 17, 384), with range scale (0.805095374584198,-0.9022083282470703) 
source_data subject_idx 54 has shape : (90, 17, 384), with range scale (0.431754469871521,-0.37092310190200806) 
source_data subject_idx 55 has shape : (89, 17, 384), with range scale (0.9005066156387329,-0.7366292476654053) 
source_data subject_idx 56 has shape : (92, 17, 384), with range scale (1.4034347534179688,-0.8618795871734619) 
source_data subject_idx 57 has shape : (91, 17, 384), with range scale (0.8537221550941467,-1.0078247785568237) 
source_data subject_idx 58 has shape : (92, 17, 384), with range scale (1.7057923078536987,-0.7320243716239929) 
source_data subject_idx 59 has shape : (92, 17, 384), with range scale (0.5328472852706909,-0.47529998421669006) 
source_data subject_idx 60 has shape : (88, 17, 384), with range scale (0.6880220174789429,-0.6352407336235046) 
source_data subject_idx 61 has shape : (90, 17, 384), with range scale (0.4711424708366394,-0.6535595059394836) 
source_data subject_idx 62 has shape : (90, 17, 384), with range scale (2.023756265640259,-1.409857988357544) 
source_data subject_idx 63 has shape : (91, 17, 384), with range scale (0.5283695459365845,-0.5711848735809326) 
source_data subject_idx 64 has shape : (92, 17, 384), with range scale (0.7145081758499146,-0.7330948114395142) 
source_data subject_idx 65 has shape : (90, 17, 384), with range scale (1.2235162258148193,-1.4619454145431519) 
source_data subject_idx 66 has shape : (89, 17, 384), with range scale (1.0331627130508423,-1.0288171768188477) 
source_data subject_idx 67 has shape : (90, 17, 384), with range scale (0.6840547323226929,-0.5434801578521729) 
source_data subject_idx 68 has shape : (92, 17, 384), with range scale (0.4364933669567108,-0.5389034152030945) 
source_data subject_idx 69 has shape : (89, 17, 384), with range scale (0.9241401553153992,-1.1681586503982544) 
source_data subject_idx 70 has shape : (89, 17, 384), with range scale (1.2446208000183105,-1.1488087177276611) 
source_data subject_idx 71 has shape : (90, 17, 384), with range scale (0.8950789570808411,-0.9990994334220886) 
source_data subject_idx 72 has shape : (90, 17, 384), with range scale (0.5328782796859741,-0.47304052114486694) 
source_data subject_idx 73 has shape : (91, 17, 384), with range scale (0.6197287440299988,-0.7455561757087708) 
source_data subject_idx 74 has shape : (91, 17, 384), with range scale (0.733546793460846,-0.8237082958221436) 
source_data subject_idx 75 has shape : (90, 17, 384), with range scale (0.37407878041267395,-0.42007991671562195) 
source_data subject_idx 76 has shape : (89, 17, 384), with range scale (0.6831617951393127,-0.5908737182617188) 
source_data subject_idx 77 has shape : (91, 17, 384), with range scale (1.4774165153503418,-1.3162128925323486) 
source_data subject_idx 78 has shape : (91, 17, 384), with range scale (0.6632785201072693,-0.5734943747520447) 
source_data subject_idx 79 has shape : (89, 17, 384), with range scale (1.751326084136963,-1.2494912147521973) 
source_data subject_idx 80 has shape : (90, 17, 384), with range scale (0.9104030132293701,-1.0246648788452148) 
source_data subject_idx 81 has shape : (89, 17, 384), with range scale (0.6369323134422302,-0.780366063117981) 
source_data subject_idx 82 has shape : (90, 17, 384), with range scale (0.9073994159698486,-0.9700566530227661) 
source_data subject_idx 83 has shape : (91, 17, 384), with range scale (0.8803746700286865,-1.0729601383209229) 
source_data subject_idx 84 has shape : (90, 17, 384), with range scale (0.6876152753829956,-0.4928995370864868) 
source_data subject_idx 85 has shape : (91, 17, 384), with range scale (0.9712923765182495,-1.1091554164886475) 
source_data subject_idx 86 has shape : (89, 17, 384), with range scale (0.6763917803764343,-0.6116368770599365) 
source_data subject_idx 87 has shape : (114, 17, 384), with range scale (0.5263667106628418,-0.4742523431777954) 
source_data subject_idx 88 has shape : (90, 17, 384), with range scale (0.9061106443405151,-0.9881685376167297) 
source_data subject_idx 89 has shape : (90, 17, 384), with range scale (0.8025200366973877,-0.8982192277908325) 
source_data subject_idx 90 has shape : (90, 17, 384), with range scale (0.733953058719635,-0.7217971086502075) 
source_data subject_idx 91 has shape : (111, 17, 384), with range scale (0.48737621307373047,-0.5109844207763672) 
source_data subject_idx 92 has shape : (90, 17, 384), with range scale (0.48517364263534546,-0.4014579653739929) 
source_data subject_idx 93 has shape : (90, 17, 384), with range scale (0.9814346432685852,-0.6558084487915039) 
source_data subject_idx 94 has shape : (91, 17, 384), with range scale (0.9813125729560852,-1.0905110836029053) 
source_data subject_idx 95 has shape : (92, 17, 384), with range scale (0.7885937690734863,-0.8598038554191589) 
source_data subject_idx 96 has shape : (90, 17, 384), with range scale (0.5824999809265137,-1.0244135856628418) 
source_data subject_idx 97 has shape : (92, 17, 384), with range scale (0.393033504486084,-0.5365230441093445) 
source_data subject_idx 98 has shape : (91, 17, 384), with range scale (1.173887014389038,-1.152586817741394) 
source_data subject_idx 99 has shape : (72, 17, 384), with range scale (0.6981063485145569,-0.4909856617450714) 
source_data subject_idx 100 has shape : (88, 17, 384), with range scale (0.45856189727783203,-0.4575580060482025) 
source_data subject_idx 101 has shape : (89, 17, 384), with range scale (1.2391998767852783,-1.198974847793579) 
source_data subject_idx 102 has shape : (90, 17, 384), with range scale (0.6253763437271118,-0.6874272227287292) 
source_data subject_idx 103 has shape : (88, 17, 384), with range scale (0.4124441146850586,-0.7602028846740723) 
source_data subject_idx 104 has shape : (89, 17, 384), with range scale (0.709300696849823,-0.5215746164321899) 
source_data subject_idx 105 has shape : (91, 17, 384), with range scale (0.564678966999054,-0.5981682538986206) 
source_data subject_idx 106 has shape : (92, 17, 384), with range scale (0.7406887412071228,-0.9357051849365234) 
source_data subject_idx 107 has shape : (90, 17, 384), with range scale (0.6246963739395142,-0.6020163297653198) 
source_data subject_idx 108 has shape : (90, 17, 384), with range scale (1.023264765739441,-1.142183780670166) 
source dataset idx :  2
run custom EA
generate new r_op
source_data subject_idx 0 has shape : (576, 17, 384), with range scale (0.7096089720726013,-1.0166282653808594) 
source_data subject_idx 1 has shape : (576, 17, 384), with range scale (0.9572643637657166,-0.8286310434341431) 
source_data subject_idx 2 has shape : (576, 17, 384), with range scale (1.1150165796279907,-1.509000539779663) 
source_data subject_idx 3 has shape : (576, 17, 384), with range scale (0.7865085601806641,-0.970901608467102) 
source_data subject_idx 4 has shape : (576, 17, 384), with range scale (1.446355938911438,-1.6417665481567383) 
source_data subject_idx 5 has shape : (576, 17, 384), with range scale (1.1056277751922607,-1.0119190216064453) 
source_data subject_idx 6 has shape : (576, 17, 384), with range scale (0.4489593505859375,-0.46363401412963867) 
source_data subject_idx 7 has shape : (576, 17, 384), with range scale (1.1157541275024414,-1.0221753120422363) 
source_data subject_idx 8 has shape : (576, 17, 384), with range scale (0.49145689606666565,-0.5175055861473083) 
only use r-op for subjects [0]
use exist r_op
unlabel data subject_idx 0 has shape : (200, 17, 384), with range scale (0.5334919095039368,-0.5923439264297485) 
Loading trainer: MultiDatasetMCDV1
Params :  FREEZE: False
NAME: deepsleep
PARAMS:
  F1: 4
  F2: 4
  avg_pool_1: 4
  avg_pool_2: 8
  drop_prob: 0.25
  kern_length_1: 64
  kern_length_2: 16
  num_ch: 17
  samples: 384
PRETRAINED: False
PRETRAINED_PATH: 
Building F
Building CommonFeature
Backbone: deepsleep
params set up :  {'kern_length_1': 64, 'kern_length_2': 16, 'num_ch': 17, 'samples': 384, 'F1': 4, 'F2': 4, 'drop_prob': 0.25, 'avg_pool_1': 4, 'avg_pool_2': 8}
pretrain :  False
pretrain path : 
Building Target Classifier
use max norm constraint on last FC
use max norm constraint on last FC
Building SourceClassifiers
source domains label size :  [2, 4, 4]
use max norm constraint on last FC
use max norm constraint on last FC
use max norm constraint on last FC
there is n_step_F :  5
save checkpoint keys :  dict_keys(['epoch', 'global_step', 'pytorch-lightning_version', 'state_dict', 'callbacks', 'optimizer_states', 'lr_schedulers'])
combine predict folder :  /data1/wduong_experiment_data/EEG_Dassl_Lightning//NeurIPS_competition/task_2_final_2/LA_EA/tune/2//no_aug/no_norm/deepsleep_mcdV1/dataset_B_1/model/predict_folder/increment_fold_1/test_fold_1/valid_fold_3
use data manager for domain adaptation
Loading dataset: MultiDataset
data root :  /data1/wduong_experiment_data/EEG_Dassl_Lightning/da_dataset/NeurIPS_competition
dataset dir :  final_MI_B_1
file name :  dataset_B_1/NeurIPS_TL.mat
r_op file path :  /data1/wduong_experiment_data/EEG_Dassl_Lightning/da_dataset/NeurIPS_competition/final_MI_B_1/dataset_B_1/dataset_B_1_r_op.mat

there is test file 
run custom EA
only use r-op for subjects [0]
only use r-op for subjects [0]
only use r-op for subjects [0]
use exist r_op
use exist r_op
use exist r_op
train subjects :  [0]
Train subject 0 has shape : (96, 1, 17, 384), with range scale (0.3807092308998108,-0.453306645154953) 
test subjects :  [0]
test subject 0 has shape : (24, 1, 17, 384), with range scale (0.3349851965904236,-0.502068042755127)  
valid subjects :  [0]
valid subject 0 has shape : (24, 1, 17, 384), with range scale (0.3349851965904236,-0.502068042755127)  
the labels ratio of whole dataset : [3.84, 4.173913043478261, 4.0, 4.0]
source dataset idx :  0
run custom EA
generate new r_op
source_data subject_idx 0 has shape : (200, 17, 384), with range scale (2.937211513519287,-2.9535114765167236) 
source_data subject_idx 1 has shape : (200, 17, 384), with range scale (2.2420995235443115,-1.6411738395690918) 
source_data subject_idx 2 has shape : (200, 17, 384), with range scale (0.42077529430389404,-0.49243679642677307) 
source_data subject_idx 3 has shape : (200, 17, 384), with range scale (0.6385318040847778,-0.9029411673545837) 
source_data subject_idx 4 has shape : (200, 17, 384), with range scale (1.3227447271347046,-1.3087131977081299) 
source_data subject_idx 5 has shape : (200, 17, 384), with range scale (0.5790106058120728,-0.4991726577281952) 
source_data subject_idx 6 has shape : (240, 17, 384), with range scale (1.6301624774932861,-1.9021148681640625) 
source_data subject_idx 7 has shape : (200, 17, 384), with range scale (0.5079960823059082,-0.6796099543571472) 
source_data subject_idx 8 has shape : (240, 17, 384), with range scale (0.9807745814323425,-0.6181060671806335) 
source_data subject_idx 9 has shape : (200, 17, 384), with range scale (0.7310105562210083,-0.6360090374946594) 
source_data subject_idx 10 has shape : (200, 17, 384), with range scale (2.182422637939453,-2.3545570373535156) 
source_data subject_idx 11 has shape : (200, 17, 384), with range scale (0.5849239826202393,-0.46077996492385864) 
source_data subject_idx 12 has shape : (200, 17, 384), with range scale (0.3581774830818176,-0.3923951983451843) 
source_data subject_idx 13 has shape : (200, 17, 384), with range scale (0.49750474095344543,-0.5461628437042236) 
source_data subject_idx 14 has shape : (200, 17, 384), with range scale (0.6717751622200012,-0.5970268249511719) 
source_data subject_idx 15 has shape : (200, 17, 384), with range scale (0.8569704294204712,-0.9682243466377258) 
source_data subject_idx 16 has shape : (200, 17, 384), with range scale (0.6669617891311646,-0.6813054084777832) 
source_data subject_idx 17 has shape : (200, 17, 384), with range scale (1.2486547231674194,-1.3154757022857666) 
source_data subject_idx 18 has shape : (200, 17, 384), with range scale (1.672460913658142,-1.4018559455871582) 
source_data subject_idx 19 has shape : (200, 17, 384), with range scale (0.572260856628418,-0.5666975975036621) 
source_data subject_idx 20 has shape : (200, 17, 384), with range scale (0.9893567562103271,-0.7230420112609863) 
source_data subject_idx 21 has shape : (200, 17, 384), with range scale (1.9801862239837646,-1.3604015111923218) 
source_data subject_idx 22 has shape : (200, 17, 384), with range scale (1.2965723276138306,-1.036598801612854) 
source_data subject_idx 23 has shape : (200, 17, 384), with range scale (0.9192706346511841,-0.9534139633178711) 
source_data subject_idx 24 has shape : (200, 17, 384), with range scale (1.116424798965454,-1.1121643781661987) 
source_data subject_idx 25 has shape : (200, 17, 384), with range scale (2.459531545639038,-2.6785178184509277) 
source_data subject_idx 26 has shape : (200, 17, 384), with range scale (1.5890514850616455,-1.281723141670227) 
source_data subject_idx 27 has shape : (200, 17, 384), with range scale (1.3877383470535278,-1.0557307004928589) 
source_data subject_idx 28 has shape : (200, 17, 384), with range scale (1.9566757678985596,-1.6071120500564575) 
source_data subject_idx 29 has shape : (200, 17, 384), with range scale (0.5512663722038269,-0.609350323677063) 
source_data subject_idx 30 has shape : (200, 17, 384), with range scale (0.4813094139099121,-0.48981910943984985) 
source_data subject_idx 31 has shape : (200, 17, 384), with range scale (0.5656993389129639,-0.8480314612388611) 
source_data subject_idx 32 has shape : (200, 17, 384), with range scale (0.6819071769714355,-0.8403823375701904) 
source_data subject_idx 33 has shape : (200, 17, 384), with range scale (2.3148536682128906,-2.7210330963134766) 
source_data subject_idx 34 has shape : (200, 17, 384), with range scale (2.089512348175049,-2.6984357833862305) 
source_data subject_idx 35 has shape : (200, 17, 384), with range scale (2.4760074615478516,-2.414722442626953) 
source_data subject_idx 36 has shape : (200, 17, 384), with range scale (0.9220066070556641,-0.6450681686401367) 
source_data subject_idx 37 has shape : (200, 17, 384), with range scale (0.49564045667648315,-0.49382665753364563) 
source_data subject_idx 38 has shape : (200, 17, 384), with range scale (1.0751450061798096,-1.2182161808013916) 
source_data subject_idx 39 has shape : (200, 17, 384), with range scale (0.6863770484924316,-0.6525247097015381) 
source_data subject_idx 40 has shape : (200, 17, 384), with range scale (1.3930364847183228,-1.1220901012420654) 
source_data subject_idx 41 has shape : (200, 17, 384), with range scale (0.5036118626594543,-0.5589024424552917) 
source_data subject_idx 42 has shape : (200, 17, 384), with range scale (1.3904081583023071,-1.0540223121643066) 
source_data subject_idx 43 has shape : (200, 17, 384), with range scale (1.2192082405090332,-1.0318437814712524) 
source_data subject_idx 44 has shape : (200, 17, 384), with range scale (0.9187331199645996,-0.908098578453064) 
source_data subject_idx 45 has shape : (200, 17, 384), with range scale (0.9566273093223572,-0.9004712104797363) 
source_data subject_idx 46 has shape : (200, 17, 384), with range scale (1.576845407485962,-1.735642433166504) 
source_data subject_idx 47 has shape : (200, 17, 384), with range scale (1.3826144933700562,-1.5235035419464111) 
source_data subject_idx 48 has shape : (200, 17, 384), with range scale (1.0879173278808594,-0.7645584940910339) 
source dataset idx :  1
run custom EA
generate new r_op
source_data subject_idx 0 has shape : (92, 17, 384), with range scale (0.5638633966445923,-0.5482823848724365) 
source_data subject_idx 1 has shape : (89, 17, 384), with range scale (0.679806649684906,-0.8863694667816162) 
source_data subject_idx 2 has shape : (92, 17, 384), with range scale (1.0189460515975952,-1.0658504962921143) 
source_data subject_idx 3 has shape : (91, 17, 384), with range scale (0.6971561908721924,-0.79520183801651) 
source_data subject_idx 4 has shape : (88, 17, 384), with range scale (0.8715847730636597,-1.0444920063018799) 
source_data subject_idx 5 has shape : (92, 17, 384), with range scale (0.768071174621582,-0.8455631136894226) 
source_data subject_idx 6 has shape : (91, 17, 384), with range scale (0.46242257952690125,-0.49877360463142395) 
source_data subject_idx 7 has shape : (89, 17, 384), with range scale (1.3714354038238525,-1.1344454288482666) 
source_data subject_idx 8 has shape : (91, 17, 384), with range scale (0.47265124320983887,-0.43275973200798035) 
source_data subject_idx 9 has shape : (91, 17, 384), with range scale (0.42050957679748535,-0.5299843549728394) 
source_data subject_idx 10 has shape : (91, 17, 384), with range scale (1.119200587272644,-1.0912851095199585) 
source_data subject_idx 11 has shape : (89, 17, 384), with range scale (0.8202286958694458,-0.892993688583374) 
source_data subject_idx 12 has shape : (91, 17, 384), with range scale (0.649591326713562,-0.6170377135276794) 
source_data subject_idx 13 has shape : (88, 17, 384), with range scale (0.33575108647346497,-0.39282917976379395) 
source_data subject_idx 14 has shape : (91, 17, 384), with range scale (0.4218626618385315,-0.4483439028263092) 
source_data subject_idx 15 has shape : (88, 17, 384), with range scale (0.4868757724761963,-0.6685137152671814) 
source_data subject_idx 16 has shape : (89, 17, 384), with range scale (0.8764855861663818,-1.1013879776000977) 
source_data subject_idx 17 has shape : (90, 17, 384), with range scale (0.4978681206703186,-0.4512631595134735) 
source_data subject_idx 18 has shape : (91, 17, 384), with range scale (0.636901319026947,-0.49383869767189026) 
source_data subject_idx 19 has shape : (90, 17, 384), with range scale (0.757491946220398,-0.757056713104248) 
source_data subject_idx 20 has shape : (90, 17, 384), with range scale (0.40994933247566223,-0.5223227739334106) 
source_data subject_idx 21 has shape : (91, 17, 384), with range scale (0.5789008736610413,-0.8493967056274414) 
source_data subject_idx 22 has shape : (89, 17, 384), with range scale (0.8768098950386047,-0.9855356812477112) 
source_data subject_idx 23 has shape : (90, 17, 384), with range scale (0.7157535552978516,-0.8285601139068604) 
source_data subject_idx 24 has shape : (88, 17, 384), with range scale (0.9941021203994751,-1.1720207929611206) 
source_data subject_idx 25 has shape : (93, 17, 384), with range scale (0.8490782976150513,-0.7285485863685608) 
source_data subject_idx 26 has shape : (91, 17, 384), with range scale (1.2558207511901855,-1.277968406677246) 
source_data subject_idx 27 has shape : (89, 17, 384), with range scale (0.6583918333053589,-0.621597170829773) 
source_data subject_idx 28 has shape : (91, 17, 384), with range scale (0.7394693493843079,-0.6982314586639404) 
source_data subject_idx 29 has shape : (90, 17, 384), with range scale (1.7151150703430176,-1.4713311195373535) 
source_data subject_idx 30 has shape : (89, 17, 384), with range scale (0.42816561460494995,-0.5719523429870605) 
source_data subject_idx 31 has shape : (89, 17, 384), with range scale (1.042502999305725,-0.8498942255973816) 
source_data subject_idx 32 has shape : (91, 17, 384), with range scale (0.5484166741371155,-0.5430121421813965) 
source_data subject_idx 33 has shape : (89, 17, 384), with range scale (0.8400627970695496,-0.7982834577560425) 
source_data subject_idx 34 has shape : (88, 17, 384), with range scale (1.0013279914855957,-0.9534577131271362) 
source_data subject_idx 35 has shape : (91, 17, 384), with range scale (0.960991382598877,-0.9867477416992188) 
source_data subject_idx 36 has shape : (91, 17, 384), with range scale (0.5659653544425964,-0.5192583203315735) 
source_data subject_idx 37 has shape : (90, 17, 384), with range scale (0.3507167398929596,-0.39414751529693604) 
source_data subject_idx 38 has shape : (90, 17, 384), with range scale (0.4863676130771637,-0.45357435941696167) 
source_data subject_idx 39 has shape : (89, 17, 384), with range scale (0.8522043824195862,-1.5034983158111572) 
source_data subject_idx 40 has shape : (91, 17, 384), with range scale (0.6915305852890015,-0.6028938889503479) 
source_data subject_idx 41 has shape : (88, 17, 384), with range scale (0.986255407333374,-0.5629887580871582) 
source_data subject_idx 42 has shape : (90, 17, 384), with range scale (1.3001811504364014,-1.307567834854126) 
source_data subject_idx 43 has shape : (89, 17, 384), with range scale (0.5708751678466797,-0.5241150856018066) 
source_data subject_idx 44 has shape : (89, 17, 384), with range scale (0.6771137118339539,-0.9859350919723511) 
source_data subject_idx 45 has shape : (91, 17, 384), with range scale (0.6246687769889832,-0.5844350457191467) 
source_data subject_idx 46 has shape : (91, 17, 384), with range scale (0.4800527095794678,-0.5416536331176758) 
source_data subject_idx 47 has shape : (88, 17, 384), with range scale (0.5693522691726685,-0.6677132844924927) 
source_data subject_idx 48 has shape : (92, 17, 384), with range scale (0.9205516576766968,-0.8768410086631775) 
source_data subject_idx 49 has shape : (89, 17, 384), with range scale (0.7967090010643005,-1.160675287246704) 
source_data subject_idx 50 has shape : (93, 17, 384), with range scale (1.1519333124160767,-1.3142057657241821) 
source_data subject_idx 51 has shape : (92, 17, 384), with range scale (0.804955780506134,-0.8479629158973694) 
source_data subject_idx 52 has shape : (89, 17, 384), with range scale (0.9077143669128418,-0.8258190155029297) 
source_data subject_idx 53 has shape : (90, 17, 384), with range scale (0.805095374584198,-0.9022083282470703) 
source_data subject_idx 54 has shape : (90, 17, 384), with range scale (0.431754469871521,-0.37092310190200806) 
source_data subject_idx 55 has shape : (89, 17, 384), with range scale (0.9005066156387329,-0.7366292476654053) 
source_data subject_idx 56 has shape : (92, 17, 384), with range scale (1.4034347534179688,-0.8618795871734619) 
source_data subject_idx 57 has shape : (91, 17, 384), with range scale (0.8537221550941467,-1.0078247785568237) 
source_data subject_idx 58 has shape : (92, 17, 384), with range scale (1.7057923078536987,-0.7320243716239929) 
source_data subject_idx 59 has shape : (92, 17, 384), with range scale (0.5328472852706909,-0.47529998421669006) 
source_data subject_idx 60 has shape : (88, 17, 384), with range scale (0.6880220174789429,-0.6352407336235046) 
source_data subject_idx 61 has shape : (90, 17, 384), with range scale (0.4711424708366394,-0.6535595059394836) 
source_data subject_idx 62 has shape : (90, 17, 384), with range scale (2.023756265640259,-1.409857988357544) 
source_data subject_idx 63 has shape : (91, 17, 384), with range scale (0.5283695459365845,-0.5711848735809326) 
source_data subject_idx 64 has shape : (92, 17, 384), with range scale (0.7145081758499146,-0.7330948114395142) 
source_data subject_idx 65 has shape : (90, 17, 384), with range scale (1.2235162258148193,-1.4619454145431519) 
source_data subject_idx 66 has shape : (89, 17, 384), with range scale (1.0331627130508423,-1.0288171768188477) 
source_data subject_idx 67 has shape : (90, 17, 384), with range scale (0.6840547323226929,-0.5434801578521729) 
source_data subject_idx 68 has shape : (92, 17, 384), with range scale (0.4364933669567108,-0.5389034152030945) 
source_data subject_idx 69 has shape : (89, 17, 384), with range scale (0.9241401553153992,-1.1681586503982544) 
source_data subject_idx 70 has shape : (89, 17, 384), with range scale (1.2446208000183105,-1.1488087177276611) 
source_data subject_idx 71 has shape : (90, 17, 384), with range scale (0.8950789570808411,-0.9990994334220886) 
source_data subject_idx 72 has shape : (90, 17, 384), with range scale (0.5328782796859741,-0.47304052114486694) 
source_data subject_idx 73 has shape : (91, 17, 384), with range scale (0.6197287440299988,-0.7455561757087708) 
source_data subject_idx 74 has shape : (91, 17, 384), with range scale (0.733546793460846,-0.8237082958221436) 
source_data subject_idx 75 has shape : (90, 17, 384), with range scale (0.37407878041267395,-0.42007991671562195) 
source_data subject_idx 76 has shape : (89, 17, 384), with range scale (0.6831617951393127,-0.5908737182617188) 
source_data subject_idx 77 has shape : (91, 17, 384), with range scale (1.4774165153503418,-1.3162128925323486) 
source_data subject_idx 78 has shape : (91, 17, 384), with range scale (0.6632785201072693,-0.5734943747520447) 
source_data subject_idx 79 has shape : (89, 17, 384), with range scale (1.751326084136963,-1.2494912147521973) 
source_data subject_idx 80 has shape : (90, 17, 384), with range scale (0.9104030132293701,-1.0246648788452148) 
source_data subject_idx 81 has shape : (89, 17, 384), with range scale (0.6369323134422302,-0.780366063117981) 
source_data subject_idx 82 has shape : (90, 17, 384), with range scale (0.9073994159698486,-0.9700566530227661) 
source_data subject_idx 83 has shape : (91, 17, 384), with range scale (0.8803746700286865,-1.0729601383209229) 
source_data subject_idx 84 has shape : (90, 17, 384), with range scale (0.6876152753829956,-0.4928995370864868) 
source_data subject_idx 85 has shape : (91, 17, 384), with range scale (0.9712923765182495,-1.1091554164886475) 
source_data subject_idx 86 has shape : (89, 17, 384), with range scale (0.6763917803764343,-0.6116368770599365) 
source_data subject_idx 87 has shape : (114, 17, 384), with range scale (0.5263667106628418,-0.4742523431777954) 
source_data subject_idx 88 has shape : (90, 17, 384), with range scale (0.9061106443405151,-0.9881685376167297) 
source_data subject_idx 89 has shape : (90, 17, 384), with range scale (0.8025200366973877,-0.8982192277908325) 
source_data subject_idx 90 has shape : (90, 17, 384), with range scale (0.733953058719635,-0.7217971086502075) 
source_data subject_idx 91 has shape : (111, 17, 384), with range scale (0.48737621307373047,-0.5109844207763672) 
source_data subject_idx 92 has shape : (90, 17, 384), with range scale (0.48517364263534546,-0.4014579653739929) 
source_data subject_idx 93 has shape : (90, 17, 384), with range scale (0.9814346432685852,-0.6558084487915039) 
source_data subject_idx 94 has shape : (91, 17, 384), with range scale (0.9813125729560852,-1.0905110836029053) 
source_data subject_idx 95 has shape : (92, 17, 384), with range scale (0.7885937690734863,-0.8598038554191589) 
source_data subject_idx 96 has shape : (90, 17, 384), with range scale (0.5824999809265137,-1.0244135856628418) 
source_data subject_idx 97 has shape : (92, 17, 384), with range scale (0.393033504486084,-0.5365230441093445) 
source_data subject_idx 98 has shape : (91, 17, 384), with range scale (1.173887014389038,-1.152586817741394) 
source_data subject_idx 99 has shape : (72, 17, 384), with range scale (0.6981063485145569,-0.4909856617450714) 
source_data subject_idx 100 has shape : (88, 17, 384), with range scale (0.45856189727783203,-0.4575580060482025) 
source_data subject_idx 101 has shape : (89, 17, 384), with range scale (1.2391998767852783,-1.198974847793579) 
source_data subject_idx 102 has shape : (90, 17, 384), with range scale (0.6253763437271118,-0.6874272227287292) 
source_data subject_idx 103 has shape : (88, 17, 384), with range scale (0.4124441146850586,-0.7602028846740723) 
source_data subject_idx 104 has shape : (89, 17, 384), with range scale (0.709300696849823,-0.5215746164321899) 
source_data subject_idx 105 has shape : (91, 17, 384), with range scale (0.564678966999054,-0.5981682538986206) 
source_data subject_idx 106 has shape : (92, 17, 384), with range scale (0.7406887412071228,-0.9357051849365234) 
source_data subject_idx 107 has shape : (90, 17, 384), with range scale (0.6246963739395142,-0.6020163297653198) 
source_data subject_idx 108 has shape : (90, 17, 384), with range scale (1.023264765739441,-1.142183780670166) 
source dataset idx :  2
run custom EA
generate new r_op
source_data subject_idx 0 has shape : (576, 17, 384), with range scale (0.7096089720726013,-1.0166282653808594) 
source_data subject_idx 1 has shape : (576, 17, 384), with range scale (0.9572643637657166,-0.8286310434341431) 
source_data subject_idx 2 has shape : (576, 17, 384), with range scale (1.1150165796279907,-1.509000539779663) 
source_data subject_idx 3 has shape : (576, 17, 384), with range scale (0.7865085601806641,-0.970901608467102) 
source_data subject_idx 4 has shape : (576, 17, 384), with range scale (1.446355938911438,-1.6417665481567383) 
source_data subject_idx 5 has shape : (576, 17, 384), with range scale (1.1056277751922607,-1.0119190216064453) 
source_data subject_idx 6 has shape : (576, 17, 384), with range scale (0.4489593505859375,-0.46363401412963867) 
source_data subject_idx 7 has shape : (576, 17, 384), with range scale (1.1157541275024414,-1.0221753120422363) 
source_data subject_idx 8 has shape : (576, 17, 384), with range scale (0.49145689606666565,-0.5175055861473083) 
only use r-op for subjects [0]
use exist r_op
unlabel data subject_idx 0 has shape : (200, 17, 384), with range scale (0.5334919095039368,-0.5923439264297485) 
Loading trainer: MultiDatasetMCDV1
Params :  FREEZE: False
NAME: deepsleep
PARAMS:
  F1: 4
  F2: 4
  avg_pool_1: 4
  avg_pool_2: 8
  drop_prob: 0.25
  kern_length_1: 64
  kern_length_2: 16
  num_ch: 17
  samples: 384
PRETRAINED: False
PRETRAINED_PATH: 
Building F
Building CommonFeature
Backbone: deepsleep
params set up :  {'kern_length_1': 64, 'kern_length_2': 16, 'num_ch': 17, 'samples': 384, 'F1': 4, 'F2': 4, 'drop_prob': 0.25, 'avg_pool_1': 4, 'avg_pool_2': 8}
pretrain :  False
pretrain path : 
Building Target Classifier
use max norm constraint on last FC
use max norm constraint on last FC
Building SourceClassifiers
source domains label size :  [2, 4, 4]
use max norm constraint on last FC
use max norm constraint on last FC
use max norm constraint on last FC
there is n_step_F :  5
save checkpoint keys :  dict_keys(['epoch', 'global_step', 'pytorch-lightning_version', 'state_dict', 'callbacks', 'optimizer_states', 'lr_schedulers'])
combine predict folder :  /data1/wduong_experiment_data/EEG_Dassl_Lightning//NeurIPS_competition/task_2_final_2/LA_EA/tune/2//no_aug/no_norm/deepsleep_mcdV1/dataset_B_1/model/predict_folder/increment_fold_1/test_fold_1/valid_fold_4
use data manager for domain adaptation
Loading dataset: MultiDataset
data root :  /data1/wduong_experiment_data/EEG_Dassl_Lightning/da_dataset/NeurIPS_competition
dataset dir :  final_MI_B_1
file name :  dataset_B_1/NeurIPS_TL.mat
r_op file path :  /data1/wduong_experiment_data/EEG_Dassl_Lightning/da_dataset/NeurIPS_competition/final_MI_B_1/dataset_B_1/dataset_B_1_r_op.mat

there is test file 
run custom EA
only use r-op for subjects [0]
only use r-op for subjects [0]
only use r-op for subjects [0]
use exist r_op
use exist r_op
use exist r_op
train subjects :  [0]
Train subject 0 has shape : (96, 1, 17, 384), with range scale (0.3807092308998108,-0.502068042755127) 
test subjects :  [0]
test subject 0 has shape : (24, 1, 17, 384), with range scale (0.342695415019989,-0.3774373531341553)  
valid subjects :  [0]
valid subject 0 has shape : (24, 1, 17, 384), with range scale (0.342695415019989,-0.3774373531341553)  
the labels ratio of whole dataset : [3.310344827586207, 4.571428571428571, 4.571428571428571, 3.84]
source dataset idx :  0
run custom EA
generate new r_op
source_data subject_idx 0 has shape : (200, 17, 384), with range scale (2.937211513519287,-2.9535114765167236) 
source_data subject_idx 1 has shape : (200, 17, 384), with range scale (2.2420995235443115,-1.6411738395690918) 
source_data subject_idx 2 has shape : (200, 17, 384), with range scale (0.42077529430389404,-0.49243679642677307) 
source_data subject_idx 3 has shape : (200, 17, 384), with range scale (0.6385318040847778,-0.9029411673545837) 
source_data subject_idx 4 has shape : (200, 17, 384), with range scale (1.3227447271347046,-1.3087131977081299) 
source_data subject_idx 5 has shape : (200, 17, 384), with range scale (0.5790106058120728,-0.4991726577281952) 
source_data subject_idx 6 has shape : (240, 17, 384), with range scale (1.6301624774932861,-1.9021148681640625) 
source_data subject_idx 7 has shape : (200, 17, 384), with range scale (0.5079960823059082,-0.6796099543571472) 
source_data subject_idx 8 has shape : (240, 17, 384), with range scale (0.9807745814323425,-0.6181060671806335) 
source_data subject_idx 9 has shape : (200, 17, 384), with range scale (0.7310105562210083,-0.6360090374946594) 
source_data subject_idx 10 has shape : (200, 17, 384), with range scale (2.182422637939453,-2.3545570373535156) 
source_data subject_idx 11 has shape : (200, 17, 384), with range scale (0.5849239826202393,-0.46077996492385864) 
source_data subject_idx 12 has shape : (200, 17, 384), with range scale (0.3581774830818176,-0.3923951983451843) 
source_data subject_idx 13 has shape : (200, 17, 384), with range scale (0.49750474095344543,-0.5461628437042236) 
source_data subject_idx 14 has shape : (200, 17, 384), with range scale (0.6717751622200012,-0.5970268249511719) 
source_data subject_idx 15 has shape : (200, 17, 384), with range scale (0.8569704294204712,-0.9682243466377258) 
source_data subject_idx 16 has shape : (200, 17, 384), with range scale (0.6669617891311646,-0.6813054084777832) 
source_data subject_idx 17 has shape : (200, 17, 384), with range scale (1.2486547231674194,-1.3154757022857666) 
source_data subject_idx 18 has shape : (200, 17, 384), with range scale (1.672460913658142,-1.4018559455871582) 
source_data subject_idx 19 has shape : (200, 17, 384), with range scale (0.572260856628418,-0.5666975975036621) 
source_data subject_idx 20 has shape : (200, 17, 384), with range scale (0.9893567562103271,-0.7230420112609863) 
source_data subject_idx 21 has shape : (200, 17, 384), with range scale (1.9801862239837646,-1.3604015111923218) 
source_data subject_idx 22 has shape : (200, 17, 384), with range scale (1.2965723276138306,-1.036598801612854) 
source_data subject_idx 23 has shape : (200, 17, 384), with range scale (0.9192706346511841,-0.9534139633178711) 
source_data subject_idx 24 has shape : (200, 17, 384), with range scale (1.116424798965454,-1.1121643781661987) 
source_data subject_idx 25 has shape : (200, 17, 384), with range scale (2.459531545639038,-2.6785178184509277) 
source_data subject_idx 26 has shape : (200, 17, 384), with range scale (1.5890514850616455,-1.281723141670227) 
source_data subject_idx 27 has shape : (200, 17, 384), with range scale (1.3877383470535278,-1.0557307004928589) 
source_data subject_idx 28 has shape : (200, 17, 384), with range scale (1.9566757678985596,-1.6071120500564575) 
source_data subject_idx 29 has shape : (200, 17, 384), with range scale (0.5512663722038269,-0.609350323677063) 
source_data subject_idx 30 has shape : (200, 17, 384), with range scale (0.4813094139099121,-0.48981910943984985) 
source_data subject_idx 31 has shape : (200, 17, 384), with range scale (0.5656993389129639,-0.8480314612388611) 
source_data subject_idx 32 has shape : (200, 17, 384), with range scale (0.6819071769714355,-0.8403823375701904) 
source_data subject_idx 33 has shape : (200, 17, 384), with range scale (2.3148536682128906,-2.7210330963134766) 
source_data subject_idx 34 has shape : (200, 17, 384), with range scale (2.089512348175049,-2.6984357833862305) 
source_data subject_idx 35 has shape : (200, 17, 384), with range scale (2.4760074615478516,-2.414722442626953) 
source_data subject_idx 36 has shape : (200, 17, 384), with range scale (0.9220066070556641,-0.6450681686401367) 
source_data subject_idx 37 has shape : (200, 17, 384), with range scale (0.49564045667648315,-0.49382665753364563) 
source_data subject_idx 38 has shape : (200, 17, 384), with range scale (1.0751450061798096,-1.2182161808013916) 
source_data subject_idx 39 has shape : (200, 17, 384), with range scale (0.6863770484924316,-0.6525247097015381) 
source_data subject_idx 40 has shape : (200, 17, 384), with range scale (1.3930364847183228,-1.1220901012420654) 
source_data subject_idx 41 has shape : (200, 17, 384), with range scale (0.5036118626594543,-0.5589024424552917) 
source_data subject_idx 42 has shape : (200, 17, 384), with range scale (1.3904081583023071,-1.0540223121643066) 
source_data subject_idx 43 has shape : (200, 17, 384), with range scale (1.2192082405090332,-1.0318437814712524) 
source_data subject_idx 44 has shape : (200, 17, 384), with range scale (0.9187331199645996,-0.908098578453064) 
source_data subject_idx 45 has shape : (200, 17, 384), with range scale (0.9566273093223572,-0.9004712104797363) 
source_data subject_idx 46 has shape : (200, 17, 384), with range scale (1.576845407485962,-1.735642433166504) 
source_data subject_idx 47 has shape : (200, 17, 384), with range scale (1.3826144933700562,-1.5235035419464111) 
source_data subject_idx 48 has shape : (200, 17, 384), with range scale (1.0879173278808594,-0.7645584940910339) 
source dataset idx :  1
run custom EA
generate new r_op
source_data subject_idx 0 has shape : (92, 17, 384), with range scale (0.5638633966445923,-0.5482823848724365) 
source_data subject_idx 1 has shape : (89, 17, 384), with range scale (0.679806649684906,-0.8863694667816162) 
source_data subject_idx 2 has shape : (92, 17, 384), with range scale (1.0189460515975952,-1.0658504962921143) 
source_data subject_idx 3 has shape : (91, 17, 384), with range scale (0.6971561908721924,-0.79520183801651) 
source_data subject_idx 4 has shape : (88, 17, 384), with range scale (0.8715847730636597,-1.0444920063018799) 
source_data subject_idx 5 has shape : (92, 17, 384), with range scale (0.768071174621582,-0.8455631136894226) 
source_data subject_idx 6 has shape : (91, 17, 384), with range scale (0.46242257952690125,-0.49877360463142395) 
source_data subject_idx 7 has shape : (89, 17, 384), with range scale (1.3714354038238525,-1.1344454288482666) 
source_data subject_idx 8 has shape : (91, 17, 384), with range scale (0.47265124320983887,-0.43275973200798035) 
source_data subject_idx 9 has shape : (91, 17, 384), with range scale (0.42050957679748535,-0.5299843549728394) 
source_data subject_idx 10 has shape : (91, 17, 384), with range scale (1.119200587272644,-1.0912851095199585) 
source_data subject_idx 11 has shape : (89, 17, 384), with range scale (0.8202286958694458,-0.892993688583374) 
source_data subject_idx 12 has shape : (91, 17, 384), with range scale (0.649591326713562,-0.6170377135276794) 
source_data subject_idx 13 has shape : (88, 17, 384), with range scale (0.33575108647346497,-0.39282917976379395) 
source_data subject_idx 14 has shape : (91, 17, 384), with range scale (0.4218626618385315,-0.4483439028263092) 
source_data subject_idx 15 has shape : (88, 17, 384), with range scale (0.4868757724761963,-0.6685137152671814) 
source_data subject_idx 16 has shape : (89, 17, 384), with range scale (0.8764855861663818,-1.1013879776000977) 
source_data subject_idx 17 has shape : (90, 17, 384), with range scale (0.4978681206703186,-0.4512631595134735) 
source_data subject_idx 18 has shape : (91, 17, 384), with range scale (0.636901319026947,-0.49383869767189026) 
source_data subject_idx 19 has shape : (90, 17, 384), with range scale (0.757491946220398,-0.757056713104248) 
source_data subject_idx 20 has shape : (90, 17, 384), with range scale (0.40994933247566223,-0.5223227739334106) 
source_data subject_idx 21 has shape : (91, 17, 384), with range scale (0.5789008736610413,-0.8493967056274414) 
source_data subject_idx 22 has shape : (89, 17, 384), with range scale (0.8768098950386047,-0.9855356812477112) 
source_data subject_idx 23 has shape : (90, 17, 384), with range scale (0.7157535552978516,-0.8285601139068604) 
source_data subject_idx 24 has shape : (88, 17, 384), with range scale (0.9941021203994751,-1.1720207929611206) 
source_data subject_idx 25 has shape : (93, 17, 384), with range scale (0.8490782976150513,-0.7285485863685608) 
source_data subject_idx 26 has shape : (91, 17, 384), with range scale (1.2558207511901855,-1.277968406677246) 
source_data subject_idx 27 has shape : (89, 17, 384), with range scale (0.6583918333053589,-0.621597170829773) 
source_data subject_idx 28 has shape : (91, 17, 384), with range scale (0.7394693493843079,-0.6982314586639404) 
source_data subject_idx 29 has shape : (90, 17, 384), with range scale (1.7151150703430176,-1.4713311195373535) 
source_data subject_idx 30 has shape : (89, 17, 384), with range scale (0.42816561460494995,-0.5719523429870605) 
source_data subject_idx 31 has shape : (89, 17, 384), with range scale (1.042502999305725,-0.8498942255973816) 
source_data subject_idx 32 has shape : (91, 17, 384), with range scale (0.5484166741371155,-0.5430121421813965) 
source_data subject_idx 33 has shape : (89, 17, 384), with range scale (0.8400627970695496,-0.7982834577560425) 
source_data subject_idx 34 has shape : (88, 17, 384), with range scale (1.0013279914855957,-0.9534577131271362) 
source_data subject_idx 35 has shape : (91, 17, 384), with range scale (0.960991382598877,-0.9867477416992188) 
source_data subject_idx 36 has shape : (91, 17, 384), with range scale (0.5659653544425964,-0.5192583203315735) 
source_data subject_idx 37 has shape : (90, 17, 384), with range scale (0.3507167398929596,-0.39414751529693604) 
source_data subject_idx 38 has shape : (90, 17, 384), with range scale (0.4863676130771637,-0.45357435941696167) 
source_data subject_idx 39 has shape : (89, 17, 384), with range scale (0.8522043824195862,-1.5034983158111572) 
source_data subject_idx 40 has shape : (91, 17, 384), with range scale (0.6915305852890015,-0.6028938889503479) 
source_data subject_idx 41 has shape : (88, 17, 384), with range scale (0.986255407333374,-0.5629887580871582) 
source_data subject_idx 42 has shape : (90, 17, 384), with range scale (1.3001811504364014,-1.307567834854126) 
source_data subject_idx 43 has shape : (89, 17, 384), with range scale (0.5708751678466797,-0.5241150856018066) 
source_data subject_idx 44 has shape : (89, 17, 384), with range scale (0.6771137118339539,-0.9859350919723511) 
source_data subject_idx 45 has shape : (91, 17, 384), with range scale (0.6246687769889832,-0.5844350457191467) 
source_data subject_idx 46 has shape : (91, 17, 384), with range scale (0.4800527095794678,-0.5416536331176758) 
source_data subject_idx 47 has shape : (88, 17, 384), with range scale (0.5693522691726685,-0.6677132844924927) 
source_data subject_idx 48 has shape : (92, 17, 384), with range scale (0.9205516576766968,-0.8768410086631775) 
source_data subject_idx 49 has shape : (89, 17, 384), with range scale (0.7967090010643005,-1.160675287246704) 
source_data subject_idx 50 has shape : (93, 17, 384), with range scale (1.1519333124160767,-1.3142057657241821) 
source_data subject_idx 51 has shape : (92, 17, 384), with range scale (0.804955780506134,-0.8479629158973694) 
source_data subject_idx 52 has shape : (89, 17, 384), with range scale (0.9077143669128418,-0.8258190155029297) 
source_data subject_idx 53 has shape : (90, 17, 384), with range scale (0.805095374584198,-0.9022083282470703) 
source_data subject_idx 54 has shape : (90, 17, 384), with range scale (0.431754469871521,-0.37092310190200806) 
source_data subject_idx 55 has shape : (89, 17, 384), with range scale (0.9005066156387329,-0.7366292476654053) 
source_data subject_idx 56 has shape : (92, 17, 384), with range scale (1.4034347534179688,-0.8618795871734619) 
source_data subject_idx 57 has shape : (91, 17, 384), with range scale (0.8537221550941467,-1.0078247785568237) 
source_data subject_idx 58 has shape : (92, 17, 384), with range scale (1.7057923078536987,-0.7320243716239929) 
source_data subject_idx 59 has shape : (92, 17, 384), with range scale (0.5328472852706909,-0.47529998421669006) 
source_data subject_idx 60 has shape : (88, 17, 384), with range scale (0.6880220174789429,-0.6352407336235046) 
source_data subject_idx 61 has shape : (90, 17, 384), with range scale (0.4711424708366394,-0.6535595059394836) 
source_data subject_idx 62 has shape : (90, 17, 384), with range scale (2.023756265640259,-1.409857988357544) 
source_data subject_idx 63 has shape : (91, 17, 384), with range scale (0.5283695459365845,-0.5711848735809326) 
source_data subject_idx 64 has shape : (92, 17, 384), with range scale (0.7145081758499146,-0.7330948114395142) 
source_data subject_idx 65 has shape : (90, 17, 384), with range scale (1.2235162258148193,-1.4619454145431519) 
source_data subject_idx 66 has shape : (89, 17, 384), with range scale (1.0331627130508423,-1.0288171768188477) 
source_data subject_idx 67 has shape : (90, 17, 384), with range scale (0.6840547323226929,-0.5434801578521729) 
source_data subject_idx 68 has shape : (92, 17, 384), with range scale (0.4364933669567108,-0.5389034152030945) 
source_data subject_idx 69 has shape : (89, 17, 384), with range scale (0.9241401553153992,-1.1681586503982544) 
source_data subject_idx 70 has shape : (89, 17, 384), with range scale (1.2446208000183105,-1.1488087177276611) 
source_data subject_idx 71 has shape : (90, 17, 384), with range scale (0.8950789570808411,-0.9990994334220886) 
source_data subject_idx 72 has shape : (90, 17, 384), with range scale (0.5328782796859741,-0.47304052114486694) 
source_data subject_idx 73 has shape : (91, 17, 384), with range scale (0.6197287440299988,-0.7455561757087708) 
source_data subject_idx 74 has shape : (91, 17, 384), with range scale (0.733546793460846,-0.8237082958221436) 
source_data subject_idx 75 has shape : (90, 17, 384), with range scale (0.37407878041267395,-0.42007991671562195) 
source_data subject_idx 76 has shape : (89, 17, 384), with range scale (0.6831617951393127,-0.5908737182617188) 
source_data subject_idx 77 has shape : (91, 17, 384), with range scale (1.4774165153503418,-1.3162128925323486) 
source_data subject_idx 78 has shape : (91, 17, 384), with range scale (0.6632785201072693,-0.5734943747520447) 
source_data subject_idx 79 has shape : (89, 17, 384), with range scale (1.751326084136963,-1.2494912147521973) 
source_data subject_idx 80 has shape : (90, 17, 384), with range scale (0.9104030132293701,-1.0246648788452148) 
source_data subject_idx 81 has shape : (89, 17, 384), with range scale (0.6369323134422302,-0.780366063117981) 
source_data subject_idx 82 has shape : (90, 17, 384), with range scale (0.9073994159698486,-0.9700566530227661) 
source_data subject_idx 83 has shape : (91, 17, 384), with range scale (0.8803746700286865,-1.0729601383209229) 
source_data subject_idx 84 has shape : (90, 17, 384), with range scale (0.6876152753829956,-0.4928995370864868) 
source_data subject_idx 85 has shape : (91, 17, 384), with range scale (0.9712923765182495,-1.1091554164886475) 
source_data subject_idx 86 has shape : (89, 17, 384), with range scale (0.6763917803764343,-0.6116368770599365) 
source_data subject_idx 87 has shape : (114, 17, 384), with range scale (0.5263667106628418,-0.4742523431777954) 
source_data subject_idx 88 has shape : (90, 17, 384), with range scale (0.9061106443405151,-0.9881685376167297) 
source_data subject_idx 89 has shape : (90, 17, 384), with range scale (0.8025200366973877,-0.8982192277908325) 
source_data subject_idx 90 has shape : (90, 17, 384), with range scale (0.733953058719635,-0.7217971086502075) 
source_data subject_idx 91 has shape : (111, 17, 384), with range scale (0.48737621307373047,-0.5109844207763672) 
source_data subject_idx 92 has shape : (90, 17, 384), with range scale (0.48517364263534546,-0.4014579653739929) 
source_data subject_idx 93 has shape : (90, 17, 384), with range scale (0.9814346432685852,-0.6558084487915039) 
source_data subject_idx 94 has shape : (91, 17, 384), with range scale (0.9813125729560852,-1.0905110836029053) 
source_data subject_idx 95 has shape : (92, 17, 384), with range scale (0.7885937690734863,-0.8598038554191589) 
source_data subject_idx 96 has shape : (90, 17, 384), with range scale (0.5824999809265137,-1.0244135856628418) 
source_data subject_idx 97 has shape : (92, 17, 384), with range scale (0.393033504486084,-0.5365230441093445) 
source_data subject_idx 98 has shape : (91, 17, 384), with range scale (1.173887014389038,-1.152586817741394) 
source_data subject_idx 99 has shape : (72, 17, 384), with range scale (0.6981063485145569,-0.4909856617450714) 
source_data subject_idx 100 has shape : (88, 17, 384), with range scale (0.45856189727783203,-0.4575580060482025) 
source_data subject_idx 101 has shape : (89, 17, 384), with range scale (1.2391998767852783,-1.198974847793579) 
source_data subject_idx 102 has shape : (90, 17, 384), with range scale (0.6253763437271118,-0.6874272227287292) 
source_data subject_idx 103 has shape : (88, 17, 384), with range scale (0.4124441146850586,-0.7602028846740723) 
source_data subject_idx 104 has shape : (89, 17, 384), with range scale (0.709300696849823,-0.5215746164321899) 
source_data subject_idx 105 has shape : (91, 17, 384), with range scale (0.564678966999054,-0.5981682538986206) 
source_data subject_idx 106 has shape : (92, 17, 384), with range scale (0.7406887412071228,-0.9357051849365234) 
source_data subject_idx 107 has shape : (90, 17, 384), with range scale (0.6246963739395142,-0.6020163297653198) 
source_data subject_idx 108 has shape : (90, 17, 384), with range scale (1.023264765739441,-1.142183780670166) 
source dataset idx :  2
run custom EA
generate new r_op
source_data subject_idx 0 has shape : (576, 17, 384), with range scale (0.7096089720726013,-1.0166282653808594) 
source_data subject_idx 1 has shape : (576, 17, 384), with range scale (0.9572643637657166,-0.8286310434341431) 
source_data subject_idx 2 has shape : (576, 17, 384), with range scale (1.1150165796279907,-1.509000539779663) 
source_data subject_idx 3 has shape : (576, 17, 384), with range scale (0.7865085601806641,-0.970901608467102) 
source_data subject_idx 4 has shape : (576, 17, 384), with range scale (1.446355938911438,-1.6417665481567383) 
source_data subject_idx 5 has shape : (576, 17, 384), with range scale (1.1056277751922607,-1.0119190216064453) 
source_data subject_idx 6 has shape : (576, 17, 384), with range scale (0.4489593505859375,-0.46363401412963867) 
source_data subject_idx 7 has shape : (576, 17, 384), with range scale (1.1157541275024414,-1.0221753120422363) 
source_data subject_idx 8 has shape : (576, 17, 384), with range scale (0.49145689606666565,-0.5175055861473083) 
only use r-op for subjects [0]
use exist r_op
unlabel data subject_idx 0 has shape : (200, 17, 384), with range scale (0.5334919095039368,-0.5923439264297485) 
Loading trainer: MultiDatasetMCDV1
Params :  FREEZE: False
NAME: deepsleep
PARAMS:
  F1: 4
  F2: 4
  avg_pool_1: 4
  avg_pool_2: 8
  drop_prob: 0.25
  kern_length_1: 64
  kern_length_2: 16
  num_ch: 17
  samples: 384
PRETRAINED: False
PRETRAINED_PATH: 
Building F
Building CommonFeature
Backbone: deepsleep
params set up :  {'kern_length_1': 64, 'kern_length_2': 16, 'num_ch': 17, 'samples': 384, 'F1': 4, 'F2': 4, 'drop_prob': 0.25, 'avg_pool_1': 4, 'avg_pool_2': 8}
pretrain :  False
pretrain path : 
Building Target Classifier
use max norm constraint on last FC
use max norm constraint on last FC
Building SourceClassifiers
source domains label size :  [2, 4, 4]
use max norm constraint on last FC
use max norm constraint on last FC
use max norm constraint on last FC
there is n_step_F :  5
save checkpoint keys :  dict_keys(['epoch', 'global_step', 'pytorch-lightning_version', 'state_dict', 'callbacks', 'optimizer_states', 'lr_schedulers'])
combine predict folder :  /data1/wduong_experiment_data/EEG_Dassl_Lightning//NeurIPS_competition/task_2_final_2/LA_EA/tune/2//no_aug/no_norm/deepsleep_mcdV1/dataset_B_1/model/predict_folder/increment_fold_1/test_fold_1/valid_fold_5
