use determinstic 
cfg file setup :  DATAMANAGER:
  DATALOADER:
    LIST_TRAIN_U:
      BATCH_SIZES: [64, 64, 64]
      SAMPLERS: ['RandomSampler', 'RandomSampler', 'RandomSampler']
    NUM_WORKERS: 0
    TEST:
      BATCH_SIZE: 64
      SAMPLER: SequentialSampler
    TRAIN_U:
      BATCH_SIZE: 16
      N_DOMAIN: 0
      SAME_AS_X: True
      SAMPLER: RandomSampler
    TRAIN_X:
      BATCH_SIZE: 16
      N_DOMAIN: 0
      SAMPLER: RandomSampler
    VALID:
      BATCH_SIZE: 64
      N_DOMAIN: 0
      SAMPLER: SequentialSampler
  DATASET:
    AUGMENTATION:
      NAME: 
      PARAMS:
        DATASET_NAME: BCI_IV
        MAX_FIX_TRIAL: -1
        MAX_TRIAL_MUL: 3
        N_SEGMENT: 4
    DIR: final_MI_A_1
    EA: False
    FILENAME: dataset_A_1/NeurIPS_TL.mat
    FILTERBANK:
      USE_FILTERBANK: False
      freq_interval: 4
    NAME: MultiDataset
    ROOT: /data1/wduong_experiment_data/EEG_Dassl_Lightning/da_dataset/NeurIPS_competition
    SETUP:
      INCREMENT_FOLD:
        CURRENT_INCREMENT_FOLD: 1
        END_INCREMENT_FOLD: 1
        INCREMENT_FOLD_PREFIX: increment_fold
        INCREMENT_TRAIN_SUGJECT: 0
        N_INCREMENT_FOLDS: 1
        START_INCREMENT_FOLD: 1
        START_NUM_TRAIN_SUGJECT: 1
      SHUFFLE_TRAIN_VALID_FOLD:
        CURRENT_SHUFFLE_FOLD: 1
        END_SHUFFLE_FOLD: 1
        N_SHUFFLE_FOLDS: 1
        SET_FIX_SEED: False
        SHUFFLE_FOLD_PREFIX: shuffle_fold
        SHUFFLE_SEED: []
        START_SHUFFLE_FOLD: 1
      SOURCE_DATASET_NAMES: []
      TARGET_DATASET_NAME: dataset_A_1
      TARGET_DATASET_NAMES: []
      TEST_FOLD:
        CURRENT_TEST_FOLD: 1
        END_TEST_FOLD: 1
        NUM_TEST_SUBJECTS: -1
        N_TEST_FOLDS: 1
        SAME_AS_VALID: True
        START_TEST_FOLD: 1
        TEST_FOLD_PREFIX: test_fold
        TEST_SUBJECT_INDEX: []
        TRAIN_VALID_DATA_RATIO: -1
        WITHIN_SUBJECTS: True
      VALID_FOLD:
        CROSS_SUBJECTS: False
        CURRENT_VALID_FOLD: 1
        DOMAIN_CLASS_WEIGHT: True
        END_VALID_FOLD: 5
        N_VALID_FOLDS: 5
        SOURCE_DOMAIN_CLASS_WEIGHT: True
        START_VALID_FOLD: 1
        TOTAL_CLASS_WEIGHT: True
        TRAIN_DATA_RATIO: -1
        VALID_FOLD_PREFIX: valid_fold
        WITHIN_SUBJECTS: True
    TEST_DATA_FILE: dataset_A_1/NeurIPS_TL.mat
    TEST_DIR: final_MI_test_A_1
    TEST_SET_FILENAME: 
    USE_Euclidean_Aligment: True
    extra_files: ['dataset_A_1/LA/dataset_1.mat', 'dataset_A_1/LA/dataset_2.mat', 'dataset_A_1/LA/dataset_3.mat']
    r_op_file: dataset_A_1/dataset_A_1_r_op.mat
    source_dataset_LA: False
    target_dataset_relabelled: False
  MANAGER_TYPE: multi_datasetV2
  RESULT_FOLDER: result_folder
DISPLAY_INFO:
  DATASET: True
  DataManager: True
  TRAINER: True
  writer: False
EXTRA_FIELDS:
  EA: True
  LA: True
  aug: no_aug
  backbone: deepsleep
  model: MultiDatasetMCDV1
  normalize: no_norm
  source_dataset: ['cho2017', 'physionet', 'BCI_IV']
  source_label_space: [2, 4, 4]
  target_dataset: dataset_A_1
  target_label_space: 4
INPUT:
  NO_TRANSFORM: True
  SIZE: (17, 384)
  TRANSFORMS: []
LIGHTNING_MODEL:
  ACTIVE_LEARNING:
    USE_MODEL_UPDATE_DIR: 
    ensemble_confidence_level: -1
  COMPONENTS:
    BACKBONE:
      FREEZE: False
      NAME: deepsleep
      PARAMS:
        F1: 8
        F2: 8
        avg_pool_1: 4
        avg_pool_2: 8
        drop_prob: 0.25
        kern_length_1: 64
        kern_length_2: 16
        num_ch: 17
        samples: 384
      PRETRAINED: False
      PRETRAINED_PATH: 
    LAST_FC:
      NAME: max_norm
      max_norm: 0.5
    LAYER:
      NAME: EEGNetConv3
      PARAMS:
        F2: 16
        avg_pool_1: 4
        avg_pool_2: 8
        drop_prob: 0.25
        samples: 256
        sep_kern_length: 16
  PRETRAIN:
    DIR: 
    USE_BEST: False
  TRAINER:
    CDAN:
      lmda: 1.0
      use_entropy: False
      use_projection: False
    DAN:
      GaussianKernel:
        alpha: [0.5, 1.0, 2.0]
        sigma: []
        track_running_stats: True
      linear: False
      lmda: 1.0
      trade_off: 1.0
    DANN:
      lmda: 1.0
    EXTRA:
      PRETRAIN_SOURCE_LOSS_RATIO: 1.0
      PRETRAIN_TARGET_LOSS_RATIO: 0.2
      SOURCE_LOSS_RATIO: 0.2
      SOURCE_PRE_TRAIN_EPOCHS: 8
      TARGET_LOSS_RATIO: 1.0
    EpiDG:
      loss_weight_epic: 0.8
      loss_weight_epif: 0.8
      loss_weight_epir: 0.8
      start_train_classifier: 35
      start_train_feature: 35
      warm_up_DS: 25
      warn_up_AGG: 35
    MLDG:
      alpha: 0.1
      inner_lr: 0.1
      num_inner_loop: 1
      num_test_subject: 1
      percent_test_subject: 0.0
    NAME: MultiDatasetMCDV1
    PARAMS:
      n_step_F: 5
      pretrain: False
      pretrain_epochs: 0
LIGHTNING_TRAINER:
  CHECKPOINT:
    every_n_val_epochs: 1
    filename: best
    monitor: val_loss
    save_last: True
    save_top_k: 1
  LOGGER:
    
  early_stop:
    params:
      
    use_early_stop: False
  multiple_trainloader_mode: max_size_cycle
  num_sanity_val_steps: 0
  profiler: simple
  progress_bar_refresh_rate: 100
  stochastic_weight_avg: False
OPTIM:
  BASE_LR_MULT: 0.1
  COSINDECAY:
    LAST_EPOCH: -1
    MAX_LR: 0.01
    WARM_DROP: 1.0
    WARM_UP: 10
  GAMMA: 0.1
  LR_SCHEDULER: single_step
  MAX_EPOCH: 20
  NEW_LAYERS: ()
  OPTIMIZER:
    NAME: adam
    PARAMS:
      lr: 0.001
      weight_decay: 0.0
  SCHEDULER:
    NAME: exponential
    PARAMS:
      gamma: 1.0
  STAGED_LR: False
  STEPSIZE: (10,)
OUTPUT_DIR: /data1/wduong_experiment_data/EEG_Dassl_Lightning//NeurIPS_competition/task_2_final_2/LA_EA/tune/1//no_aug/no_norm/deepsleep_mcdV1/dataset_A_1/model
RESUME: 
TEST:
  COMPUTE_CMAT: False
  EVALUATOR: Classification
  EVAL_FREQ: 1
  NO_TEST: False
  PER_CLASS_RESULT: True
  SPLIT: test
TRAIN:
  CHECKPOINT_FREQ: 0
  COUNT_ITER: bigger_one
  PRINT_FREQ: 10
  SAVE_HISTORY_RECORD: True
  SAVE_LAST_EPOCH: True
USE_CUDA: True
VERBOSE: True
VERSION: 1
history_dir: 
output_dir: 
use data manager for domain adaptation
Loading dataset: MultiDataset
data root :  /data1/wduong_experiment_data/EEG_Dassl_Lightning/da_dataset/NeurIPS_competition
dataset dir :  final_MI_A_1
file name :  dataset_A_1/NeurIPS_TL.mat
r_op file path :  /data1/wduong_experiment_data/EEG_Dassl_Lightning/da_dataset/NeurIPS_competition/final_MI_A_1/dataset_A_1/dataset_A_1_r_op.mat

there is test file 
run custom EA
only use r-op for subjects [0]
only use r-op for subjects [0]
only use r-op for subjects [0]
use exist r_op
use exist r_op
use exist r_op
train subjects :  [0]
Train subject 0 has shape : (80, 1, 17, 384), with range scale (0.3514663279056549,-0.36929842829704285) 
test subjects :  [0]
test subject 0 has shape : (20, 1, 17, 384), with range scale (0.27785199880599976,-0.32363811135292053)  
valid subjects :  [0]
valid subject 0 has shape : (20, 1, 17, 384), with range scale (0.27785199880599976,-0.32363811135292053)  
the labels ratio of whole dataset : [3.6363636363636362, 3.6363636363636362, 4.0, 5.0]
source dataset idx :  0
run custom EA
generate new r_op
source_data subject_idx 0 has shape : (200, 17, 384), with range scale (2.8949124813079834,-3.0439417362213135) 
source_data subject_idx 1 has shape : (200, 17, 384), with range scale (2.514171838760376,-1.8399908542633057) 
source_data subject_idx 2 has shape : (200, 17, 384), with range scale (0.4031869173049927,-0.47407403588294983) 
source_data subject_idx 3 has shape : (200, 17, 384), with range scale (0.6525675058364868,-0.940330982208252) 
source_data subject_idx 4 has shape : (200, 17, 384), with range scale (1.3534847497940063,-1.3447120189666748) 
source_data subject_idx 5 has shape : (200, 17, 384), with range scale (0.6063358187675476,-0.529009997844696) 
source_data subject_idx 6 has shape : (240, 17, 384), with range scale (1.6099324226379395,-1.8825329542160034) 
source_data subject_idx 7 has shape : (200, 17, 384), with range scale (0.5209750533103943,-0.6464478373527527) 
source_data subject_idx 8 has shape : (240, 17, 384), with range scale (0.8885074257850647,-0.6163159012794495) 
source_data subject_idx 9 has shape : (200, 17, 384), with range scale (0.6655832529067993,-0.6934170126914978) 
source_data subject_idx 10 has shape : (200, 17, 384), with range scale (1.9625093936920166,-2.119454860687256) 
source_data subject_idx 11 has shape : (200, 17, 384), with range scale (0.6637643575668335,-0.5274373292922974) 
source_data subject_idx 12 has shape : (200, 17, 384), with range scale (0.3471425175666809,-0.4625225365161896) 
source_data subject_idx 13 has shape : (200, 17, 384), with range scale (0.4911949634552002,-0.5363013744354248) 
source_data subject_idx 14 has shape : (200, 17, 384), with range scale (0.7762149572372437,-0.6893907189369202) 
source_data subject_idx 15 has shape : (200, 17, 384), with range scale (0.9339151382446289,-1.013419508934021) 
source_data subject_idx 16 has shape : (200, 17, 384), with range scale (0.7132470607757568,-0.7285250425338745) 
source_data subject_idx 17 has shape : (200, 17, 384), with range scale (1.3041503429412842,-1.302201271057129) 
source_data subject_idx 18 has shape : (200, 17, 384), with range scale (1.9319943189620972,-1.5425034761428833) 
source_data subject_idx 19 has shape : (200, 17, 384), with range scale (0.5737782716751099,-0.5609017610549927) 
source_data subject_idx 20 has shape : (200, 17, 384), with range scale (1.0189663171768188,-0.7435137629508972) 
source_data subject_idx 21 has shape : (200, 17, 384), with range scale (1.8597694635391235,-1.2779128551483154) 
source_data subject_idx 22 has shape : (200, 17, 384), with range scale (1.361822485923767,-1.1432263851165771) 
source_data subject_idx 23 has shape : (200, 17, 384), with range scale (0.816189169883728,-0.9853714108467102) 
source_data subject_idx 24 has shape : (200, 17, 384), with range scale (1.1504335403442383,-1.1430150270462036) 
source_data subject_idx 25 has shape : (200, 17, 384), with range scale (2.702618360519409,-2.9552226066589355) 
source_data subject_idx 26 has shape : (200, 17, 384), with range scale (1.6591249704360962,-1.339446783065796) 
source_data subject_idx 27 has shape : (200, 17, 384), with range scale (1.3382678031921387,-1.0206931829452515) 
source_data subject_idx 28 has shape : (200, 17, 384), with range scale (1.9607363939285278,-1.5337920188903809) 
source_data subject_idx 29 has shape : (200, 17, 384), with range scale (0.5270815491676331,-0.6194854378700256) 
source_data subject_idx 30 has shape : (200, 17, 384), with range scale (0.49716678261756897,-0.4811560809612274) 
source_data subject_idx 31 has shape : (200, 17, 384), with range scale (0.5298357605934143,-0.7361605167388916) 
source_data subject_idx 32 has shape : (200, 17, 384), with range scale (0.6544474959373474,-0.7373430728912354) 
source_data subject_idx 33 has shape : (200, 17, 384), with range scale (2.2704901695251465,-2.6788127422332764) 
source_data subject_idx 34 has shape : (200, 17, 384), with range scale (2.0606043338775635,-2.6862478256225586) 
source_data subject_idx 35 has shape : (200, 17, 384), with range scale (2.564141273498535,-2.50285005569458) 
source_data subject_idx 36 has shape : (200, 17, 384), with range scale (0.9874972105026245,-0.6999896764755249) 
source_data subject_idx 37 has shape : (200, 17, 384), with range scale (0.5172118544578552,-0.5190767645835876) 
source_data subject_idx 38 has shape : (200, 17, 384), with range scale (1.128941535949707,-1.2659436464309692) 
source_data subject_idx 39 has shape : (200, 17, 384), with range scale (0.6239213943481445,-0.676697313785553) 
source_data subject_idx 40 has shape : (200, 17, 384), with range scale (1.2671682834625244,-1.0153831243515015) 
source_data subject_idx 41 has shape : (200, 17, 384), with range scale (0.5134593844413757,-0.5995444655418396) 
source_data subject_idx 42 has shape : (200, 17, 384), with range scale (1.3841683864593506,-1.0470761060714722) 
source_data subject_idx 43 has shape : (200, 17, 384), with range scale (1.0282957553863525,-0.8850383758544922) 
source_data subject_idx 44 has shape : (200, 17, 384), with range scale (0.8763719201087952,-0.873806357383728) 
source_data subject_idx 45 has shape : (200, 17, 384), with range scale (0.9527843594551086,-0.8911209106445312) 
source_data subject_idx 46 has shape : (200, 17, 384), with range scale (1.6098185777664185,-1.765346884727478) 
source_data subject_idx 47 has shape : (200, 17, 384), with range scale (1.397952675819397,-1.5371551513671875) 
source_data subject_idx 48 has shape : (200, 17, 384), with range scale (1.0645549297332764,-0.7614633440971375) 
source dataset idx :  1
run custom EA
generate new r_op
source_data subject_idx 0 has shape : (92, 17, 384), with range scale (0.6635822653770447,-0.6450462341308594) 
source_data subject_idx 1 has shape : (89, 17, 384), with range scale (0.6527177095413208,-0.8556455373764038) 
source_data subject_idx 2 has shape : (92, 17, 384), with range scale (0.9350364804267883,-0.9835978746414185) 
source_data subject_idx 3 has shape : (91, 17, 384), with range scale (0.6761916279792786,-0.892231285572052) 
source_data subject_idx 4 has shape : (88, 17, 384), with range scale (0.8706837296485901,-1.0782322883605957) 
source_data subject_idx 5 has shape : (92, 17, 384), with range scale (0.9342394471168518,-0.834481418132782) 
source_data subject_idx 6 has shape : (91, 17, 384), with range scale (0.4325883090496063,-0.5748054385185242) 
source_data subject_idx 7 has shape : (89, 17, 384), with range scale (1.3702843189239502,-1.167189598083496) 
source_data subject_idx 8 has shape : (91, 17, 384), with range scale (0.5027489066123962,-0.45364537835121155) 
source_data subject_idx 9 has shape : (91, 17, 384), with range scale (0.3971041440963745,-0.511340320110321) 
source_data subject_idx 10 has shape : (91, 17, 384), with range scale (1.2434769868850708,-1.2928123474121094) 
source_data subject_idx 11 has shape : (89, 17, 384), with range scale (1.0204869508743286,-1.1365001201629639) 
source_data subject_idx 12 has shape : (91, 17, 384), with range scale (0.6192032098770142,-0.6019769310951233) 
source_data subject_idx 13 has shape : (88, 17, 384), with range scale (0.3086931109428406,-0.40464091300964355) 
source_data subject_idx 14 has shape : (91, 17, 384), with range scale (0.44820329546928406,-0.49501609802246094) 
source_data subject_idx 15 has shape : (88, 17, 384), with range scale (0.46991586685180664,-0.5845204591751099) 
source_data subject_idx 16 has shape : (89, 17, 384), with range scale (0.8641892075538635,-1.2129716873168945) 
source_data subject_idx 17 has shape : (90, 17, 384), with range scale (0.4410848617553711,-0.3699715733528137) 
source_data subject_idx 18 has shape : (91, 17, 384), with range scale (0.47157102823257446,-0.4453599154949188) 
source_data subject_idx 19 has shape : (90, 17, 384), with range scale (0.534877359867096,-0.5651514530181885) 
source_data subject_idx 20 has shape : (90, 17, 384), with range scale (0.39198678731918335,-0.489992618560791) 
source_data subject_idx 21 has shape : (91, 17, 384), with range scale (0.61040198802948,-0.8814409375190735) 
source_data subject_idx 22 has shape : (89, 17, 384), with range scale (0.7364908456802368,-0.901198148727417) 
source_data subject_idx 23 has shape : (90, 17, 384), with range scale (0.6853683590888977,-0.7968631386756897) 
source_data subject_idx 24 has shape : (88, 17, 384), with range scale (0.93064284324646,-1.1263375282287598) 
source_data subject_idx 25 has shape : (93, 17, 384), with range scale (0.9077349901199341,-0.8342688083648682) 
source_data subject_idx 26 has shape : (91, 17, 384), with range scale (1.2297872304916382,-1.2567424774169922) 
source_data subject_idx 27 has shape : (89, 17, 384), with range scale (0.6552313566207886,-0.8012681603431702) 
source_data subject_idx 28 has shape : (91, 17, 384), with range scale (0.8271992206573486,-0.784073531627655) 
source_data subject_idx 29 has shape : (90, 17, 384), with range scale (2.0755653381347656,-1.7833671569824219) 
source_data subject_idx 30 has shape : (89, 17, 384), with range scale (0.4152286648750305,-0.6024753451347351) 
source_data subject_idx 31 has shape : (89, 17, 384), with range scale (1.1088554859161377,-1.1350764036178589) 
source_data subject_idx 32 has shape : (91, 17, 384), with range scale (0.4496297240257263,-0.4981136918067932) 
source_data subject_idx 33 has shape : (89, 17, 384), with range scale (0.8972886204719543,-0.8705561757087708) 
source_data subject_idx 34 has shape : (88, 17, 384), with range scale (0.9323359131813049,-0.8804383277893066) 
source_data subject_idx 35 has shape : (91, 17, 384), with range scale (0.9958591461181641,-1.0287989377975464) 
source_data subject_idx 36 has shape : (91, 17, 384), with range scale (0.6097190380096436,-0.6170302629470825) 
source_data subject_idx 37 has shape : (90, 17, 384), with range scale (0.4325774013996124,-0.37416771054267883) 
source_data subject_idx 38 has shape : (90, 17, 384), with range scale (0.4709510803222656,-0.3654654920101166) 
source_data subject_idx 39 has shape : (89, 17, 384), with range scale (0.8825229406356812,-1.476203441619873) 
source_data subject_idx 40 has shape : (91, 17, 384), with range scale (0.5058969855308533,-0.49067941308021545) 
source_data subject_idx 41 has shape : (88, 17, 384), with range scale (0.9766131639480591,-0.6556596755981445) 
source_data subject_idx 42 has shape : (90, 17, 384), with range scale (0.9502836465835571,-1.0015034675598145) 
source_data subject_idx 43 has shape : (89, 17, 384), with range scale (0.4527646601200104,-0.4087400734424591) 
source_data subject_idx 44 has shape : (89, 17, 384), with range scale (0.8421286344528198,-1.0863838195800781) 
source_data subject_idx 45 has shape : (91, 17, 384), with range scale (0.7677578330039978,-0.7578632235527039) 
source_data subject_idx 46 has shape : (91, 17, 384), with range scale (0.5478517413139343,-0.6169934868812561) 
source_data subject_idx 47 has shape : (88, 17, 384), with range scale (0.5600345730781555,-0.6607357859611511) 
source_data subject_idx 48 has shape : (92, 17, 384), with range scale (0.6931192874908447,-0.6391355395317078) 
source_data subject_idx 49 has shape : (89, 17, 384), with range scale (0.7659339904785156,-1.0686750411987305) 
source_data subject_idx 50 has shape : (93, 17, 384), with range scale (1.1803903579711914,-1.3481924533843994) 
source_data subject_idx 51 has shape : (92, 17, 384), with range scale (0.5909032821655273,-0.6613151431083679) 
source_data subject_idx 52 has shape : (89, 17, 384), with range scale (0.9489699006080627,-0.8693708181381226) 
source_data subject_idx 53 has shape : (90, 17, 384), with range scale (0.7868562936782837,-0.8488566279411316) 
source_data subject_idx 54 has shape : (90, 17, 384), with range scale (0.4624077379703522,-0.3843694031238556) 
source_data subject_idx 55 has shape : (89, 17, 384), with range scale (0.855067253112793,-0.7476500868797302) 
source_data subject_idx 56 has shape : (92, 17, 384), with range scale (1.451259970664978,-0.8775184750556946) 
source_data subject_idx 57 has shape : (91, 17, 384), with range scale (0.7655401229858398,-0.913463294506073) 
source_data subject_idx 58 has shape : (92, 17, 384), with range scale (1.8924585580825806,-0.7973564267158508) 
source_data subject_idx 59 has shape : (92, 17, 384), with range scale (0.503272294998169,-0.5399895310401917) 
source_data subject_idx 60 has shape : (88, 17, 384), with range scale (0.8019402623176575,-0.75787752866745) 
source_data subject_idx 61 has shape : (90, 17, 384), with range scale (0.4405616819858551,-0.5884069800376892) 
source_data subject_idx 62 has shape : (90, 17, 384), with range scale (2.480820655822754,-1.1794875860214233) 
source_data subject_idx 63 has shape : (91, 17, 384), with range scale (0.5555720329284668,-0.609916627407074) 
source_data subject_idx 64 has shape : (92, 17, 384), with range scale (0.7050769329071045,-0.7183904051780701) 
source_data subject_idx 65 has shape : (90, 17, 384), with range scale (1.1813173294067383,-1.4158159494400024) 
source_data subject_idx 66 has shape : (89, 17, 384), with range scale (1.169793963432312,-1.162235975265503) 
source_data subject_idx 67 has shape : (90, 17, 384), with range scale (0.6568388938903809,-0.5140275955200195) 
source_data subject_idx 68 has shape : (92, 17, 384), with range scale (0.4186505973339081,-0.5416693091392517) 
source_data subject_idx 69 has shape : (89, 17, 384), with range scale (0.9091640710830688,-0.8549709916114807) 
source_data subject_idx 70 has shape : (89, 17, 384), with range scale (1.1580862998962402,-1.0784372091293335) 
source_data subject_idx 71 has shape : (90, 17, 384), with range scale (0.8840420246124268,-0.9830904006958008) 
source_data subject_idx 72 has shape : (90, 17, 384), with range scale (0.5972389578819275,-0.4964401125907898) 
source_data subject_idx 73 has shape : (91, 17, 384), with range scale (0.7535731196403503,-0.7292771339416504) 
source_data subject_idx 74 has shape : (91, 17, 384), with range scale (0.73072350025177,-0.7904592752456665) 
source_data subject_idx 75 has shape : (90, 17, 384), with range scale (0.3187751770019531,-0.355183482170105) 
source_data subject_idx 76 has shape : (89, 17, 384), with range scale (0.7476410865783691,-0.653012216091156) 
source_data subject_idx 77 has shape : (91, 17, 384), with range scale (1.4965280294418335,-1.3019781112670898) 
source_data subject_idx 78 has shape : (91, 17, 384), with range scale (0.6563048958778381,-0.5579637289047241) 
source_data subject_idx 79 has shape : (89, 17, 384), with range scale (1.6257643699645996,-1.1466976404190063) 
source_data subject_idx 80 has shape : (90, 17, 384), with range scale (1.017038106918335,-1.1585050821304321) 
source_data subject_idx 81 has shape : (89, 17, 384), with range scale (0.5660838484764099,-0.8437317609786987) 
source_data subject_idx 82 has shape : (90, 17, 384), with range scale (0.900054395198822,-0.9659441709518433) 
source_data subject_idx 83 has shape : (91, 17, 384), with range scale (0.9371195435523987,-1.356507658958435) 
source_data subject_idx 84 has shape : (90, 17, 384), with range scale (0.6579915881156921,-0.4786575436592102) 
source_data subject_idx 85 has shape : (91, 17, 384), with range scale (1.1371746063232422,-1.2223700284957886) 
source_data subject_idx 86 has shape : (89, 17, 384), with range scale (0.7439618110656738,-0.624003529548645) 
source_data subject_idx 87 has shape : (114, 17, 384), with range scale (0.42124319076538086,-0.4062422811985016) 
source_data subject_idx 88 has shape : (90, 17, 384), with range scale (0.8885942101478577,-0.9470054507255554) 
source_data subject_idx 89 has shape : (90, 17, 384), with range scale (0.7889284491539001,-0.8844084739685059) 
source_data subject_idx 90 has shape : (90, 17, 384), with range scale (0.7539210319519043,-0.6837416887283325) 
source_data subject_idx 91 has shape : (111, 17, 384), with range scale (0.4892567992210388,-0.5099184513092041) 
source_data subject_idx 92 has shape : (90, 17, 384), with range scale (0.4826072156429291,-0.36527764797210693) 
source_data subject_idx 93 has shape : (90, 17, 384), with range scale (0.9776809215545654,-0.6807703971862793) 
source_data subject_idx 94 has shape : (91, 17, 384), with range scale (0.946986973285675,-1.0356836318969727) 
source_data subject_idx 95 has shape : (92, 17, 384), with range scale (0.8312045335769653,-0.8184489607810974) 
source_data subject_idx 96 has shape : (90, 17, 384), with range scale (0.6298197507858276,-1.0925219058990479) 
source_data subject_idx 97 has shape : (92, 17, 384), with range scale (0.4181371331214905,-0.508488655090332) 
source_data subject_idx 98 has shape : (91, 17, 384), with range scale (1.233091115951538,-1.2026557922363281) 
source_data subject_idx 99 has shape : (72, 17, 384), with range scale (0.770717978477478,-0.6864450573921204) 
source_data subject_idx 100 has shape : (88, 17, 384), with range scale (0.3383553624153137,-0.3229562044143677) 
source_data subject_idx 101 has shape : (89, 17, 384), with range scale (1.214106559753418,-1.1739592552185059) 
source_data subject_idx 102 has shape : (90, 17, 384), with range scale (0.7657291889190674,-0.8259928226470947) 
source_data subject_idx 103 has shape : (88, 17, 384), with range scale (0.45258983969688416,-0.6623888611793518) 
source_data subject_idx 104 has shape : (89, 17, 384), with range scale (0.6345487833023071,-0.48687201738357544) 
source_data subject_idx 105 has shape : (91, 17, 384), with range scale (0.5918318033218384,-0.5974709987640381) 
source_data subject_idx 106 has shape : (92, 17, 384), with range scale (0.7309435606002808,-0.9357020258903503) 
source_data subject_idx 107 has shape : (90, 17, 384), with range scale (0.6797388195991516,-0.760359525680542) 
source_data subject_idx 108 has shape : (90, 17, 384), with range scale (1.105279803276062,-1.2459110021591187) 
source dataset idx :  2
run custom EA
generate new r_op
source_data subject_idx 0 has shape : (576, 17, 384), with range scale (0.7720328569412231,-1.0032285451889038) 
source_data subject_idx 1 has shape : (576, 17, 384), with range scale (0.7470634579658508,-0.7756261825561523) 
source_data subject_idx 2 has shape : (576, 17, 384), with range scale (1.122564435005188,-1.5645434856414795) 
source_data subject_idx 3 has shape : (576, 17, 384), with range scale (0.7821568250656128,-0.958053469657898) 
source_data subject_idx 4 has shape : (576, 17, 384), with range scale (1.39310622215271,-1.5814940929412842) 
source_data subject_idx 5 has shape : (576, 17, 384), with range scale (1.129255771636963,-1.0122603178024292) 
source_data subject_idx 6 has shape : (576, 17, 384), with range scale (0.4136982262134552,-0.45542657375335693) 
source_data subject_idx 7 has shape : (576, 17, 384), with range scale (1.1008994579315186,-1.0081154108047485) 
source_data subject_idx 8 has shape : (576, 17, 384), with range scale (0.6211870908737183,-0.6390889286994934) 
only use r-op for subjects [0]
use exist r_op
unlabel data subject_idx 0 has shape : (200, 17, 384), with range scale (1.599064826965332,-1.3868545293807983) 
Loading trainer: MultiDatasetMCDV1
Params :  FREEZE: False
NAME: deepsleep
PARAMS:
  F1: 8
  F2: 8
  avg_pool_1: 4
  avg_pool_2: 8
  drop_prob: 0.25
  kern_length_1: 64
  kern_length_2: 16
  num_ch: 17
  samples: 384
PRETRAINED: False
PRETRAINED_PATH: 
Building F
Building CommonFeature
Backbone: deepsleep
params set up :  {'kern_length_1': 64, 'kern_length_2': 16, 'num_ch': 17, 'samples': 384, 'F1': 8, 'F2': 8, 'drop_prob': 0.25, 'avg_pool_1': 4, 'avg_pool_2': 8}
pretrain :  False
pretrain path : 
Building Target Classifier
use max norm constraint on last FC
use max norm constraint on last FC
Building SourceClassifiers
source domains label size :  [2, 4, 4]
use max norm constraint on last FC
use max norm constraint on last FC
use max norm constraint on last FC
there is n_step_F :  5
save checkpoint keys :  dict_keys(['epoch', 'global_step', 'pytorch-lightning_version', 'state_dict', 'callbacks', 'optimizer_states', 'lr_schedulers'])
size of test loader :  1
Testing: 0it [00:00, ?it/s]in test epoch end
Testing: 100%|##########| 1/1 [00:00<00:00, 75.53it/s]
--------------------------------------------------------------------------------
DATALOADER:0 TEST RESULTS
{'class_0_acc': 0.3333333432674408,
 'class_1_acc': 0.6666666865348816,
 'class_2_acc': 0.4000000059604645,
 'class_3_acc': 0.2222222238779068,
 'test_F1': 0.3561508059501648,
 'test_acc': 0.3499999940395355,
 'test_classes_avg_acc': 0.4055555462837219,
 'test_loss': 3.5737314224243164}
--------------------------------------------------------------------------------
test result :  {'test_acc': 0.3499999940395355, 'test_loss': 3.5737314224243164, 'test_F1': 0.3561508059501648, 'test_classes_avg_acc': 0.4055555462837219, 'class_0_acc': 0.3333333432674408, 'class_1_acc': 0.6666666865348816, 'class_2_acc': 0.4000000059604645, 'class_3_acc': 0.2222222238779068}
use data manager for domain adaptation
Loading dataset: MultiDataset
data root :  /data1/wduong_experiment_data/EEG_Dassl_Lightning/da_dataset/NeurIPS_competition
dataset dir :  final_MI_A_1
file name :  dataset_A_1/NeurIPS_TL.mat
r_op file path :  /data1/wduong_experiment_data/EEG_Dassl_Lightning/da_dataset/NeurIPS_competition/final_MI_A_1/dataset_A_1/dataset_A_1_r_op.mat

there is test file 
run custom EA
only use r-op for subjects [0]
only use r-op for subjects [0]
only use r-op for subjects [0]
use exist r_op
use exist r_op
use exist r_op
train subjects :  [0]
Train subject 0 has shape : (80, 1, 17, 384), with range scale (0.3514663279056549,-0.32363811135292053) 
test subjects :  [0]
test subject 0 has shape : (20, 1, 17, 384), with range scale (0.3378385007381439,-0.36929842829704285)  
valid subjects :  [0]
valid subject 0 has shape : (20, 1, 17, 384), with range scale (0.3378385007381439,-0.36929842829704285)  
the labels ratio of whole dataset : [3.8095238095238093, 3.6363636363636362, 4.0, 4.705882352941177]
source dataset idx :  0
run custom EA
generate new r_op
source_data subject_idx 0 has shape : (200, 17, 384), with range scale (2.8949124813079834,-3.0439417362213135) 
source_data subject_idx 1 has shape : (200, 17, 384), with range scale (2.514171838760376,-1.8399908542633057) 
source_data subject_idx 2 has shape : (200, 17, 384), with range scale (0.4031869173049927,-0.47407403588294983) 
source_data subject_idx 3 has shape : (200, 17, 384), with range scale (0.6525675058364868,-0.940330982208252) 
source_data subject_idx 4 has shape : (200, 17, 384), with range scale (1.3534847497940063,-1.3447120189666748) 
source_data subject_idx 5 has shape : (200, 17, 384), with range scale (0.6063358187675476,-0.529009997844696) 
source_data subject_idx 6 has shape : (240, 17, 384), with range scale (1.6099324226379395,-1.8825329542160034) 
source_data subject_idx 7 has shape : (200, 17, 384), with range scale (0.5209750533103943,-0.6464478373527527) 
source_data subject_idx 8 has shape : (240, 17, 384), with range scale (0.8885074257850647,-0.6163159012794495) 
source_data subject_idx 9 has shape : (200, 17, 384), with range scale (0.6655832529067993,-0.6934170126914978) 
source_data subject_idx 10 has shape : (200, 17, 384), with range scale (1.9625093936920166,-2.119454860687256) 
source_data subject_idx 11 has shape : (200, 17, 384), with range scale (0.6637643575668335,-0.5274373292922974) 
source_data subject_idx 12 has shape : (200, 17, 384), with range scale (0.3471425175666809,-0.4625225365161896) 
source_data subject_idx 13 has shape : (200, 17, 384), with range scale (0.4911949634552002,-0.5363013744354248) 
source_data subject_idx 14 has shape : (200, 17, 384), with range scale (0.7762149572372437,-0.6893907189369202) 
source_data subject_idx 15 has shape : (200, 17, 384), with range scale (0.9339151382446289,-1.013419508934021) 
source_data subject_idx 16 has shape : (200, 17, 384), with range scale (0.7132470607757568,-0.7285250425338745) 
source_data subject_idx 17 has shape : (200, 17, 384), with range scale (1.3041503429412842,-1.302201271057129) 
source_data subject_idx 18 has shape : (200, 17, 384), with range scale (1.9319943189620972,-1.5425034761428833) 
source_data subject_idx 19 has shape : (200, 17, 384), with range scale (0.5737782716751099,-0.5609017610549927) 
source_data subject_idx 20 has shape : (200, 17, 384), with range scale (1.0189663171768188,-0.7435137629508972) 
source_data subject_idx 21 has shape : (200, 17, 384), with range scale (1.8597694635391235,-1.2779128551483154) 
source_data subject_idx 22 has shape : (200, 17, 384), with range scale (1.361822485923767,-1.1432263851165771) 
source_data subject_idx 23 has shape : (200, 17, 384), with range scale (0.816189169883728,-0.9853714108467102) 
source_data subject_idx 24 has shape : (200, 17, 384), with range scale (1.1504335403442383,-1.1430150270462036) 
source_data subject_idx 25 has shape : (200, 17, 384), with range scale (2.702618360519409,-2.9552226066589355) 
source_data subject_idx 26 has shape : (200, 17, 384), with range scale (1.6591249704360962,-1.339446783065796) 
source_data subject_idx 27 has shape : (200, 17, 384), with range scale (1.3382678031921387,-1.0206931829452515) 
source_data subject_idx 28 has shape : (200, 17, 384), with range scale (1.9607363939285278,-1.5337920188903809) 
source_data subject_idx 29 has shape : (200, 17, 384), with range scale (0.5270815491676331,-0.6194854378700256) 
source_data subject_idx 30 has shape : (200, 17, 384), with range scale (0.49716678261756897,-0.4811560809612274) 
source_data subject_idx 31 has shape : (200, 17, 384), with range scale (0.5298357605934143,-0.7361605167388916) 
source_data subject_idx 32 has shape : (200, 17, 384), with range scale (0.6544474959373474,-0.7373430728912354) 
source_data subject_idx 33 has shape : (200, 17, 384), with range scale (2.2704901695251465,-2.6788127422332764) 
source_data subject_idx 34 has shape : (200, 17, 384), with range scale (2.0606043338775635,-2.6862478256225586) 
source_data subject_idx 35 has shape : (200, 17, 384), with range scale (2.564141273498535,-2.50285005569458) 
source_data subject_idx 36 has shape : (200, 17, 384), with range scale (0.9874972105026245,-0.6999896764755249) 
source_data subject_idx 37 has shape : (200, 17, 384), with range scale (0.5172118544578552,-0.5190767645835876) 
source_data subject_idx 38 has shape : (200, 17, 384), with range scale (1.128941535949707,-1.2659436464309692) 
source_data subject_idx 39 has shape : (200, 17, 384), with range scale (0.6239213943481445,-0.676697313785553) 
source_data subject_idx 40 has shape : (200, 17, 384), with range scale (1.2671682834625244,-1.0153831243515015) 
source_data subject_idx 41 has shape : (200, 17, 384), with range scale (0.5134593844413757,-0.5995444655418396) 
source_data subject_idx 42 has shape : (200, 17, 384), with range scale (1.3841683864593506,-1.0470761060714722) 
source_data subject_idx 43 has shape : (200, 17, 384), with range scale (1.0282957553863525,-0.8850383758544922) 
source_data subject_idx 44 has shape : (200, 17, 384), with range scale (0.8763719201087952,-0.873806357383728) 
source_data subject_idx 45 has shape : (200, 17, 384), with range scale (0.9527843594551086,-0.8911209106445312) 
source_data subject_idx 46 has shape : (200, 17, 384), with range scale (1.6098185777664185,-1.765346884727478) 
source_data subject_idx 47 has shape : (200, 17, 384), with range scale (1.397952675819397,-1.5371551513671875) 
source_data subject_idx 48 has shape : (200, 17, 384), with range scale (1.0645549297332764,-0.7614633440971375) 
source dataset idx :  1
run custom EA
generate new r_op
source_data subject_idx 0 has shape : (92, 17, 384), with range scale (0.6635822653770447,-0.6450462341308594) 
source_data subject_idx 1 has shape : (89, 17, 384), with range scale (0.6527177095413208,-0.8556455373764038) 
source_data subject_idx 2 has shape : (92, 17, 384), with range scale (0.9350364804267883,-0.9835978746414185) 
source_data subject_idx 3 has shape : (91, 17, 384), with range scale (0.6761916279792786,-0.892231285572052) 
source_data subject_idx 4 has shape : (88, 17, 384), with range scale (0.8706837296485901,-1.0782322883605957) 
source_data subject_idx 5 has shape : (92, 17, 384), with range scale (0.9342394471168518,-0.834481418132782) 
source_data subject_idx 6 has shape : (91, 17, 384), with range scale (0.4325883090496063,-0.5748054385185242) 
source_data subject_idx 7 has shape : (89, 17, 384), with range scale (1.3702843189239502,-1.167189598083496) 
source_data subject_idx 8 has shape : (91, 17, 384), with range scale (0.5027489066123962,-0.45364537835121155) 
source_data subject_idx 9 has shape : (91, 17, 384), with range scale (0.3971041440963745,-0.511340320110321) 
source_data subject_idx 10 has shape : (91, 17, 384), with range scale (1.2434769868850708,-1.2928123474121094) 
source_data subject_idx 11 has shape : (89, 17, 384), with range scale (1.0204869508743286,-1.1365001201629639) 
source_data subject_idx 12 has shape : (91, 17, 384), with range scale (0.6192032098770142,-0.6019769310951233) 
source_data subject_idx 13 has shape : (88, 17, 384), with range scale (0.3086931109428406,-0.40464091300964355) 
source_data subject_idx 14 has shape : (91, 17, 384), with range scale (0.44820329546928406,-0.49501609802246094) 
source_data subject_idx 15 has shape : (88, 17, 384), with range scale (0.46991586685180664,-0.5845204591751099) 
source_data subject_idx 16 has shape : (89, 17, 384), with range scale (0.8641892075538635,-1.2129716873168945) 
source_data subject_idx 17 has shape : (90, 17, 384), with range scale (0.4410848617553711,-0.3699715733528137) 
source_data subject_idx 18 has shape : (91, 17, 384), with range scale (0.47157102823257446,-0.4453599154949188) 
source_data subject_idx 19 has shape : (90, 17, 384), with range scale (0.534877359867096,-0.5651514530181885) 
source_data subject_idx 20 has shape : (90, 17, 384), with range scale (0.39198678731918335,-0.489992618560791) 
source_data subject_idx 21 has shape : (91, 17, 384), with range scale (0.61040198802948,-0.8814409375190735) 
source_data subject_idx 22 has shape : (89, 17, 384), with range scale (0.7364908456802368,-0.901198148727417) 
source_data subject_idx 23 has shape : (90, 17, 384), with range scale (0.6853683590888977,-0.7968631386756897) 
source_data subject_idx 24 has shape : (88, 17, 384), with range scale (0.93064284324646,-1.1263375282287598) 
source_data subject_idx 25 has shape : (93, 17, 384), with range scale (0.9077349901199341,-0.8342688083648682) 
source_data subject_idx 26 has shape : (91, 17, 384), with range scale (1.2297872304916382,-1.2567424774169922) 
source_data subject_idx 27 has shape : (89, 17, 384), with range scale (0.6552313566207886,-0.8012681603431702) 
source_data subject_idx 28 has shape : (91, 17, 384), with range scale (0.8271992206573486,-0.784073531627655) 
source_data subject_idx 29 has shape : (90, 17, 384), with range scale (2.0755653381347656,-1.7833671569824219) 
source_data subject_idx 30 has shape : (89, 17, 384), with range scale (0.4152286648750305,-0.6024753451347351) 
source_data subject_idx 31 has shape : (89, 17, 384), with range scale (1.1088554859161377,-1.1350764036178589) 
source_data subject_idx 32 has shape : (91, 17, 384), with range scale (0.4496297240257263,-0.4981136918067932) 
source_data subject_idx 33 has shape : (89, 17, 384), with range scale (0.8972886204719543,-0.8705561757087708) 
source_data subject_idx 34 has shape : (88, 17, 384), with range scale (0.9323359131813049,-0.8804383277893066) 
source_data subject_idx 35 has shape : (91, 17, 384), with range scale (0.9958591461181641,-1.0287989377975464) 
source_data subject_idx 36 has shape : (91, 17, 384), with range scale (0.6097190380096436,-0.6170302629470825) 
source_data subject_idx 37 has shape : (90, 17, 384), with range scale (0.4325774013996124,-0.37416771054267883) 
source_data subject_idx 38 has shape : (90, 17, 384), with range scale (0.4709510803222656,-0.3654654920101166) 
source_data subject_idx 39 has shape : (89, 17, 384), with range scale (0.8825229406356812,-1.476203441619873) 
source_data subject_idx 40 has shape : (91, 17, 384), with range scale (0.5058969855308533,-0.49067941308021545) 
source_data subject_idx 41 has shape : (88, 17, 384), with range scale (0.9766131639480591,-0.6556596755981445) 
source_data subject_idx 42 has shape : (90, 17, 384), with range scale (0.9502836465835571,-1.0015034675598145) 
source_data subject_idx 43 has shape : (89, 17, 384), with range scale (0.4527646601200104,-0.4087400734424591) 
source_data subject_idx 44 has shape : (89, 17, 384), with range scale (0.8421286344528198,-1.0863838195800781) 
source_data subject_idx 45 has shape : (91, 17, 384), with range scale (0.7677578330039978,-0.7578632235527039) 
source_data subject_idx 46 has shape : (91, 17, 384), with range scale (0.5478517413139343,-0.6169934868812561) 
source_data subject_idx 47 has shape : (88, 17, 384), with range scale (0.5600345730781555,-0.6607357859611511) 
source_data subject_idx 48 has shape : (92, 17, 384), with range scale (0.6931192874908447,-0.6391355395317078) 
source_data subject_idx 49 has shape : (89, 17, 384), with range scale (0.7659339904785156,-1.0686750411987305) 
source_data subject_idx 50 has shape : (93, 17, 384), with range scale (1.1803903579711914,-1.3481924533843994) 
source_data subject_idx 51 has shape : (92, 17, 384), with range scale (0.5909032821655273,-0.6613151431083679) 
source_data subject_idx 52 has shape : (89, 17, 384), with range scale (0.9489699006080627,-0.8693708181381226) 
source_data subject_idx 53 has shape : (90, 17, 384), with range scale (0.7868562936782837,-0.8488566279411316) 
source_data subject_idx 54 has shape : (90, 17, 384), with range scale (0.4624077379703522,-0.3843694031238556) 
source_data subject_idx 55 has shape : (89, 17, 384), with range scale (0.855067253112793,-0.7476500868797302) 
source_data subject_idx 56 has shape : (92, 17, 384), with range scale (1.451259970664978,-0.8775184750556946) 
source_data subject_idx 57 has shape : (91, 17, 384), with range scale (0.7655401229858398,-0.913463294506073) 
source_data subject_idx 58 has shape : (92, 17, 384), with range scale (1.8924585580825806,-0.7973564267158508) 
source_data subject_idx 59 has shape : (92, 17, 384), with range scale (0.503272294998169,-0.5399895310401917) 
source_data subject_idx 60 has shape : (88, 17, 384), with range scale (0.8019402623176575,-0.75787752866745) 
source_data subject_idx 61 has shape : (90, 17, 384), with range scale (0.4405616819858551,-0.5884069800376892) 
source_data subject_idx 62 has shape : (90, 17, 384), with range scale (2.480820655822754,-1.1794875860214233) 
source_data subject_idx 63 has shape : (91, 17, 384), with range scale (0.5555720329284668,-0.609916627407074) 
source_data subject_idx 64 has shape : (92, 17, 384), with range scale (0.7050769329071045,-0.7183904051780701) 
source_data subject_idx 65 has shape : (90, 17, 384), with range scale (1.1813173294067383,-1.4158159494400024) 
source_data subject_idx 66 has shape : (89, 17, 384), with range scale (1.169793963432312,-1.162235975265503) 
source_data subject_idx 67 has shape : (90, 17, 384), with range scale (0.6568388938903809,-0.5140275955200195) 
source_data subject_idx 68 has shape : (92, 17, 384), with range scale (0.4186505973339081,-0.5416693091392517) 
source_data subject_idx 69 has shape : (89, 17, 384), with range scale (0.9091640710830688,-0.8549709916114807) 
source_data subject_idx 70 has shape : (89, 17, 384), with range scale (1.1580862998962402,-1.0784372091293335) 
source_data subject_idx 71 has shape : (90, 17, 384), with range scale (0.8840420246124268,-0.9830904006958008) 
source_data subject_idx 72 has shape : (90, 17, 384), with range scale (0.5972389578819275,-0.4964401125907898) 
source_data subject_idx 73 has shape : (91, 17, 384), with range scale (0.7535731196403503,-0.7292771339416504) 
source_data subject_idx 74 has shape : (91, 17, 384), with range scale (0.73072350025177,-0.7904592752456665) 
source_data subject_idx 75 has shape : (90, 17, 384), with range scale (0.3187751770019531,-0.355183482170105) 
source_data subject_idx 76 has shape : (89, 17, 384), with range scale (0.7476410865783691,-0.653012216091156) 
source_data subject_idx 77 has shape : (91, 17, 384), with range scale (1.4965280294418335,-1.3019781112670898) 
source_data subject_idx 78 has shape : (91, 17, 384), with range scale (0.6563048958778381,-0.5579637289047241) 
source_data subject_idx 79 has shape : (89, 17, 384), with range scale (1.6257643699645996,-1.1466976404190063) 
source_data subject_idx 80 has shape : (90, 17, 384), with range scale (1.017038106918335,-1.1585050821304321) 
source_data subject_idx 81 has shape : (89, 17, 384), with range scale (0.5660838484764099,-0.8437317609786987) 
source_data subject_idx 82 has shape : (90, 17, 384), with range scale (0.900054395198822,-0.9659441709518433) 
source_data subject_idx 83 has shape : (91, 17, 384), with range scale (0.9371195435523987,-1.356507658958435) 
source_data subject_idx 84 has shape : (90, 17, 384), with range scale (0.6579915881156921,-0.4786575436592102) 
source_data subject_idx 85 has shape : (91, 17, 384), with range scale (1.1371746063232422,-1.2223700284957886) 
source_data subject_idx 86 has shape : (89, 17, 384), with range scale (0.7439618110656738,-0.624003529548645) 
source_data subject_idx 87 has shape : (114, 17, 384), with range scale (0.42124319076538086,-0.4062422811985016) 
source_data subject_idx 88 has shape : (90, 17, 384), with range scale (0.8885942101478577,-0.9470054507255554) 
source_data subject_idx 89 has shape : (90, 17, 384), with range scale (0.7889284491539001,-0.8844084739685059) 
source_data subject_idx 90 has shape : (90, 17, 384), with range scale (0.7539210319519043,-0.6837416887283325) 
source_data subject_idx 91 has shape : (111, 17, 384), with range scale (0.4892567992210388,-0.5099184513092041) 
source_data subject_idx 92 has shape : (90, 17, 384), with range scale (0.4826072156429291,-0.36527764797210693) 
source_data subject_idx 93 has shape : (90, 17, 384), with range scale (0.9776809215545654,-0.6807703971862793) 
source_data subject_idx 94 has shape : (91, 17, 384), with range scale (0.946986973285675,-1.0356836318969727) 
source_data subject_idx 95 has shape : (92, 17, 384), with range scale (0.8312045335769653,-0.8184489607810974) 
source_data subject_idx 96 has shape : (90, 17, 384), with range scale (0.6298197507858276,-1.0925219058990479) 
source_data subject_idx 97 has shape : (92, 17, 384), with range scale (0.4181371331214905,-0.508488655090332) 
source_data subject_idx 98 has shape : (91, 17, 384), with range scale (1.233091115951538,-1.2026557922363281) 
source_data subject_idx 99 has shape : (72, 17, 384), with range scale (0.770717978477478,-0.6864450573921204) 
source_data subject_idx 100 has shape : (88, 17, 384), with range scale (0.3383553624153137,-0.3229562044143677) 
source_data subject_idx 101 has shape : (89, 17, 384), with range scale (1.214106559753418,-1.1739592552185059) 
source_data subject_idx 102 has shape : (90, 17, 384), with range scale (0.7657291889190674,-0.8259928226470947) 
source_data subject_idx 103 has shape : (88, 17, 384), with range scale (0.45258983969688416,-0.6623888611793518) 
source_data subject_idx 104 has shape : (89, 17, 384), with range scale (0.6345487833023071,-0.48687201738357544) 
source_data subject_idx 105 has shape : (91, 17, 384), with range scale (0.5918318033218384,-0.5974709987640381) 
source_data subject_idx 106 has shape : (92, 17, 384), with range scale (0.7309435606002808,-0.9357020258903503) 
source_data subject_idx 107 has shape : (90, 17, 384), with range scale (0.6797388195991516,-0.760359525680542) 
source_data subject_idx 108 has shape : (90, 17, 384), with range scale (1.105279803276062,-1.2459110021591187) 
source dataset idx :  2
run custom EA
generate new r_op
source_data subject_idx 0 has shape : (576, 17, 384), with range scale (0.7720328569412231,-1.0032285451889038) 
source_data subject_idx 1 has shape : (576, 17, 384), with range scale (0.7470634579658508,-0.7756261825561523) 
source_data subject_idx 2 has shape : (576, 17, 384), with range scale (1.122564435005188,-1.5645434856414795) 
source_data subject_idx 3 has shape : (576, 17, 384), with range scale (0.7821568250656128,-0.958053469657898) 
source_data subject_idx 4 has shape : (576, 17, 384), with range scale (1.39310622215271,-1.5814940929412842) 
source_data subject_idx 5 has shape : (576, 17, 384), with range scale (1.129255771636963,-1.0122603178024292) 
source_data subject_idx 6 has shape : (576, 17, 384), with range scale (0.4136982262134552,-0.45542657375335693) 
source_data subject_idx 7 has shape : (576, 17, 384), with range scale (1.1008994579315186,-1.0081154108047485) 
source_data subject_idx 8 has shape : (576, 17, 384), with range scale (0.6211870908737183,-0.6390889286994934) 
only use r-op for subjects [0]
use exist r_op
unlabel data subject_idx 0 has shape : (200, 17, 384), with range scale (1.599064826965332,-1.3868545293807983) 
Loading trainer: MultiDatasetMCDV1
Params :  FREEZE: False
NAME: deepsleep
PARAMS:
  F1: 8
  F2: 8
  avg_pool_1: 4
  avg_pool_2: 8
  drop_prob: 0.25
  kern_length_1: 64
  kern_length_2: 16
  num_ch: 17
  samples: 384
PRETRAINED: False
PRETRAINED_PATH: 
Building F
Building CommonFeature
Backbone: deepsleep
params set up :  {'kern_length_1': 64, 'kern_length_2': 16, 'num_ch': 17, 'samples': 384, 'F1': 8, 'F2': 8, 'drop_prob': 0.25, 'avg_pool_1': 4, 'avg_pool_2': 8}
pretrain :  False
pretrain path : 
Building Target Classifier
use max norm constraint on last FC
use max norm constraint on last FC
Building SourceClassifiers
source domains label size :  [2, 4, 4]
use max norm constraint on last FC
use max norm constraint on last FC
use max norm constraint on last FC
there is n_step_F :  5
save checkpoint keys :  dict_keys(['epoch', 'global_step', 'pytorch-lightning_version', 'state_dict', 'callbacks', 'optimizer_states', 'lr_schedulers'])
size of test loader :  1
Testing: 0it [00:00, ?it/s]in test epoch end
Testing: 100%|##########| 1/1 [00:00<00:00, 119.28it/s]
--------------------------------------------------------------------------------
DATALOADER:0 TEST RESULTS
{'class_0_acc': 0.25,
 'class_1_acc': 1.0,
 'class_2_acc': 0.4000000059604645,
 'class_3_acc': 0.25,
 'test_F1': 0.4000000059604645,
 'test_acc': 0.4000000059604645,
 'test_classes_avg_acc': 0.4749999940395355,
 'test_loss': 5.058084964752197}
--------------------------------------------------------------------------------
test result :  {'test_acc': 0.4000000059604645, 'test_loss': 5.058084964752197, 'test_F1': 0.4000000059604645, 'test_classes_avg_acc': 0.4749999940395355, 'class_0_acc': 0.25, 'class_1_acc': 1.0, 'class_2_acc': 0.4000000059604645, 'class_3_acc': 0.25}
use data manager for domain adaptation
Loading dataset: MultiDataset
data root :  /data1/wduong_experiment_data/EEG_Dassl_Lightning/da_dataset/NeurIPS_competition
dataset dir :  final_MI_A_1
file name :  dataset_A_1/NeurIPS_TL.mat
r_op file path :  /data1/wduong_experiment_data/EEG_Dassl_Lightning/da_dataset/NeurIPS_competition/final_MI_A_1/dataset_A_1/dataset_A_1_r_op.mat

there is test file 
run custom EA
only use r-op for subjects [0]
only use r-op for subjects [0]
only use r-op for subjects [0]
use exist r_op
use exist r_op
use exist r_op
train subjects :  [0]
Train subject 0 has shape : (80, 1, 17, 384), with range scale (0.3514663279056549,-0.36929842829704285) 
test subjects :  [0]
test subject 0 has shape : (20, 1, 17, 384), with range scale (0.34500741958618164,-0.2542596459388733)  
valid subjects :  [0]
valid subject 0 has shape : (20, 1, 17, 384), with range scale (0.34500741958618164,-0.2542596459388733)  
the labels ratio of whole dataset : [4.444444444444445, 4.0, 3.8095238095238093, 3.8095238095238093]
source dataset idx :  0
run custom EA
generate new r_op
source_data subject_idx 0 has shape : (200, 17, 384), with range scale (2.8949124813079834,-3.0439417362213135) 
source_data subject_idx 1 has shape : (200, 17, 384), with range scale (2.514171838760376,-1.8399908542633057) 
source_data subject_idx 2 has shape : (200, 17, 384), with range scale (0.4031869173049927,-0.47407403588294983) 
source_data subject_idx 3 has shape : (200, 17, 384), with range scale (0.6525675058364868,-0.940330982208252) 
source_data subject_idx 4 has shape : (200, 17, 384), with range scale (1.3534847497940063,-1.3447120189666748) 
source_data subject_idx 5 has shape : (200, 17, 384), with range scale (0.6063358187675476,-0.529009997844696) 
source_data subject_idx 6 has shape : (240, 17, 384), with range scale (1.6099324226379395,-1.8825329542160034) 
source_data subject_idx 7 has shape : (200, 17, 384), with range scale (0.5209750533103943,-0.6464478373527527) 
source_data subject_idx 8 has shape : (240, 17, 384), with range scale (0.8885074257850647,-0.6163159012794495) 
source_data subject_idx 9 has shape : (200, 17, 384), with range scale (0.6655832529067993,-0.6934170126914978) 
source_data subject_idx 10 has shape : (200, 17, 384), with range scale (1.9625093936920166,-2.119454860687256) 
source_data subject_idx 11 has shape : (200, 17, 384), with range scale (0.6637643575668335,-0.5274373292922974) 
source_data subject_idx 12 has shape : (200, 17, 384), with range scale (0.3471425175666809,-0.4625225365161896) 
source_data subject_idx 13 has shape : (200, 17, 384), with range scale (0.4911949634552002,-0.5363013744354248) 
source_data subject_idx 14 has shape : (200, 17, 384), with range scale (0.7762149572372437,-0.6893907189369202) 
source_data subject_idx 15 has shape : (200, 17, 384), with range scale (0.9339151382446289,-1.013419508934021) 
source_data subject_idx 16 has shape : (200, 17, 384), with range scale (0.7132470607757568,-0.7285250425338745) 
source_data subject_idx 17 has shape : (200, 17, 384), with range scale (1.3041503429412842,-1.302201271057129) 
source_data subject_idx 18 has shape : (200, 17, 384), with range scale (1.9319943189620972,-1.5425034761428833) 
source_data subject_idx 19 has shape : (200, 17, 384), with range scale (0.5737782716751099,-0.5609017610549927) 
source_data subject_idx 20 has shape : (200, 17, 384), with range scale (1.0189663171768188,-0.7435137629508972) 
source_data subject_idx 21 has shape : (200, 17, 384), with range scale (1.8597694635391235,-1.2779128551483154) 
source_data subject_idx 22 has shape : (200, 17, 384), with range scale (1.361822485923767,-1.1432263851165771) 
source_data subject_idx 23 has shape : (200, 17, 384), with range scale (0.816189169883728,-0.9853714108467102) 
source_data subject_idx 24 has shape : (200, 17, 384), with range scale (1.1504335403442383,-1.1430150270462036) 
source_data subject_idx 25 has shape : (200, 17, 384), with range scale (2.702618360519409,-2.9552226066589355) 
source_data subject_idx 26 has shape : (200, 17, 384), with range scale (1.6591249704360962,-1.339446783065796) 
source_data subject_idx 27 has shape : (200, 17, 384), with range scale (1.3382678031921387,-1.0206931829452515) 
source_data subject_idx 28 has shape : (200, 17, 384), with range scale (1.9607363939285278,-1.5337920188903809) 
source_data subject_idx 29 has shape : (200, 17, 384), with range scale (0.5270815491676331,-0.6194854378700256) 
source_data subject_idx 30 has shape : (200, 17, 384), with range scale (0.49716678261756897,-0.4811560809612274) 
source_data subject_idx 31 has shape : (200, 17, 384), with range scale (0.5298357605934143,-0.7361605167388916) 
source_data subject_idx 32 has shape : (200, 17, 384), with range scale (0.6544474959373474,-0.7373430728912354) 
source_data subject_idx 33 has shape : (200, 17, 384), with range scale (2.2704901695251465,-2.6788127422332764) 
source_data subject_idx 34 has shape : (200, 17, 384), with range scale (2.0606043338775635,-2.6862478256225586) 
source_data subject_idx 35 has shape : (200, 17, 384), with range scale (2.564141273498535,-2.50285005569458) 
source_data subject_idx 36 has shape : (200, 17, 384), with range scale (0.9874972105026245,-0.6999896764755249) 
source_data subject_idx 37 has shape : (200, 17, 384), with range scale (0.5172118544578552,-0.5190767645835876) 
source_data subject_idx 38 has shape : (200, 17, 384), with range scale (1.128941535949707,-1.2659436464309692) 
source_data subject_idx 39 has shape : (200, 17, 384), with range scale (0.6239213943481445,-0.676697313785553) 
source_data subject_idx 40 has shape : (200, 17, 384), with range scale (1.2671682834625244,-1.0153831243515015) 
source_data subject_idx 41 has shape : (200, 17, 384), with range scale (0.5134593844413757,-0.5995444655418396) 
source_data subject_idx 42 has shape : (200, 17, 384), with range scale (1.3841683864593506,-1.0470761060714722) 
source_data subject_idx 43 has shape : (200, 17, 384), with range scale (1.0282957553863525,-0.8850383758544922) 
source_data subject_idx 44 has shape : (200, 17, 384), with range scale (0.8763719201087952,-0.873806357383728) 
source_data subject_idx 45 has shape : (200, 17, 384), with range scale (0.9527843594551086,-0.8911209106445312) 
source_data subject_idx 46 has shape : (200, 17, 384), with range scale (1.6098185777664185,-1.765346884727478) 
source_data subject_idx 47 has shape : (200, 17, 384), with range scale (1.397952675819397,-1.5371551513671875) 
source_data subject_idx 48 has shape : (200, 17, 384), with range scale (1.0645549297332764,-0.7614633440971375) 
source dataset idx :  1
run custom EA
generate new r_op
source_data subject_idx 0 has shape : (92, 17, 384), with range scale (0.6635822653770447,-0.6450462341308594) 
source_data subject_idx 1 has shape : (89, 17, 384), with range scale (0.6527177095413208,-0.8556455373764038) 
source_data subject_idx 2 has shape : (92, 17, 384), with range scale (0.9350364804267883,-0.9835978746414185) 
source_data subject_idx 3 has shape : (91, 17, 384), with range scale (0.6761916279792786,-0.892231285572052) 
source_data subject_idx 4 has shape : (88, 17, 384), with range scale (0.8706837296485901,-1.0782322883605957) 
source_data subject_idx 5 has shape : (92, 17, 384), with range scale (0.9342394471168518,-0.834481418132782) 
source_data subject_idx 6 has shape : (91, 17, 384), with range scale (0.4325883090496063,-0.5748054385185242) 
source_data subject_idx 7 has shape : (89, 17, 384), with range scale (1.3702843189239502,-1.167189598083496) 
source_data subject_idx 8 has shape : (91, 17, 384), with range scale (0.5027489066123962,-0.45364537835121155) 
source_data subject_idx 9 has shape : (91, 17, 384), with range scale (0.3971041440963745,-0.511340320110321) 
source_data subject_idx 10 has shape : (91, 17, 384), with range scale (1.2434769868850708,-1.2928123474121094) 
source_data subject_idx 11 has shape : (89, 17, 384), with range scale (1.0204869508743286,-1.1365001201629639) 
source_data subject_idx 12 has shape : (91, 17, 384), with range scale (0.6192032098770142,-0.6019769310951233) 
source_data subject_idx 13 has shape : (88, 17, 384), with range scale (0.3086931109428406,-0.40464091300964355) 
source_data subject_idx 14 has shape : (91, 17, 384), with range scale (0.44820329546928406,-0.49501609802246094) 
source_data subject_idx 15 has shape : (88, 17, 384), with range scale (0.46991586685180664,-0.5845204591751099) 
source_data subject_idx 16 has shape : (89, 17, 384), with range scale (0.8641892075538635,-1.2129716873168945) 
source_data subject_idx 17 has shape : (90, 17, 384), with range scale (0.4410848617553711,-0.3699715733528137) 
source_data subject_idx 18 has shape : (91, 17, 384), with range scale (0.47157102823257446,-0.4453599154949188) 
source_data subject_idx 19 has shape : (90, 17, 384), with range scale (0.534877359867096,-0.5651514530181885) 
source_data subject_idx 20 has shape : (90, 17, 384), with range scale (0.39198678731918335,-0.489992618560791) 
source_data subject_idx 21 has shape : (91, 17, 384), with range scale (0.61040198802948,-0.8814409375190735) 
source_data subject_idx 22 has shape : (89, 17, 384), with range scale (0.7364908456802368,-0.901198148727417) 
source_data subject_idx 23 has shape : (90, 17, 384), with range scale (0.6853683590888977,-0.7968631386756897) 
source_data subject_idx 24 has shape : (88, 17, 384), with range scale (0.93064284324646,-1.1263375282287598) 
source_data subject_idx 25 has shape : (93, 17, 384), with range scale (0.9077349901199341,-0.8342688083648682) 
source_data subject_idx 26 has shape : (91, 17, 384), with range scale (1.2297872304916382,-1.2567424774169922) 
source_data subject_idx 27 has shape : (89, 17, 384), with range scale (0.6552313566207886,-0.8012681603431702) 
source_data subject_idx 28 has shape : (91, 17, 384), with range scale (0.8271992206573486,-0.784073531627655) 
source_data subject_idx 29 has shape : (90, 17, 384), with range scale (2.0755653381347656,-1.7833671569824219) 
source_data subject_idx 30 has shape : (89, 17, 384), with range scale (0.4152286648750305,-0.6024753451347351) 
source_data subject_idx 31 has shape : (89, 17, 384), with range scale (1.1088554859161377,-1.1350764036178589) 
source_data subject_idx 32 has shape : (91, 17, 384), with range scale (0.4496297240257263,-0.4981136918067932) 
source_data subject_idx 33 has shape : (89, 17, 384), with range scale (0.8972886204719543,-0.8705561757087708) 
source_data subject_idx 34 has shape : (88, 17, 384), with range scale (0.9323359131813049,-0.8804383277893066) 
source_data subject_idx 35 has shape : (91, 17, 384), with range scale (0.9958591461181641,-1.0287989377975464) 
source_data subject_idx 36 has shape : (91, 17, 384), with range scale (0.6097190380096436,-0.6170302629470825) 
source_data subject_idx 37 has shape : (90, 17, 384), with range scale (0.4325774013996124,-0.37416771054267883) 
source_data subject_idx 38 has shape : (90, 17, 384), with range scale (0.4709510803222656,-0.3654654920101166) 
source_data subject_idx 39 has shape : (89, 17, 384), with range scale (0.8825229406356812,-1.476203441619873) 
source_data subject_idx 40 has shape : (91, 17, 384), with range scale (0.5058969855308533,-0.49067941308021545) 
source_data subject_idx 41 has shape : (88, 17, 384), with range scale (0.9766131639480591,-0.6556596755981445) 
source_data subject_idx 42 has shape : (90, 17, 384), with range scale (0.9502836465835571,-1.0015034675598145) 
source_data subject_idx 43 has shape : (89, 17, 384), with range scale (0.4527646601200104,-0.4087400734424591) 
source_data subject_idx 44 has shape : (89, 17, 384), with range scale (0.8421286344528198,-1.0863838195800781) 
source_data subject_idx 45 has shape : (91, 17, 384), with range scale (0.7677578330039978,-0.7578632235527039) 
source_data subject_idx 46 has shape : (91, 17, 384), with range scale (0.5478517413139343,-0.6169934868812561) 
source_data subject_idx 47 has shape : (88, 17, 384), with range scale (0.5600345730781555,-0.6607357859611511) 
source_data subject_idx 48 has shape : (92, 17, 384), with range scale (0.6931192874908447,-0.6391355395317078) 
source_data subject_idx 49 has shape : (89, 17, 384), with range scale (0.7659339904785156,-1.0686750411987305) 
source_data subject_idx 50 has shape : (93, 17, 384), with range scale (1.1803903579711914,-1.3481924533843994) 
source_data subject_idx 51 has shape : (92, 17, 384), with range scale (0.5909032821655273,-0.6613151431083679) 
source_data subject_idx 52 has shape : (89, 17, 384), with range scale (0.9489699006080627,-0.8693708181381226) 
source_data subject_idx 53 has shape : (90, 17, 384), with range scale (0.7868562936782837,-0.8488566279411316) 
source_data subject_idx 54 has shape : (90, 17, 384), with range scale (0.4624077379703522,-0.3843694031238556) 
source_data subject_idx 55 has shape : (89, 17, 384), with range scale (0.855067253112793,-0.7476500868797302) 
source_data subject_idx 56 has shape : (92, 17, 384), with range scale (1.451259970664978,-0.8775184750556946) 
source_data subject_idx 57 has shape : (91, 17, 384), with range scale (0.7655401229858398,-0.913463294506073) 
source_data subject_idx 58 has shape : (92, 17, 384), with range scale (1.8924585580825806,-0.7973564267158508) 
source_data subject_idx 59 has shape : (92, 17, 384), with range scale (0.503272294998169,-0.5399895310401917) 
source_data subject_idx 60 has shape : (88, 17, 384), with range scale (0.8019402623176575,-0.75787752866745) 
source_data subject_idx 61 has shape : (90, 17, 384), with range scale (0.4405616819858551,-0.5884069800376892) 
source_data subject_idx 62 has shape : (90, 17, 384), with range scale (2.480820655822754,-1.1794875860214233) 
source_data subject_idx 63 has shape : (91, 17, 384), with range scale (0.5555720329284668,-0.609916627407074) 
source_data subject_idx 64 has shape : (92, 17, 384), with range scale (0.7050769329071045,-0.7183904051780701) 
source_data subject_idx 65 has shape : (90, 17, 384), with range scale (1.1813173294067383,-1.4158159494400024) 
source_data subject_idx 66 has shape : (89, 17, 384), with range scale (1.169793963432312,-1.162235975265503) 
source_data subject_idx 67 has shape : (90, 17, 384), with range scale (0.6568388938903809,-0.5140275955200195) 
source_data subject_idx 68 has shape : (92, 17, 384), with range scale (0.4186505973339081,-0.5416693091392517) 
source_data subject_idx 69 has shape : (89, 17, 384), with range scale (0.9091640710830688,-0.8549709916114807) 
source_data subject_idx 70 has shape : (89, 17, 384), with range scale (1.1580862998962402,-1.0784372091293335) 
source_data subject_idx 71 has shape : (90, 17, 384), with range scale (0.8840420246124268,-0.9830904006958008) 
source_data subject_idx 72 has shape : (90, 17, 384), with range scale (0.5972389578819275,-0.4964401125907898) 
source_data subject_idx 73 has shape : (91, 17, 384), with range scale (0.7535731196403503,-0.7292771339416504) 
source_data subject_idx 74 has shape : (91, 17, 384), with range scale (0.73072350025177,-0.7904592752456665) 
source_data subject_idx 75 has shape : (90, 17, 384), with range scale (0.3187751770019531,-0.355183482170105) 
source_data subject_idx 76 has shape : (89, 17, 384), with range scale (0.7476410865783691,-0.653012216091156) 
source_data subject_idx 77 has shape : (91, 17, 384), with range scale (1.4965280294418335,-1.3019781112670898) 
source_data subject_idx 78 has shape : (91, 17, 384), with range scale (0.6563048958778381,-0.5579637289047241) 
source_data subject_idx 79 has shape : (89, 17, 384), with range scale (1.6257643699645996,-1.1466976404190063) 
source_data subject_idx 80 has shape : (90, 17, 384), with range scale (1.017038106918335,-1.1585050821304321) 
source_data subject_idx 81 has shape : (89, 17, 384), with range scale (0.5660838484764099,-0.8437317609786987) 
source_data subject_idx 82 has shape : (90, 17, 384), with range scale (0.900054395198822,-0.9659441709518433) 
source_data subject_idx 83 has shape : (91, 17, 384), with range scale (0.9371195435523987,-1.356507658958435) 
source_data subject_idx 84 has shape : (90, 17, 384), with range scale (0.6579915881156921,-0.4786575436592102) 
source_data subject_idx 85 has shape : (91, 17, 384), with range scale (1.1371746063232422,-1.2223700284957886) 
source_data subject_idx 86 has shape : (89, 17, 384), with range scale (0.7439618110656738,-0.624003529548645) 
source_data subject_idx 87 has shape : (114, 17, 384), with range scale (0.42124319076538086,-0.4062422811985016) 
source_data subject_idx 88 has shape : (90, 17, 384), with range scale (0.8885942101478577,-0.9470054507255554) 
source_data subject_idx 89 has shape : (90, 17, 384), with range scale (0.7889284491539001,-0.8844084739685059) 
source_data subject_idx 90 has shape : (90, 17, 384), with range scale (0.7539210319519043,-0.6837416887283325) 
source_data subject_idx 91 has shape : (111, 17, 384), with range scale (0.4892567992210388,-0.5099184513092041) 
source_data subject_idx 92 has shape : (90, 17, 384), with range scale (0.4826072156429291,-0.36527764797210693) 
source_data subject_idx 93 has shape : (90, 17, 384), with range scale (0.9776809215545654,-0.6807703971862793) 
source_data subject_idx 94 has shape : (91, 17, 384), with range scale (0.946986973285675,-1.0356836318969727) 
source_data subject_idx 95 has shape : (92, 17, 384), with range scale (0.8312045335769653,-0.8184489607810974) 
source_data subject_idx 96 has shape : (90, 17, 384), with range scale (0.6298197507858276,-1.0925219058990479) 
source_data subject_idx 97 has shape : (92, 17, 384), with range scale (0.4181371331214905,-0.508488655090332) 
source_data subject_idx 98 has shape : (91, 17, 384), with range scale (1.233091115951538,-1.2026557922363281) 
source_data subject_idx 99 has shape : (72, 17, 384), with range scale (0.770717978477478,-0.6864450573921204) 
source_data subject_idx 100 has shape : (88, 17, 384), with range scale (0.3383553624153137,-0.3229562044143677) 
source_data subject_idx 101 has shape : (89, 17, 384), with range scale (1.214106559753418,-1.1739592552185059) 
source_data subject_idx 102 has shape : (90, 17, 384), with range scale (0.7657291889190674,-0.8259928226470947) 
source_data subject_idx 103 has shape : (88, 17, 384), with range scale (0.45258983969688416,-0.6623888611793518) 
source_data subject_idx 104 has shape : (89, 17, 384), with range scale (0.6345487833023071,-0.48687201738357544) 
source_data subject_idx 105 has shape : (91, 17, 384), with range scale (0.5918318033218384,-0.5974709987640381) 
source_data subject_idx 106 has shape : (92, 17, 384), with range scale (0.7309435606002808,-0.9357020258903503) 
source_data subject_idx 107 has shape : (90, 17, 384), with range scale (0.6797388195991516,-0.760359525680542) 
source_data subject_idx 108 has shape : (90, 17, 384), with range scale (1.105279803276062,-1.2459110021591187) 
source dataset idx :  2
run custom EA
generate new r_op
source_data subject_idx 0 has shape : (576, 17, 384), with range scale (0.7720328569412231,-1.0032285451889038) 
source_data subject_idx 1 has shape : (576, 17, 384), with range scale (0.7470634579658508,-0.7756261825561523) 
source_data subject_idx 2 has shape : (576, 17, 384), with range scale (1.122564435005188,-1.5645434856414795) 
source_data subject_idx 3 has shape : (576, 17, 384), with range scale (0.7821568250656128,-0.958053469657898) 
source_data subject_idx 4 has shape : (576, 17, 384), with range scale (1.39310622215271,-1.5814940929412842) 
source_data subject_idx 5 has shape : (576, 17, 384), with range scale (1.129255771636963,-1.0122603178024292) 
source_data subject_idx 6 has shape : (576, 17, 384), with range scale (0.4136982262134552,-0.45542657375335693) 
source_data subject_idx 7 has shape : (576, 17, 384), with range scale (1.1008994579315186,-1.0081154108047485) 
source_data subject_idx 8 has shape : (576, 17, 384), with range scale (0.6211870908737183,-0.6390889286994934) 
only use r-op for subjects [0]
use exist r_op
unlabel data subject_idx 0 has shape : (200, 17, 384), with range scale (1.599064826965332,-1.3868545293807983) 
Loading trainer: MultiDatasetMCDV1
Params :  FREEZE: False
NAME: deepsleep
PARAMS:
  F1: 8
  F2: 8
  avg_pool_1: 4
  avg_pool_2: 8
  drop_prob: 0.25
  kern_length_1: 64
  kern_length_2: 16
  num_ch: 17
  samples: 384
PRETRAINED: False
PRETRAINED_PATH: 
Building F
Building CommonFeature
Backbone: deepsleep
params set up :  {'kern_length_1': 64, 'kern_length_2': 16, 'num_ch': 17, 'samples': 384, 'F1': 8, 'F2': 8, 'drop_prob': 0.25, 'avg_pool_1': 4, 'avg_pool_2': 8}
pretrain :  False
pretrain path : 
Building Target Classifier
use max norm constraint on last FC
use max norm constraint on last FC
Building SourceClassifiers
source domains label size :  [2, 4, 4]
use max norm constraint on last FC
use max norm constraint on last FC
use max norm constraint on last FC
there is n_step_F :  5
save checkpoint keys :  dict_keys(['epoch', 'global_step', 'pytorch-lightning_version', 'state_dict', 'callbacks', 'optimizer_states', 'lr_schedulers'])
size of test loader :  1
Testing: 0it [00:00, ?it/s]in test epoch end
Testing: 100%|##########| 1/1 [00:00<00:00, 115.99it/s]
--------------------------------------------------------------------------------
DATALOADER:0 TEST RESULTS
{'class_0_acc': 0.5714285969734192,
 'class_1_acc': 0.800000011920929,
 'class_2_acc': 0.0,
 'class_3_acc': 0.5,
 'test_F1': 0.420634925365448,
 'test_acc': 0.5,
 'test_classes_avg_acc': 0.46785715222358704,
 'test_loss': 4.573701858520508}
--------------------------------------------------------------------------------
test result :  {'test_acc': 0.5, 'test_loss': 4.573701858520508, 'test_F1': 0.420634925365448, 'test_classes_avg_acc': 0.46785715222358704, 'class_0_acc': 0.5714285969734192, 'class_1_acc': 0.800000011920929, 'class_2_acc': 0.0, 'class_3_acc': 0.5}
use data manager for domain adaptation
Loading dataset: MultiDataset
data root :  /data1/wduong_experiment_data/EEG_Dassl_Lightning/da_dataset/NeurIPS_competition
dataset dir :  final_MI_A_1
file name :  dataset_A_1/NeurIPS_TL.mat
r_op file path :  /data1/wduong_experiment_data/EEG_Dassl_Lightning/da_dataset/NeurIPS_competition/final_MI_A_1/dataset_A_1/dataset_A_1_r_op.mat

there is test file 
run custom EA
only use r-op for subjects [0]
only use r-op for subjects [0]
only use r-op for subjects [0]
use exist r_op
use exist r_op
use exist r_op
train subjects :  [0]
Train subject 0 has shape : (80, 1, 17, 384), with range scale (0.34500741958618164,-0.36929842829704285) 
test subjects :  [0]
test subject 0 has shape : (20, 1, 17, 384), with range scale (0.3514663279056549,-0.3208301067352295)  
valid subjects :  [0]
valid subject 0 has shape : (20, 1, 17, 384), with range scale (0.3514663279056549,-0.3208301067352295)  
the labels ratio of whole dataset : [4.2105263157894735, 4.444444444444445, 4.0, 3.4782608695652173]
source dataset idx :  0
run custom EA
generate new r_op
source_data subject_idx 0 has shape : (200, 17, 384), with range scale (2.8949124813079834,-3.0439417362213135) 
source_data subject_idx 1 has shape : (200, 17, 384), with range scale (2.514171838760376,-1.8399908542633057) 
source_data subject_idx 2 has shape : (200, 17, 384), with range scale (0.4031869173049927,-0.47407403588294983) 
source_data subject_idx 3 has shape : (200, 17, 384), with range scale (0.6525675058364868,-0.940330982208252) 
source_data subject_idx 4 has shape : (200, 17, 384), with range scale (1.3534847497940063,-1.3447120189666748) 
source_data subject_idx 5 has shape : (200, 17, 384), with range scale (0.6063358187675476,-0.529009997844696) 
source_data subject_idx 6 has shape : (240, 17, 384), with range scale (1.6099324226379395,-1.8825329542160034) 
source_data subject_idx 7 has shape : (200, 17, 384), with range scale (0.5209750533103943,-0.6464478373527527) 
source_data subject_idx 8 has shape : (240, 17, 384), with range scale (0.8885074257850647,-0.6163159012794495) 
source_data subject_idx 9 has shape : (200, 17, 384), with range scale (0.6655832529067993,-0.6934170126914978) 
source_data subject_idx 10 has shape : (200, 17, 384), with range scale (1.9625093936920166,-2.119454860687256) 
source_data subject_idx 11 has shape : (200, 17, 384), with range scale (0.6637643575668335,-0.5274373292922974) 
source_data subject_idx 12 has shape : (200, 17, 384), with range scale (0.3471425175666809,-0.4625225365161896) 
source_data subject_idx 13 has shape : (200, 17, 384), with range scale (0.4911949634552002,-0.5363013744354248) 
source_data subject_idx 14 has shape : (200, 17, 384), with range scale (0.7762149572372437,-0.6893907189369202) 
source_data subject_idx 15 has shape : (200, 17, 384), with range scale (0.9339151382446289,-1.013419508934021) 
source_data subject_idx 16 has shape : (200, 17, 384), with range scale (0.7132470607757568,-0.7285250425338745) 
source_data subject_idx 17 has shape : (200, 17, 384), with range scale (1.3041503429412842,-1.302201271057129) 
source_data subject_idx 18 has shape : (200, 17, 384), with range scale (1.9319943189620972,-1.5425034761428833) 
source_data subject_idx 19 has shape : (200, 17, 384), with range scale (0.5737782716751099,-0.5609017610549927) 
source_data subject_idx 20 has shape : (200, 17, 384), with range scale (1.0189663171768188,-0.7435137629508972) 
source_data subject_idx 21 has shape : (200, 17, 384), with range scale (1.8597694635391235,-1.2779128551483154) 
source_data subject_idx 22 has shape : (200, 17, 384), with range scale (1.361822485923767,-1.1432263851165771) 
source_data subject_idx 23 has shape : (200, 17, 384), with range scale (0.816189169883728,-0.9853714108467102) 
source_data subject_idx 24 has shape : (200, 17, 384), with range scale (1.1504335403442383,-1.1430150270462036) 
source_data subject_idx 25 has shape : (200, 17, 384), with range scale (2.702618360519409,-2.9552226066589355) 
source_data subject_idx 26 has shape : (200, 17, 384), with range scale (1.6591249704360962,-1.339446783065796) 
source_data subject_idx 27 has shape : (200, 17, 384), with range scale (1.3382678031921387,-1.0206931829452515) 
source_data subject_idx 28 has shape : (200, 17, 384), with range scale (1.9607363939285278,-1.5337920188903809) 
source_data subject_idx 29 has shape : (200, 17, 384), with range scale (0.5270815491676331,-0.6194854378700256) 
source_data subject_idx 30 has shape : (200, 17, 384), with range scale (0.49716678261756897,-0.4811560809612274) 
source_data subject_idx 31 has shape : (200, 17, 384), with range scale (0.5298357605934143,-0.7361605167388916) 
source_data subject_idx 32 has shape : (200, 17, 384), with range scale (0.6544474959373474,-0.7373430728912354) 
source_data subject_idx 33 has shape : (200, 17, 384), with range scale (2.2704901695251465,-2.6788127422332764) 
source_data subject_idx 34 has shape : (200, 17, 384), with range scale (2.0606043338775635,-2.6862478256225586) 
source_data subject_idx 35 has shape : (200, 17, 384), with range scale (2.564141273498535,-2.50285005569458) 
source_data subject_idx 36 has shape : (200, 17, 384), with range scale (0.9874972105026245,-0.6999896764755249) 
source_data subject_idx 37 has shape : (200, 17, 384), with range scale (0.5172118544578552,-0.5190767645835876) 
source_data subject_idx 38 has shape : (200, 17, 384), with range scale (1.128941535949707,-1.2659436464309692) 
source_data subject_idx 39 has shape : (200, 17, 384), with range scale (0.6239213943481445,-0.676697313785553) 
source_data subject_idx 40 has shape : (200, 17, 384), with range scale (1.2671682834625244,-1.0153831243515015) 
source_data subject_idx 41 has shape : (200, 17, 384), with range scale (0.5134593844413757,-0.5995444655418396) 
source_data subject_idx 42 has shape : (200, 17, 384), with range scale (1.3841683864593506,-1.0470761060714722) 
source_data subject_idx 43 has shape : (200, 17, 384), with range scale (1.0282957553863525,-0.8850383758544922) 
source_data subject_idx 44 has shape : (200, 17, 384), with range scale (0.8763719201087952,-0.873806357383728) 
source_data subject_idx 45 has shape : (200, 17, 384), with range scale (0.9527843594551086,-0.8911209106445312) 
source_data subject_idx 46 has shape : (200, 17, 384), with range scale (1.6098185777664185,-1.765346884727478) 
source_data subject_idx 47 has shape : (200, 17, 384), with range scale (1.397952675819397,-1.5371551513671875) 
source_data subject_idx 48 has shape : (200, 17, 384), with range scale (1.0645549297332764,-0.7614633440971375) 
source dataset idx :  1
run custom EA
generate new r_op
source_data subject_idx 0 has shape : (92, 17, 384), with range scale (0.6635822653770447,-0.6450462341308594) 
source_data subject_idx 1 has shape : (89, 17, 384), with range scale (0.6527177095413208,-0.8556455373764038) 
source_data subject_idx 2 has shape : (92, 17, 384), with range scale (0.9350364804267883,-0.9835978746414185) 
source_data subject_idx 3 has shape : (91, 17, 384), with range scale (0.6761916279792786,-0.892231285572052) 
source_data subject_idx 4 has shape : (88, 17, 384), with range scale (0.8706837296485901,-1.0782322883605957) 
source_data subject_idx 5 has shape : (92, 17, 384), with range scale (0.9342394471168518,-0.834481418132782) 
source_data subject_idx 6 has shape : (91, 17, 384), with range scale (0.4325883090496063,-0.5748054385185242) 
source_data subject_idx 7 has shape : (89, 17, 384), with range scale (1.3702843189239502,-1.167189598083496) 
source_data subject_idx 8 has shape : (91, 17, 384), with range scale (0.5027489066123962,-0.45364537835121155) 
source_data subject_idx 9 has shape : (91, 17, 384), with range scale (0.3971041440963745,-0.511340320110321) 
source_data subject_idx 10 has shape : (91, 17, 384), with range scale (1.2434769868850708,-1.2928123474121094) 
source_data subject_idx 11 has shape : (89, 17, 384), with range scale (1.0204869508743286,-1.1365001201629639) 
source_data subject_idx 12 has shape : (91, 17, 384), with range scale (0.6192032098770142,-0.6019769310951233) 
source_data subject_idx 13 has shape : (88, 17, 384), with range scale (0.3086931109428406,-0.40464091300964355) 
source_data subject_idx 14 has shape : (91, 17, 384), with range scale (0.44820329546928406,-0.49501609802246094) 
source_data subject_idx 15 has shape : (88, 17, 384), with range scale (0.46991586685180664,-0.5845204591751099) 
source_data subject_idx 16 has shape : (89, 17, 384), with range scale (0.8641892075538635,-1.2129716873168945) 
source_data subject_idx 17 has shape : (90, 17, 384), with range scale (0.4410848617553711,-0.3699715733528137) 
source_data subject_idx 18 has shape : (91, 17, 384), with range scale (0.47157102823257446,-0.4453599154949188) 
source_data subject_idx 19 has shape : (90, 17, 384), with range scale (0.534877359867096,-0.5651514530181885) 
source_data subject_idx 20 has shape : (90, 17, 384), with range scale (0.39198678731918335,-0.489992618560791) 
source_data subject_idx 21 has shape : (91, 17, 384), with range scale (0.61040198802948,-0.8814409375190735) 
source_data subject_idx 22 has shape : (89, 17, 384), with range scale (0.7364908456802368,-0.901198148727417) 
source_data subject_idx 23 has shape : (90, 17, 384), with range scale (0.6853683590888977,-0.7968631386756897) 
source_data subject_idx 24 has shape : (88, 17, 384), with range scale (0.93064284324646,-1.1263375282287598) 
source_data subject_idx 25 has shape : (93, 17, 384), with range scale (0.9077349901199341,-0.8342688083648682) 
source_data subject_idx 26 has shape : (91, 17, 384), with range scale (1.2297872304916382,-1.2567424774169922) 
source_data subject_idx 27 has shape : (89, 17, 384), with range scale (0.6552313566207886,-0.8012681603431702) 
source_data subject_idx 28 has shape : (91, 17, 384), with range scale (0.8271992206573486,-0.784073531627655) 
source_data subject_idx 29 has shape : (90, 17, 384), with range scale (2.0755653381347656,-1.7833671569824219) 
source_data subject_idx 30 has shape : (89, 17, 384), with range scale (0.4152286648750305,-0.6024753451347351) 
source_data subject_idx 31 has shape : (89, 17, 384), with range scale (1.1088554859161377,-1.1350764036178589) 
source_data subject_idx 32 has shape : (91, 17, 384), with range scale (0.4496297240257263,-0.4981136918067932) 
source_data subject_idx 33 has shape : (89, 17, 384), with range scale (0.8972886204719543,-0.8705561757087708) 
source_data subject_idx 34 has shape : (88, 17, 384), with range scale (0.9323359131813049,-0.8804383277893066) 
source_data subject_idx 35 has shape : (91, 17, 384), with range scale (0.9958591461181641,-1.0287989377975464) 
source_data subject_idx 36 has shape : (91, 17, 384), with range scale (0.6097190380096436,-0.6170302629470825) 
source_data subject_idx 37 has shape : (90, 17, 384), with range scale (0.4325774013996124,-0.37416771054267883) 
source_data subject_idx 38 has shape : (90, 17, 384), with range scale (0.4709510803222656,-0.3654654920101166) 
source_data subject_idx 39 has shape : (89, 17, 384), with range scale (0.8825229406356812,-1.476203441619873) 
source_data subject_idx 40 has shape : (91, 17, 384), with range scale (0.5058969855308533,-0.49067941308021545) 
source_data subject_idx 41 has shape : (88, 17, 384), with range scale (0.9766131639480591,-0.6556596755981445) 
source_data subject_idx 42 has shape : (90, 17, 384), with range scale (0.9502836465835571,-1.0015034675598145) 
source_data subject_idx 43 has shape : (89, 17, 384), with range scale (0.4527646601200104,-0.4087400734424591) 
source_data subject_idx 44 has shape : (89, 17, 384), with range scale (0.8421286344528198,-1.0863838195800781) 
source_data subject_idx 45 has shape : (91, 17, 384), with range scale (0.7677578330039978,-0.7578632235527039) 
source_data subject_idx 46 has shape : (91, 17, 384), with range scale (0.5478517413139343,-0.6169934868812561) 
source_data subject_idx 47 has shape : (88, 17, 384), with range scale (0.5600345730781555,-0.6607357859611511) 
source_data subject_idx 48 has shape : (92, 17, 384), with range scale (0.6931192874908447,-0.6391355395317078) 
source_data subject_idx 49 has shape : (89, 17, 384), with range scale (0.7659339904785156,-1.0686750411987305) 
source_data subject_idx 50 has shape : (93, 17, 384), with range scale (1.1803903579711914,-1.3481924533843994) 
source_data subject_idx 51 has shape : (92, 17, 384), with range scale (0.5909032821655273,-0.6613151431083679) 
source_data subject_idx 52 has shape : (89, 17, 384), with range scale (0.9489699006080627,-0.8693708181381226) 
source_data subject_idx 53 has shape : (90, 17, 384), with range scale (0.7868562936782837,-0.8488566279411316) 
source_data subject_idx 54 has shape : (90, 17, 384), with range scale (0.4624077379703522,-0.3843694031238556) 
source_data subject_idx 55 has shape : (89, 17, 384), with range scale (0.855067253112793,-0.7476500868797302) 
source_data subject_idx 56 has shape : (92, 17, 384), with range scale (1.451259970664978,-0.8775184750556946) 
source_data subject_idx 57 has shape : (91, 17, 384), with range scale (0.7655401229858398,-0.913463294506073) 
source_data subject_idx 58 has shape : (92, 17, 384), with range scale (1.8924585580825806,-0.7973564267158508) 
source_data subject_idx 59 has shape : (92, 17, 384), with range scale (0.503272294998169,-0.5399895310401917) 
source_data subject_idx 60 has shape : (88, 17, 384), with range scale (0.8019402623176575,-0.75787752866745) 
source_data subject_idx 61 has shape : (90, 17, 384), with range scale (0.4405616819858551,-0.5884069800376892) 
source_data subject_idx 62 has shape : (90, 17, 384), with range scale (2.480820655822754,-1.1794875860214233) 
source_data subject_idx 63 has shape : (91, 17, 384), with range scale (0.5555720329284668,-0.609916627407074) 
source_data subject_idx 64 has shape : (92, 17, 384), with range scale (0.7050769329071045,-0.7183904051780701) 
source_data subject_idx 65 has shape : (90, 17, 384), with range scale (1.1813173294067383,-1.4158159494400024) 
source_data subject_idx 66 has shape : (89, 17, 384), with range scale (1.169793963432312,-1.162235975265503) 
source_data subject_idx 67 has shape : (90, 17, 384), with range scale (0.6568388938903809,-0.5140275955200195) 
source_data subject_idx 68 has shape : (92, 17, 384), with range scale (0.4186505973339081,-0.5416693091392517) 
source_data subject_idx 69 has shape : (89, 17, 384), with range scale (0.9091640710830688,-0.8549709916114807) 
source_data subject_idx 70 has shape : (89, 17, 384), with range scale (1.1580862998962402,-1.0784372091293335) 
source_data subject_idx 71 has shape : (90, 17, 384), with range scale (0.8840420246124268,-0.9830904006958008) 
source_data subject_idx 72 has shape : (90, 17, 384), with range scale (0.5972389578819275,-0.4964401125907898) 
source_data subject_idx 73 has shape : (91, 17, 384), with range scale (0.7535731196403503,-0.7292771339416504) 
source_data subject_idx 74 has shape : (91, 17, 384), with range scale (0.73072350025177,-0.7904592752456665) 
source_data subject_idx 75 has shape : (90, 17, 384), with range scale (0.3187751770019531,-0.355183482170105) 
source_data subject_idx 76 has shape : (89, 17, 384), with range scale (0.7476410865783691,-0.653012216091156) 
source_data subject_idx 77 has shape : (91, 17, 384), with range scale (1.4965280294418335,-1.3019781112670898) 
source_data subject_idx 78 has shape : (91, 17, 384), with range scale (0.6563048958778381,-0.5579637289047241) 
source_data subject_idx 79 has shape : (89, 17, 384), with range scale (1.6257643699645996,-1.1466976404190063) 
source_data subject_idx 80 has shape : (90, 17, 384), with range scale (1.017038106918335,-1.1585050821304321) 
source_data subject_idx 81 has shape : (89, 17, 384), with range scale (0.5660838484764099,-0.8437317609786987) 
source_data subject_idx 82 has shape : (90, 17, 384), with range scale (0.900054395198822,-0.9659441709518433) 
source_data subject_idx 83 has shape : (91, 17, 384), with range scale (0.9371195435523987,-1.356507658958435) 
source_data subject_idx 84 has shape : (90, 17, 384), with range scale (0.6579915881156921,-0.4786575436592102) 
source_data subject_idx 85 has shape : (91, 17, 384), with range scale (1.1371746063232422,-1.2223700284957886) 
source_data subject_idx 86 has shape : (89, 17, 384), with range scale (0.7439618110656738,-0.624003529548645) 
source_data subject_idx 87 has shape : (114, 17, 384), with range scale (0.42124319076538086,-0.4062422811985016) 
source_data subject_idx 88 has shape : (90, 17, 384), with range scale (0.8885942101478577,-0.9470054507255554) 
source_data subject_idx 89 has shape : (90, 17, 384), with range scale (0.7889284491539001,-0.8844084739685059) 
source_data subject_idx 90 has shape : (90, 17, 384), with range scale (0.7539210319519043,-0.6837416887283325) 
source_data subject_idx 91 has shape : (111, 17, 384), with range scale (0.4892567992210388,-0.5099184513092041) 
source_data subject_idx 92 has shape : (90, 17, 384), with range scale (0.4826072156429291,-0.36527764797210693) 
source_data subject_idx 93 has shape : (90, 17, 384), with range scale (0.9776809215545654,-0.6807703971862793) 
source_data subject_idx 94 has shape : (91, 17, 384), with range scale (0.946986973285675,-1.0356836318969727) 
source_data subject_idx 95 has shape : (92, 17, 384), with range scale (0.8312045335769653,-0.8184489607810974) 
source_data subject_idx 96 has shape : (90, 17, 384), with range scale (0.6298197507858276,-1.0925219058990479) 
source_data subject_idx 97 has shape : (92, 17, 384), with range scale (0.4181371331214905,-0.508488655090332) 
source_data subject_idx 98 has shape : (91, 17, 384), with range scale (1.233091115951538,-1.2026557922363281) 
source_data subject_idx 99 has shape : (72, 17, 384), with range scale (0.770717978477478,-0.6864450573921204) 
source_data subject_idx 100 has shape : (88, 17, 384), with range scale (0.3383553624153137,-0.3229562044143677) 
source_data subject_idx 101 has shape : (89, 17, 384), with range scale (1.214106559753418,-1.1739592552185059) 
source_data subject_idx 102 has shape : (90, 17, 384), with range scale (0.7657291889190674,-0.8259928226470947) 
source_data subject_idx 103 has shape : (88, 17, 384), with range scale (0.45258983969688416,-0.6623888611793518) 
source_data subject_idx 104 has shape : (89, 17, 384), with range scale (0.6345487833023071,-0.48687201738357544) 
source_data subject_idx 105 has shape : (91, 17, 384), with range scale (0.5918318033218384,-0.5974709987640381) 
source_data subject_idx 106 has shape : (92, 17, 384), with range scale (0.7309435606002808,-0.9357020258903503) 
source_data subject_idx 107 has shape : (90, 17, 384), with range scale (0.6797388195991516,-0.760359525680542) 
source_data subject_idx 108 has shape : (90, 17, 384), with range scale (1.105279803276062,-1.2459110021591187) 
source dataset idx :  2
run custom EA
generate new r_op
source_data subject_idx 0 has shape : (576, 17, 384), with range scale (0.7720328569412231,-1.0032285451889038) 
source_data subject_idx 1 has shape : (576, 17, 384), with range scale (0.7470634579658508,-0.7756261825561523) 
source_data subject_idx 2 has shape : (576, 17, 384), with range scale (1.122564435005188,-1.5645434856414795) 
source_data subject_idx 3 has shape : (576, 17, 384), with range scale (0.7821568250656128,-0.958053469657898) 
source_data subject_idx 4 has shape : (576, 17, 384), with range scale (1.39310622215271,-1.5814940929412842) 
source_data subject_idx 5 has shape : (576, 17, 384), with range scale (1.129255771636963,-1.0122603178024292) 
source_data subject_idx 6 has shape : (576, 17, 384), with range scale (0.4136982262134552,-0.45542657375335693) 
source_data subject_idx 7 has shape : (576, 17, 384), with range scale (1.1008994579315186,-1.0081154108047485) 
source_data subject_idx 8 has shape : (576, 17, 384), with range scale (0.6211870908737183,-0.6390889286994934) 
only use r-op for subjects [0]
use exist r_op
unlabel data subject_idx 0 has shape : (200, 17, 384), with range scale (1.599064826965332,-1.3868545293807983) 
Loading trainer: MultiDatasetMCDV1
Params :  FREEZE: False
NAME: deepsleep
PARAMS:
  F1: 8
  F2: 8
  avg_pool_1: 4
  avg_pool_2: 8
  drop_prob: 0.25
  kern_length_1: 64
  kern_length_2: 16
  num_ch: 17
  samples: 384
PRETRAINED: False
PRETRAINED_PATH: 
Building F
Building CommonFeature
Backbone: deepsleep
params set up :  {'kern_length_1': 64, 'kern_length_2': 16, 'num_ch': 17, 'samples': 384, 'F1': 8, 'F2': 8, 'drop_prob': 0.25, 'avg_pool_1': 4, 'avg_pool_2': 8}
pretrain :  False
pretrain path : 
Building Target Classifier
use max norm constraint on last FC
use max norm constraint on last FC
Building SourceClassifiers
source domains label size :  [2, 4, 4]
use max norm constraint on last FC
use max norm constraint on last FC
use max norm constraint on last FC
there is n_step_F :  5
save checkpoint keys :  dict_keys(['epoch', 'global_step', 'pytorch-lightning_version', 'state_dict', 'callbacks', 'optimizer_states', 'lr_schedulers'])
size of test loader :  1
Testing: 0it [00:00, ?it/s]in test epoch end
Testing: 100%|##########| 1/1 [00:00<00:00, 117.18it/s]
--------------------------------------------------------------------------------
DATALOADER:0 TEST RESULTS
{'class_0_acc': 0.6666666865348816,
 'class_1_acc': 0.7142857313156128,
 'class_2_acc': 0.6000000238418579,
 'class_3_acc': 0.0,
 'test_F1': 0.4696969985961914,
 'test_acc': 0.6000000238418579,
 'test_classes_avg_acc': 0.4952380955219269,
 'test_loss': 3.581035852432251}
--------------------------------------------------------------------------------
test result :  {'test_acc': 0.6000000238418579, 'test_loss': 3.581035852432251, 'test_F1': 0.4696969985961914, 'test_classes_avg_acc': 0.4952380955219269, 'class_0_acc': 0.6666666865348816, 'class_1_acc': 0.7142857313156128, 'class_2_acc': 0.6000000238418579, 'class_3_acc': 0.0}
use data manager for domain adaptation
Loading dataset: MultiDataset
data root :  /data1/wduong_experiment_data/EEG_Dassl_Lightning/da_dataset/NeurIPS_competition
dataset dir :  final_MI_A_1
file name :  dataset_A_1/NeurIPS_TL.mat
r_op file path :  /data1/wduong_experiment_data/EEG_Dassl_Lightning/da_dataset/NeurIPS_competition/final_MI_A_1/dataset_A_1/dataset_A_1_r_op.mat

there is test file 
run custom EA
only use r-op for subjects [0]
only use r-op for subjects [0]
only use r-op for subjects [0]
use exist r_op
use exist r_op
use exist r_op
train subjects :  [0]
Train subject 0 has shape : (80, 1, 17, 384), with range scale (0.3514663279056549,-0.36929842829704285) 
test subjects :  [0]
test subject 0 has shape : (20, 1, 17, 384), with range scale (0.2700573801994324,-0.23661769926548004)  
valid subjects :  [0]
valid subject 0 has shape : (20, 1, 17, 384), with range scale (0.2700573801994324,-0.23661769926548004)  
the labels ratio of whole dataset : [4.0, 4.444444444444445, 4.2105263157894735, 3.4782608695652173]
source dataset idx :  0
run custom EA
generate new r_op
source_data subject_idx 0 has shape : (200, 17, 384), with range scale (2.8949124813079834,-3.0439417362213135) 
source_data subject_idx 1 has shape : (200, 17, 384), with range scale (2.514171838760376,-1.8399908542633057) 
source_data subject_idx 2 has shape : (200, 17, 384), with range scale (0.4031869173049927,-0.47407403588294983) 
source_data subject_idx 3 has shape : (200, 17, 384), with range scale (0.6525675058364868,-0.940330982208252) 
source_data subject_idx 4 has shape : (200, 17, 384), with range scale (1.3534847497940063,-1.3447120189666748) 
source_data subject_idx 5 has shape : (200, 17, 384), with range scale (0.6063358187675476,-0.529009997844696) 
source_data subject_idx 6 has shape : (240, 17, 384), with range scale (1.6099324226379395,-1.8825329542160034) 
source_data subject_idx 7 has shape : (200, 17, 384), with range scale (0.5209750533103943,-0.6464478373527527) 
source_data subject_idx 8 has shape : (240, 17, 384), with range scale (0.8885074257850647,-0.6163159012794495) 
source_data subject_idx 9 has shape : (200, 17, 384), with range scale (0.6655832529067993,-0.6934170126914978) 
source_data subject_idx 10 has shape : (200, 17, 384), with range scale (1.9625093936920166,-2.119454860687256) 
source_data subject_idx 11 has shape : (200, 17, 384), with range scale (0.6637643575668335,-0.5274373292922974) 
source_data subject_idx 12 has shape : (200, 17, 384), with range scale (0.3471425175666809,-0.4625225365161896) 
source_data subject_idx 13 has shape : (200, 17, 384), with range scale (0.4911949634552002,-0.5363013744354248) 
source_data subject_idx 14 has shape : (200, 17, 384), with range scale (0.7762149572372437,-0.6893907189369202) 
source_data subject_idx 15 has shape : (200, 17, 384), with range scale (0.9339151382446289,-1.013419508934021) 
source_data subject_idx 16 has shape : (200, 17, 384), with range scale (0.7132470607757568,-0.7285250425338745) 
source_data subject_idx 17 has shape : (200, 17, 384), with range scale (1.3041503429412842,-1.302201271057129) 
source_data subject_idx 18 has shape : (200, 17, 384), with range scale (1.9319943189620972,-1.5425034761428833) 
source_data subject_idx 19 has shape : (200, 17, 384), with range scale (0.5737782716751099,-0.5609017610549927) 
source_data subject_idx 20 has shape : (200, 17, 384), with range scale (1.0189663171768188,-0.7435137629508972) 
source_data subject_idx 21 has shape : (200, 17, 384), with range scale (1.8597694635391235,-1.2779128551483154) 
source_data subject_idx 22 has shape : (200, 17, 384), with range scale (1.361822485923767,-1.1432263851165771) 
source_data subject_idx 23 has shape : (200, 17, 384), with range scale (0.816189169883728,-0.9853714108467102) 
source_data subject_idx 24 has shape : (200, 17, 384), with range scale (1.1504335403442383,-1.1430150270462036) 
source_data subject_idx 25 has shape : (200, 17, 384), with range scale (2.702618360519409,-2.9552226066589355) 
source_data subject_idx 26 has shape : (200, 17, 384), with range scale (1.6591249704360962,-1.339446783065796) 
source_data subject_idx 27 has shape : (200, 17, 384), with range scale (1.3382678031921387,-1.0206931829452515) 
source_data subject_idx 28 has shape : (200, 17, 384), with range scale (1.9607363939285278,-1.5337920188903809) 
source_data subject_idx 29 has shape : (200, 17, 384), with range scale (0.5270815491676331,-0.6194854378700256) 
source_data subject_idx 30 has shape : (200, 17, 384), with range scale (0.49716678261756897,-0.4811560809612274) 
source_data subject_idx 31 has shape : (200, 17, 384), with range scale (0.5298357605934143,-0.7361605167388916) 
source_data subject_idx 32 has shape : (200, 17, 384), with range scale (0.6544474959373474,-0.7373430728912354) 
source_data subject_idx 33 has shape : (200, 17, 384), with range scale (2.2704901695251465,-2.6788127422332764) 
source_data subject_idx 34 has shape : (200, 17, 384), with range scale (2.0606043338775635,-2.6862478256225586) 
source_data subject_idx 35 has shape : (200, 17, 384), with range scale (2.564141273498535,-2.50285005569458) 
source_data subject_idx 36 has shape : (200, 17, 384), with range scale (0.9874972105026245,-0.6999896764755249) 
source_data subject_idx 37 has shape : (200, 17, 384), with range scale (0.5172118544578552,-0.5190767645835876) 
source_data subject_idx 38 has shape : (200, 17, 384), with range scale (1.128941535949707,-1.2659436464309692) 
source_data subject_idx 39 has shape : (200, 17, 384), with range scale (0.6239213943481445,-0.676697313785553) 
source_data subject_idx 40 has shape : (200, 17, 384), with range scale (1.2671682834625244,-1.0153831243515015) 
source_data subject_idx 41 has shape : (200, 17, 384), with range scale (0.5134593844413757,-0.5995444655418396) 
source_data subject_idx 42 has shape : (200, 17, 384), with range scale (1.3841683864593506,-1.0470761060714722) 
source_data subject_idx 43 has shape : (200, 17, 384), with range scale (1.0282957553863525,-0.8850383758544922) 
source_data subject_idx 44 has shape : (200, 17, 384), with range scale (0.8763719201087952,-0.873806357383728) 
source_data subject_idx 45 has shape : (200, 17, 384), with range scale (0.9527843594551086,-0.8911209106445312) 
source_data subject_idx 46 has shape : (200, 17, 384), with range scale (1.6098185777664185,-1.765346884727478) 
source_data subject_idx 47 has shape : (200, 17, 384), with range scale (1.397952675819397,-1.5371551513671875) 
source_data subject_idx 48 has shape : (200, 17, 384), with range scale (1.0645549297332764,-0.7614633440971375) 
source dataset idx :  1
run custom EA
generate new r_op
source_data subject_idx 0 has shape : (92, 17, 384), with range scale (0.6635822653770447,-0.6450462341308594) 
source_data subject_idx 1 has shape : (89, 17, 384), with range scale (0.6527177095413208,-0.8556455373764038) 
source_data subject_idx 2 has shape : (92, 17, 384), with range scale (0.9350364804267883,-0.9835978746414185) 
source_data subject_idx 3 has shape : (91, 17, 384), with range scale (0.6761916279792786,-0.892231285572052) 
source_data subject_idx 4 has shape : (88, 17, 384), with range scale (0.8706837296485901,-1.0782322883605957) 
source_data subject_idx 5 has shape : (92, 17, 384), with range scale (0.9342394471168518,-0.834481418132782) 
source_data subject_idx 6 has shape : (91, 17, 384), with range scale (0.4325883090496063,-0.5748054385185242) 
source_data subject_idx 7 has shape : (89, 17, 384), with range scale (1.3702843189239502,-1.167189598083496) 
source_data subject_idx 8 has shape : (91, 17, 384), with range scale (0.5027489066123962,-0.45364537835121155) 
source_data subject_idx 9 has shape : (91, 17, 384), with range scale (0.3971041440963745,-0.511340320110321) 
source_data subject_idx 10 has shape : (91, 17, 384), with range scale (1.2434769868850708,-1.2928123474121094) 
source_data subject_idx 11 has shape : (89, 17, 384), with range scale (1.0204869508743286,-1.1365001201629639) 
source_data subject_idx 12 has shape : (91, 17, 384), with range scale (0.6192032098770142,-0.6019769310951233) 
source_data subject_idx 13 has shape : (88, 17, 384), with range scale (0.3086931109428406,-0.40464091300964355) 
source_data subject_idx 14 has shape : (91, 17, 384), with range scale (0.44820329546928406,-0.49501609802246094) 
source_data subject_idx 15 has shape : (88, 17, 384), with range scale (0.46991586685180664,-0.5845204591751099) 
source_data subject_idx 16 has shape : (89, 17, 384), with range scale (0.8641892075538635,-1.2129716873168945) 
source_data subject_idx 17 has shape : (90, 17, 384), with range scale (0.4410848617553711,-0.3699715733528137) 
source_data subject_idx 18 has shape : (91, 17, 384), with range scale (0.47157102823257446,-0.4453599154949188) 
source_data subject_idx 19 has shape : (90, 17, 384), with range scale (0.534877359867096,-0.5651514530181885) 
source_data subject_idx 20 has shape : (90, 17, 384), with range scale (0.39198678731918335,-0.489992618560791) 
source_data subject_idx 21 has shape : (91, 17, 384), with range scale (0.61040198802948,-0.8814409375190735) 
source_data subject_idx 22 has shape : (89, 17, 384), with range scale (0.7364908456802368,-0.901198148727417) 
source_data subject_idx 23 has shape : (90, 17, 384), with range scale (0.6853683590888977,-0.7968631386756897) 
source_data subject_idx 24 has shape : (88, 17, 384), with range scale (0.93064284324646,-1.1263375282287598) 
source_data subject_idx 25 has shape : (93, 17, 384), with range scale (0.9077349901199341,-0.8342688083648682) 
source_data subject_idx 26 has shape : (91, 17, 384), with range scale (1.2297872304916382,-1.2567424774169922) 
source_data subject_idx 27 has shape : (89, 17, 384), with range scale (0.6552313566207886,-0.8012681603431702) 
source_data subject_idx 28 has shape : (91, 17, 384), with range scale (0.8271992206573486,-0.784073531627655) 
source_data subject_idx 29 has shape : (90, 17, 384), with range scale (2.0755653381347656,-1.7833671569824219) 
source_data subject_idx 30 has shape : (89, 17, 384), with range scale (0.4152286648750305,-0.6024753451347351) 
source_data subject_idx 31 has shape : (89, 17, 384), with range scale (1.1088554859161377,-1.1350764036178589) 
source_data subject_idx 32 has shape : (91, 17, 384), with range scale (0.4496297240257263,-0.4981136918067932) 
source_data subject_idx 33 has shape : (89, 17, 384), with range scale (0.8972886204719543,-0.8705561757087708) 
source_data subject_idx 34 has shape : (88, 17, 384), with range scale (0.9323359131813049,-0.8804383277893066) 
source_data subject_idx 35 has shape : (91, 17, 384), with range scale (0.9958591461181641,-1.0287989377975464) 
source_data subject_idx 36 has shape : (91, 17, 384), with range scale (0.6097190380096436,-0.6170302629470825) 
source_data subject_idx 37 has shape : (90, 17, 384), with range scale (0.4325774013996124,-0.37416771054267883) 
source_data subject_idx 38 has shape : (90, 17, 384), with range scale (0.4709510803222656,-0.3654654920101166) 
source_data subject_idx 39 has shape : (89, 17, 384), with range scale (0.8825229406356812,-1.476203441619873) 
source_data subject_idx 40 has shape : (91, 17, 384), with range scale (0.5058969855308533,-0.49067941308021545) 
source_data subject_idx 41 has shape : (88, 17, 384), with range scale (0.9766131639480591,-0.6556596755981445) 
source_data subject_idx 42 has shape : (90, 17, 384), with range scale (0.9502836465835571,-1.0015034675598145) 
source_data subject_idx 43 has shape : (89, 17, 384), with range scale (0.4527646601200104,-0.4087400734424591) 
source_data subject_idx 44 has shape : (89, 17, 384), with range scale (0.8421286344528198,-1.0863838195800781) 
source_data subject_idx 45 has shape : (91, 17, 384), with range scale (0.7677578330039978,-0.7578632235527039) 
source_data subject_idx 46 has shape : (91, 17, 384), with range scale (0.5478517413139343,-0.6169934868812561) 
source_data subject_idx 47 has shape : (88, 17, 384), with range scale (0.5600345730781555,-0.6607357859611511) 
source_data subject_idx 48 has shape : (92, 17, 384), with range scale (0.6931192874908447,-0.6391355395317078) 
source_data subject_idx 49 has shape : (89, 17, 384), with range scale (0.7659339904785156,-1.0686750411987305) 
source_data subject_idx 50 has shape : (93, 17, 384), with range scale (1.1803903579711914,-1.3481924533843994) 
source_data subject_idx 51 has shape : (92, 17, 384), with range scale (0.5909032821655273,-0.6613151431083679) 
source_data subject_idx 52 has shape : (89, 17, 384), with range scale (0.9489699006080627,-0.8693708181381226) 
source_data subject_idx 53 has shape : (90, 17, 384), with range scale (0.7868562936782837,-0.8488566279411316) 
source_data subject_idx 54 has shape : (90, 17, 384), with range scale (0.4624077379703522,-0.3843694031238556) 
source_data subject_idx 55 has shape : (89, 17, 384), with range scale (0.855067253112793,-0.7476500868797302) 
source_data subject_idx 56 has shape : (92, 17, 384), with range scale (1.451259970664978,-0.8775184750556946) 
source_data subject_idx 57 has shape : (91, 17, 384), with range scale (0.7655401229858398,-0.913463294506073) 
source_data subject_idx 58 has shape : (92, 17, 384), with range scale (1.8924585580825806,-0.7973564267158508) 
source_data subject_idx 59 has shape : (92, 17, 384), with range scale (0.503272294998169,-0.5399895310401917) 
source_data subject_idx 60 has shape : (88, 17, 384), with range scale (0.8019402623176575,-0.75787752866745) 
source_data subject_idx 61 has shape : (90, 17, 384), with range scale (0.4405616819858551,-0.5884069800376892) 
source_data subject_idx 62 has shape : (90, 17, 384), with range scale (2.480820655822754,-1.1794875860214233) 
source_data subject_idx 63 has shape : (91, 17, 384), with range scale (0.5555720329284668,-0.609916627407074) 
source_data subject_idx 64 has shape : (92, 17, 384), with range scale (0.7050769329071045,-0.7183904051780701) 
source_data subject_idx 65 has shape : (90, 17, 384), with range scale (1.1813173294067383,-1.4158159494400024) 
source_data subject_idx 66 has shape : (89, 17, 384), with range scale (1.169793963432312,-1.162235975265503) 
source_data subject_idx 67 has shape : (90, 17, 384), with range scale (0.6568388938903809,-0.5140275955200195) 
source_data subject_idx 68 has shape : (92, 17, 384), with range scale (0.4186505973339081,-0.5416693091392517) 
source_data subject_idx 69 has shape : (89, 17, 384), with range scale (0.9091640710830688,-0.8549709916114807) 
source_data subject_idx 70 has shape : (89, 17, 384), with range scale (1.1580862998962402,-1.0784372091293335) 
source_data subject_idx 71 has shape : (90, 17, 384), with range scale (0.8840420246124268,-0.9830904006958008) 
source_data subject_idx 72 has shape : (90, 17, 384), with range scale (0.5972389578819275,-0.4964401125907898) 
source_data subject_idx 73 has shape : (91, 17, 384), with range scale (0.7535731196403503,-0.7292771339416504) 
source_data subject_idx 74 has shape : (91, 17, 384), with range scale (0.73072350025177,-0.7904592752456665) 
source_data subject_idx 75 has shape : (90, 17, 384), with range scale (0.3187751770019531,-0.355183482170105) 
source_data subject_idx 76 has shape : (89, 17, 384), with range scale (0.7476410865783691,-0.653012216091156) 
source_data subject_idx 77 has shape : (91, 17, 384), with range scale (1.4965280294418335,-1.3019781112670898) 
source_data subject_idx 78 has shape : (91, 17, 384), with range scale (0.6563048958778381,-0.5579637289047241) 
source_data subject_idx 79 has shape : (89, 17, 384), with range scale (1.6257643699645996,-1.1466976404190063) 
source_data subject_idx 80 has shape : (90, 17, 384), with range scale (1.017038106918335,-1.1585050821304321) 
source_data subject_idx 81 has shape : (89, 17, 384), with range scale (0.5660838484764099,-0.8437317609786987) 
source_data subject_idx 82 has shape : (90, 17, 384), with range scale (0.900054395198822,-0.9659441709518433) 
source_data subject_idx 83 has shape : (91, 17, 384), with range scale (0.9371195435523987,-1.356507658958435) 
source_data subject_idx 84 has shape : (90, 17, 384), with range scale (0.6579915881156921,-0.4786575436592102) 
source_data subject_idx 85 has shape : (91, 17, 384), with range scale (1.1371746063232422,-1.2223700284957886) 
source_data subject_idx 86 has shape : (89, 17, 384), with range scale (0.7439618110656738,-0.624003529548645) 
source_data subject_idx 87 has shape : (114, 17, 384), with range scale (0.42124319076538086,-0.4062422811985016) 
source_data subject_idx 88 has shape : (90, 17, 384), with range scale (0.8885942101478577,-0.9470054507255554) 
source_data subject_idx 89 has shape : (90, 17, 384), with range scale (0.7889284491539001,-0.8844084739685059) 
source_data subject_idx 90 has shape : (90, 17, 384), with range scale (0.7539210319519043,-0.6837416887283325) 
source_data subject_idx 91 has shape : (111, 17, 384), with range scale (0.4892567992210388,-0.5099184513092041) 
source_data subject_idx 92 has shape : (90, 17, 384), with range scale (0.4826072156429291,-0.36527764797210693) 
source_data subject_idx 93 has shape : (90, 17, 384), with range scale (0.9776809215545654,-0.6807703971862793) 
source_data subject_idx 94 has shape : (91, 17, 384), with range scale (0.946986973285675,-1.0356836318969727) 
source_data subject_idx 95 has shape : (92, 17, 384), with range scale (0.8312045335769653,-0.8184489607810974) 
source_data subject_idx 96 has shape : (90, 17, 384), with range scale (0.6298197507858276,-1.0925219058990479) 
source_data subject_idx 97 has shape : (92, 17, 384), with range scale (0.4181371331214905,-0.508488655090332) 
source_data subject_idx 98 has shape : (91, 17, 384), with range scale (1.233091115951538,-1.2026557922363281) 
source_data subject_idx 99 has shape : (72, 17, 384), with range scale (0.770717978477478,-0.6864450573921204) 
source_data subject_idx 100 has shape : (88, 17, 384), with range scale (0.3383553624153137,-0.3229562044143677) 
source_data subject_idx 101 has shape : (89, 17, 384), with range scale (1.214106559753418,-1.1739592552185059) 
source_data subject_idx 102 has shape : (90, 17, 384), with range scale (0.7657291889190674,-0.8259928226470947) 
source_data subject_idx 103 has shape : (88, 17, 384), with range scale (0.45258983969688416,-0.6623888611793518) 
source_data subject_idx 104 has shape : (89, 17, 384), with range scale (0.6345487833023071,-0.48687201738357544) 
source_data subject_idx 105 has shape : (91, 17, 384), with range scale (0.5918318033218384,-0.5974709987640381) 
source_data subject_idx 106 has shape : (92, 17, 384), with range scale (0.7309435606002808,-0.9357020258903503) 
source_data subject_idx 107 has shape : (90, 17, 384), with range scale (0.6797388195991516,-0.760359525680542) 
source_data subject_idx 108 has shape : (90, 17, 384), with range scale (1.105279803276062,-1.2459110021591187) 
source dataset idx :  2
run custom EA
generate new r_op
source_data subject_idx 0 has shape : (576, 17, 384), with range scale (0.7720328569412231,-1.0032285451889038) 
source_data subject_idx 1 has shape : (576, 17, 384), with range scale (0.7470634579658508,-0.7756261825561523) 
source_data subject_idx 2 has shape : (576, 17, 384), with range scale (1.122564435005188,-1.5645434856414795) 
source_data subject_idx 3 has shape : (576, 17, 384), with range scale (0.7821568250656128,-0.958053469657898) 
source_data subject_idx 4 has shape : (576, 17, 384), with range scale (1.39310622215271,-1.5814940929412842) 
source_data subject_idx 5 has shape : (576, 17, 384), with range scale (1.129255771636963,-1.0122603178024292) 
source_data subject_idx 6 has shape : (576, 17, 384), with range scale (0.4136982262134552,-0.45542657375335693) 
source_data subject_idx 7 has shape : (576, 17, 384), with range scale (1.1008994579315186,-1.0081154108047485) 
source_data subject_idx 8 has shape : (576, 17, 384), with range scale (0.6211870908737183,-0.6390889286994934) 
only use r-op for subjects [0]
use exist r_op
unlabel data subject_idx 0 has shape : (200, 17, 384), with range scale (1.599064826965332,-1.3868545293807983) 
Loading trainer: MultiDatasetMCDV1
Params :  FREEZE: False
NAME: deepsleep
PARAMS:
  F1: 8
  F2: 8
  avg_pool_1: 4
  avg_pool_2: 8
  drop_prob: 0.25
  kern_length_1: 64
  kern_length_2: 16
  num_ch: 17
  samples: 384
PRETRAINED: False
PRETRAINED_PATH: 
Building F
Building CommonFeature
Backbone: deepsleep
params set up :  {'kern_length_1': 64, 'kern_length_2': 16, 'num_ch': 17, 'samples': 384, 'F1': 8, 'F2': 8, 'drop_prob': 0.25, 'avg_pool_1': 4, 'avg_pool_2': 8}
pretrain :  False
pretrain path : 
Building Target Classifier
use max norm constraint on last FC
use max norm constraint on last FC
Building SourceClassifiers
source domains label size :  [2, 4, 4]
use max norm constraint on last FC
use max norm constraint on last FC
use max norm constraint on last FC
there is n_step_F :  5
save checkpoint keys :  dict_keys(['epoch', 'global_step', 'pytorch-lightning_version', 'state_dict', 'callbacks', 'optimizer_states', 'lr_schedulers'])
size of test loader :  1
Testing: 0it [00:00, ?it/s]in test epoch end
Testing: 100%|##########| 1/1 [00:00<00:00, 118.87it/s]
--------------------------------------------------------------------------------
DATALOADER:0 TEST RESULTS
{'class_0_acc': 0.6000000238418579,
 'class_1_acc': 0.7142857313156128,
 'class_2_acc': 0.5,
 'class_3_acc': 1.0,
 'test_F1': 0.6604166626930237,
 'test_acc': 0.6499999761581421,
 'test_classes_avg_acc': 0.7035714387893677,
 'test_loss': 3.3137340545654297}
--------------------------------------------------------------------------------
test result :  {'test_acc': 0.6499999761581421, 'test_loss': 3.3137340545654297, 'test_F1': 0.6604166626930237, 'test_classes_avg_acc': 0.7035714387893677, 'class_0_acc': 0.6000000238418579, 'class_1_acc': 0.7142857313156128, 'class_2_acc': 0.5, 'class_3_acc': 1.0}
current result before convert excel :  [{'test_acc': 0.3499999940395355, 'test_loss': 3.5737314224243164, 'test_F1': 0.3561508059501648, 'test_classes_avg_acc': 0.4055555462837219, 'class_0_acc': 0.3333333432674408, 'class_1_acc': 0.6666666865348816, 'class_2_acc': 0.4000000059604645, 'class_3_acc': 0.2222222238779068, 'increment_fold': 'increment_fold_1', 'test_fold': 'test_fold_1', 'valid_fold': 'valid_fold_1', 'epoch': 10}, {'test_acc': 0.4000000059604645, 'test_loss': 5.058084964752197, 'test_F1': 0.4000000059604645, 'test_classes_avg_acc': 0.4749999940395355, 'class_0_acc': 0.25, 'class_1_acc': 1.0, 'class_2_acc': 0.4000000059604645, 'class_3_acc': 0.25, 'increment_fold': 'increment_fold_1', 'test_fold': 'test_fold_1', 'valid_fold': 'valid_fold_2', 'epoch': 10}, {'test_acc': 0.5, 'test_loss': 4.573701858520508, 'test_F1': 0.420634925365448, 'test_classes_avg_acc': 0.46785715222358704, 'class_0_acc': 0.5714285969734192, 'class_1_acc': 0.800000011920929, 'class_2_acc': 0.0, 'class_3_acc': 0.5, 'increment_fold': 'increment_fold_1', 'test_fold': 'test_fold_1', 'valid_fold': 'valid_fold_3', 'epoch': 10}, {'test_acc': 0.6000000238418579, 'test_loss': 3.581035852432251, 'test_F1': 0.4696969985961914, 'test_classes_avg_acc': 0.4952380955219269, 'class_0_acc': 0.6666666865348816, 'class_1_acc': 0.7142857313156128, 'class_2_acc': 0.6000000238418579, 'class_3_acc': 0.0, 'increment_fold': 'increment_fold_1', 'test_fold': 'test_fold_1', 'valid_fold': 'valid_fold_4', 'epoch': 9}, {'test_acc': 0.6499999761581421, 'test_loss': 3.3137340545654297, 'test_F1': 0.6604166626930237, 'test_classes_avg_acc': 0.7035714387893677, 'class_0_acc': 0.6000000238418579, 'class_1_acc': 0.7142857313156128, 'class_2_acc': 0.5, 'class_3_acc': 1.0, 'increment_fold': 'increment_fold_1', 'test_fold': 'test_fold_1', 'valid_fold': 'valid_fold_5', 'epoch': 9}]
