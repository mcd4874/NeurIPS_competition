use determinstic 
use cross channel norm :  none
generate predict :  True
load test data from file /data1/wduong_experiment_data/EEG_Dassl_Lightning/da_dataset/NeurIPS_competition/final_MI_test_B_1/dataset_B_0/NeurIPS_TL.mat
current r_op file :  /data1/wduong_experiment_data/EEG_Dassl_Lightning/da_dataset/NeurIPS_competition/final_MI_test_B_1/dataset_B_0/dataset_B_0_r_op.mat
path /data1/wduong_experiment_data/EEG_Dassl_Lightning/da_dataset/NeurIPS_competition/final_MI_test_B_1/dataset_B_0/dataset_B_0_r_op.mat exist 
use the r-op list
use r_op
use exist r_op
load test predict data ------------------
current dataset dataset_B_0
source_data subject_idx 0 has shape : (200, 17, 384), with range scale (0.5421113967895508,-0.6338673233985901) 
data shape before predict :  (200, 1, 17, 384)
use data manager for domain adaptation
Loading dataset: MultiDataset
data root :  /data1/wduong_experiment_data/EEG_Dassl_Lightning/da_dataset/NeurIPS_competition
dataset dir :  final_MI_B_1
file name :  dataset_B_0/NeurIPS_TL.mat
r_op file path :  /data1/wduong_experiment_data/EEG_Dassl_Lightning/da_dataset/NeurIPS_competition/final_MI_B_1/dataset_B_0/dataset_B_0_r_op.mat

there is test file 
run custom EA
only use r-op for subjects [0]
only use r-op for subjects [0]
only use r-op for subjects [0]
use exist r_op
use exist r_op
use exist r_op
train subjects :  [0]
Train subject 0 has shape : (96, 1, 17, 384), with range scale (0.8502951264381409,-0.833778977394104) 
test subjects :  [0]
test subject 0 has shape : (24, 1, 17, 384), with range scale (0.9934844374656677,-0.9528900980949402)  
valid subjects :  [0]
valid subject 0 has shape : (24, 1, 17, 384), with range scale (0.9934844374656677,-0.9528900980949402)  
the labels ratio of whole dataset : [3.6923076923076925, 4.0, 4.173913043478261, 4.173913043478261]
source dataset idx :  0
run custom EA
generate new r_op
source_data subject_idx 0 has shape : (200, 17, 384), with range scale (2.8882222175598145,-3.0118398666381836) 
source_data subject_idx 1 has shape : (200, 17, 384), with range scale (2.012194871902466,-1.471892237663269) 
source_data subject_idx 2 has shape : (200, 17, 384), with range scale (0.39883995056152344,-0.47107645869255066) 
source_data subject_idx 3 has shape : (200, 17, 384), with range scale (0.633466899394989,-0.8988378643989563) 
source_data subject_idx 4 has shape : (200, 17, 384), with range scale (1.3011571168899536,-1.2901395559310913) 
source_data subject_idx 5 has shape : (200, 17, 384), with range scale (0.6116749048233032,-0.5340460538864136) 
source_data subject_idx 6 has shape : (240, 17, 384), with range scale (1.6593918800354004,-1.945071816444397) 
source_data subject_idx 7 has shape : (200, 17, 384), with range scale (0.52070552110672,-0.6748800277709961) 
source_data subject_idx 8 has shape : (240, 17, 384), with range scale (0.9757770895957947,-0.611278235912323) 
source_data subject_idx 9 has shape : (200, 17, 384), with range scale (0.7230930924415588,-0.6379406452178955) 
source_data subject_idx 10 has shape : (200, 17, 384), with range scale (2.196751594543457,-2.3680875301361084) 
source_data subject_idx 11 has shape : (200, 17, 384), with range scale (0.5474781394004822,-0.4567890167236328) 
source_data subject_idx 12 has shape : (200, 17, 384), with range scale (0.34184280037879944,-0.3546203076839447) 
source_data subject_idx 13 has shape : (200, 17, 384), with range scale (0.4874683618545532,-0.5128428936004639) 
source_data subject_idx 14 has shape : (200, 17, 384), with range scale (0.6301130056381226,-0.5653321743011475) 
source_data subject_idx 15 has shape : (200, 17, 384), with range scale (0.843874990940094,-0.9753001928329468) 
source_data subject_idx 16 has shape : (200, 17, 384), with range scale (0.6573670506477356,-0.6639305353164673) 
source_data subject_idx 17 has shape : (200, 17, 384), with range scale (1.275315761566162,-1.3497552871704102) 
source_data subject_idx 18 has shape : (200, 17, 384), with range scale (1.5794085264205933,-1.4551502466201782) 
source_data subject_idx 19 has shape : (200, 17, 384), with range scale (0.5881903171539307,-0.5797205567359924) 
source_data subject_idx 20 has shape : (200, 17, 384), with range scale (1.0885236263275146,-0.7935687303543091) 
source_data subject_idx 21 has shape : (200, 17, 384), with range scale (1.9916812181472778,-1.3703601360321045) 
source_data subject_idx 22 has shape : (200, 17, 384), with range scale (1.3182650804519653,-1.0296597480773926) 
source_data subject_idx 23 has shape : (200, 17, 384), with range scale (0.9592158198356628,-0.9697363376617432) 
source_data subject_idx 24 has shape : (200, 17, 384), with range scale (1.1470407247543335,-1.1388038396835327) 
source_data subject_idx 25 has shape : (200, 17, 384), with range scale (2.2241201400756836,-2.4356601238250732) 
source_data subject_idx 26 has shape : (200, 17, 384), with range scale (1.592162847518921,-1.2840940952301025) 
source_data subject_idx 27 has shape : (200, 17, 384), with range scale (1.3226505517959595,-1.0074076652526855) 
source_data subject_idx 28 has shape : (200, 17, 384), with range scale (1.7132503986358643,-1.5864579677581787) 
source_data subject_idx 29 has shape : (200, 17, 384), with range scale (0.5230404138565063,-0.6324833035469055) 
source_data subject_idx 30 has shape : (200, 17, 384), with range scale (0.49305006861686707,-0.4982423782348633) 
source_data subject_idx 31 has shape : (200, 17, 384), with range scale (0.588959276676178,-0.8800286650657654) 
source_data subject_idx 32 has shape : (200, 17, 384), with range scale (0.7126017808914185,-0.9526523351669312) 
source_data subject_idx 33 has shape : (200, 17, 384), with range scale (2.3252944946289062,-2.73030161857605) 
source_data subject_idx 34 has shape : (200, 17, 384), with range scale (2.032393217086792,-2.653068780899048) 
source_data subject_idx 35 has shape : (200, 17, 384), with range scale (2.496364116668701,-2.437655448913574) 
source_data subject_idx 36 has shape : (200, 17, 384), with range scale (1.0227330923080444,-0.7400245666503906) 
source_data subject_idx 37 has shape : (200, 17, 384), with range scale (0.5067989230155945,-0.5049859285354614) 
source_data subject_idx 38 has shape : (200, 17, 384), with range scale (1.0809292793273926,-1.2355200052261353) 
source_data subject_idx 39 has shape : (200, 17, 384), with range scale (0.7384615540504456,-0.7018154859542847) 
source_data subject_idx 40 has shape : (200, 17, 384), with range scale (1.3897559642791748,-1.1106163263320923) 
source_data subject_idx 41 has shape : (200, 17, 384), with range scale (0.47946929931640625,-0.5571277737617493) 
source_data subject_idx 42 has shape : (200, 17, 384), with range scale (1.4097098112106323,-1.0699217319488525) 
source_data subject_idx 43 has shape : (200, 17, 384), with range scale (1.3387291431427002,-1.1521470546722412) 
source_data subject_idx 44 has shape : (200, 17, 384), with range scale (0.8694338798522949,-0.8605979084968567) 
source_data subject_idx 45 has shape : (200, 17, 384), with range scale (0.9423102140426636,-0.885471522808075) 
source_data subject_idx 46 has shape : (200, 17, 384), with range scale (1.4963183403015137,-1.6483010053634644) 
source_data subject_idx 47 has shape : (200, 17, 384), with range scale (1.4078161716461182,-1.5489822626113892) 
source_data subject_idx 48 has shape : (200, 17, 384), with range scale (1.2182726860046387,-0.811068594455719) 
source dataset idx :  1
run custom EA
generate new r_op
source_data subject_idx 0 has shape : (92, 17, 384), with range scale (0.7169162034988403,-0.6664949655532837) 
source_data subject_idx 1 has shape : (89, 17, 384), with range scale (0.7367219924926758,-0.9459208250045776) 
source_data subject_idx 2 has shape : (92, 17, 384), with range scale (0.9302616119384766,-0.9795837998390198) 
source_data subject_idx 3 has shape : (91, 17, 384), with range scale (0.691114604473114,-0.7401592135429382) 
source_data subject_idx 4 has shape : (88, 17, 384), with range scale (0.9459317922592163,-1.1025806665420532) 
source_data subject_idx 5 has shape : (92, 17, 384), with range scale (0.8528969287872314,-1.0217312574386597) 
source_data subject_idx 6 has shape : (91, 17, 384), with range scale (0.5388573408126831,-0.5337445735931396) 
source_data subject_idx 7 has shape : (89, 17, 384), with range scale (1.4369562864303589,-1.223192811012268) 
source_data subject_idx 8 has shape : (91, 17, 384), with range scale (0.4977075457572937,-0.4644436240196228) 
source_data subject_idx 9 has shape : (91, 17, 384), with range scale (0.42410993576049805,-0.552099883556366) 
source_data subject_idx 10 has shape : (91, 17, 384), with range scale (1.1383635997772217,-1.4176443815231323) 
source_data subject_idx 11 has shape : (89, 17, 384), with range scale (1.0658844709396362,-0.8994742631912231) 
source_data subject_idx 12 has shape : (91, 17, 384), with range scale (0.6188948750495911,-0.6889960765838623) 
source_data subject_idx 13 has shape : (88, 17, 384), with range scale (0.3236307203769684,-0.4282187223434448) 
source_data subject_idx 14 has shape : (91, 17, 384), with range scale (0.41625848412513733,-0.5230375528335571) 
source_data subject_idx 15 has shape : (88, 17, 384), with range scale (0.4929223954677582,-0.5623812675476074) 
source_data subject_idx 16 has shape : (89, 17, 384), with range scale (0.88502037525177,-1.196359634399414) 
source_data subject_idx 17 has shape : (90, 17, 384), with range scale (0.46859344840049744,-0.48558470606803894) 
source_data subject_idx 18 has shape : (91, 17, 384), with range scale (0.4752838909626007,-0.45331206917762756) 
source_data subject_idx 19 has shape : (90, 17, 384), with range scale (0.6349341869354248,-0.7902240753173828) 
source_data subject_idx 20 has shape : (90, 17, 384), with range scale (0.4959060847759247,-0.5121389627456665) 
source_data subject_idx 21 has shape : (91, 17, 384), with range scale (0.6096289753913879,-0.7651546597480774) 
source_data subject_idx 22 has shape : (89, 17, 384), with range scale (0.8464249968528748,-0.8947135210037231) 
source_data subject_idx 23 has shape : (90, 17, 384), with range scale (0.7144237160682678,-0.8370522260665894) 
source_data subject_idx 24 has shape : (88, 17, 384), with range scale (0.9057577848434448,-1.0708329677581787) 
source_data subject_idx 25 has shape : (93, 17, 384), with range scale (0.7831981778144836,-0.7814754247665405) 
source_data subject_idx 26 has shape : (91, 17, 384), with range scale (1.2667361497879028,-1.2867064476013184) 
source_data subject_idx 27 has shape : (89, 17, 384), with range scale (0.715073823928833,-0.8704080581665039) 
source_data subject_idx 28 has shape : (91, 17, 384), with range scale (0.823622465133667,-0.7710578441619873) 
source_data subject_idx 29 has shape : (90, 17, 384), with range scale (1.7067055702209473,-1.362501621246338) 
source_data subject_idx 30 has shape : (89, 17, 384), with range scale (0.42109474539756775,-0.5971027612686157) 
source_data subject_idx 31 has shape : (89, 17, 384), with range scale (1.1272733211517334,-0.9254766702651978) 
source_data subject_idx 32 has shape : (91, 17, 384), with range scale (0.4515339732170105,-0.49986064434051514) 
source_data subject_idx 33 has shape : (89, 17, 384), with range scale (0.8349516987800598,-0.8060201406478882) 
source_data subject_idx 34 has shape : (88, 17, 384), with range scale (0.5930517911911011,-0.667640209197998) 
source_data subject_idx 35 has shape : (91, 17, 384), with range scale (1.008338451385498,-1.0509880781173706) 
source_data subject_idx 36 has shape : (91, 17, 384), with range scale (0.593373715877533,-0.5770897269248962) 
source_data subject_idx 37 has shape : (90, 17, 384), with range scale (0.3337509334087372,-0.3894091546535492) 
source_data subject_idx 38 has shape : (90, 17, 384), with range scale (0.5131454467773438,-0.39244702458381653) 
source_data subject_idx 39 has shape : (89, 17, 384), with range scale (0.8909652233123779,-1.5867822170257568) 
source_data subject_idx 40 has shape : (91, 17, 384), with range scale (0.6203176379203796,-0.5695602893829346) 
source_data subject_idx 41 has shape : (88, 17, 384), with range scale (0.9914578795433044,-0.6623650789260864) 
source_data subject_idx 42 has shape : (90, 17, 384), with range scale (1.3082313537597656,-1.2687772512435913) 
source_data subject_idx 43 has shape : (89, 17, 384), with range scale (0.39732423424720764,-0.4900325536727905) 
source_data subject_idx 44 has shape : (89, 17, 384), with range scale (0.8021134734153748,-1.0494554042816162) 
source_data subject_idx 45 has shape : (91, 17, 384), with range scale (0.6604734063148499,-0.5932362079620361) 
source_data subject_idx 46 has shape : (91, 17, 384), with range scale (0.5637867450714111,-0.6177029609680176) 
source_data subject_idx 47 has shape : (88, 17, 384), with range scale (0.6126500964164734,-0.6881211400032043) 
source_data subject_idx 48 has shape : (92, 17, 384), with range scale (0.9746087789535522,-0.9049380421638489) 
source_data subject_idx 49 has shape : (89, 17, 384), with range scale (0.7907715439796448,-1.0917167663574219) 
source_data subject_idx 50 has shape : (93, 17, 384), with range scale (1.0379266738891602,-1.188753366470337) 
source_data subject_idx 51 has shape : (92, 17, 384), with range scale (0.7975730895996094,-0.8419255018234253) 
source_data subject_idx 52 has shape : (89, 17, 384), with range scale (0.9716087579727173,-0.8925856351852417) 
source_data subject_idx 53 has shape : (90, 17, 384), with range scale (0.7912880182266235,-0.8501782417297363) 
source_data subject_idx 54 has shape : (90, 17, 384), with range scale (0.4885285794734955,-0.3597244322299957) 
source_data subject_idx 55 has shape : (89, 17, 384), with range scale (0.9037812352180481,-0.7423575520515442) 
source_data subject_idx 56 has shape : (92, 17, 384), with range scale (1.4165902137756348,-0.8528302907943726) 
source_data subject_idx 57 has shape : (91, 17, 384), with range scale (0.8686171770095825,-1.0360792875289917) 
source_data subject_idx 58 has shape : (92, 17, 384), with range scale (1.8695253133773804,-0.7935270071029663) 
source_data subject_idx 59 has shape : (92, 17, 384), with range scale (0.5022420287132263,-0.5183480978012085) 
source_data subject_idx 60 has shape : (88, 17, 384), with range scale (0.8774799704551697,-0.8143843412399292) 
source_data subject_idx 61 has shape : (90, 17, 384), with range scale (0.4195600748062134,-0.5917611122131348) 
source_data subject_idx 62 has shape : (90, 17, 384), with range scale (2.23943829536438,-1.4211475849151611) 
source_data subject_idx 63 has shape : (91, 17, 384), with range scale (0.5610853433609009,-0.5430169701576233) 
source_data subject_idx 64 has shape : (92, 17, 384), with range scale (0.6622500419616699,-0.6672776341438293) 
source_data subject_idx 65 has shape : (90, 17, 384), with range scale (1.1588901281356812,-1.3947761058807373) 
source_data subject_idx 66 has shape : (89, 17, 384), with range scale (1.156064748764038,-1.1673425436019897) 
source_data subject_idx 67 has shape : (90, 17, 384), with range scale (0.7678646445274353,-0.5782241821289062) 
source_data subject_idx 68 has shape : (92, 17, 384), with range scale (0.4321843385696411,-0.5818220376968384) 
source_data subject_idx 69 has shape : (89, 17, 384), with range scale (1.0627270936965942,-1.1566270589828491) 
source_data subject_idx 70 has shape : (89, 17, 384), with range scale (1.0456321239471436,-0.9711074829101562) 
source_data subject_idx 71 has shape : (90, 17, 384), with range scale (1.066978096961975,-1.185381531715393) 
source_data subject_idx 72 has shape : (90, 17, 384), with range scale (0.5864176154136658,-0.5077543258666992) 
source_data subject_idx 73 has shape : (91, 17, 384), with range scale (0.6305578947067261,-0.7793805003166199) 
source_data subject_idx 74 has shape : (91, 17, 384), with range scale (0.6688997149467468,-0.7725189328193665) 
source_data subject_idx 75 has shape : (90, 17, 384), with range scale (0.3052671551704407,-0.37482795119285583) 
source_data subject_idx 76 has shape : (89, 17, 384), with range scale (0.7272578477859497,-0.6320812106132507) 
source_data subject_idx 77 has shape : (91, 17, 384), with range scale (1.5900516510009766,-1.3911101818084717) 
source_data subject_idx 78 has shape : (91, 17, 384), with range scale (0.6965444087982178,-0.5931110382080078) 
source_data subject_idx 79 has shape : (89, 17, 384), with range scale (1.467740535736084,-1.0494499206542969) 
source_data subject_idx 80 has shape : (90, 17, 384), with range scale (0.9545451402664185,-1.0810126066207886) 
source_data subject_idx 81 has shape : (89, 17, 384), with range scale (0.6345996260643005,-0.7612450122833252) 
source_data subject_idx 82 has shape : (90, 17, 384), with range scale (0.8933464884757996,-0.9619231820106506) 
source_data subject_idx 83 has shape : (91, 17, 384), with range scale (0.8108646869659424,-1.161116123199463) 
source_data subject_idx 84 has shape : (90, 17, 384), with range scale (0.6444645524024963,-0.5144601464271545) 
source_data subject_idx 85 has shape : (91, 17, 384), with range scale (1.1594910621643066,-1.0914311408996582) 
source_data subject_idx 86 has shape : (89, 17, 384), with range scale (0.689849853515625,-0.5512941479682922) 
source_data subject_idx 87 has shape : (114, 17, 384), with range scale (0.4337463974952698,-0.4795781373977661) 
source_data subject_idx 88 has shape : (90, 17, 384), with range scale (0.9034557938575745,-0.9589319825172424) 
source_data subject_idx 89 has shape : (90, 17, 384), with range scale (0.8137968182563782,-0.9145379066467285) 
source_data subject_idx 90 has shape : (90, 17, 384), with range scale (0.7387031316757202,-0.7604924440383911) 
source_data subject_idx 91 has shape : (111, 17, 384), with range scale (0.5104097127914429,-0.5557769536972046) 
source_data subject_idx 92 has shape : (90, 17, 384), with range scale (0.5296695828437805,-0.39493680000305176) 
source_data subject_idx 93 has shape : (90, 17, 384), with range scale (0.9362726807594299,-0.5925340056419373) 
source_data subject_idx 94 has shape : (91, 17, 384), with range scale (0.9929652214050293,-1.108001470565796) 
source_data subject_idx 95 has shape : (92, 17, 384), with range scale (0.8198074698448181,-0.7674327492713928) 
source_data subject_idx 96 has shape : (90, 17, 384), with range scale (0.549396276473999,-0.869248628616333) 
source_data subject_idx 97 has shape : (92, 17, 384), with range scale (0.4608597755432129,-0.557570219039917) 
source_data subject_idx 98 has shape : (91, 17, 384), with range scale (1.3270875215530396,-1.2842411994934082) 
source_data subject_idx 99 has shape : (72, 17, 384), with range scale (0.6997339129447937,-0.5448974967002869) 
source_data subject_idx 100 has shape : (88, 17, 384), with range scale (0.3013438582420349,-0.33602175116539) 
source_data subject_idx 101 has shape : (89, 17, 384), with range scale (1.3008520603179932,-1.2512694597244263) 
source_data subject_idx 102 has shape : (90, 17, 384), with range scale (0.6922404766082764,-0.739229679107666) 
source_data subject_idx 103 has shape : (88, 17, 384), with range scale (0.45946475863456726,-0.6984744071960449) 
source_data subject_idx 104 has shape : (89, 17, 384), with range scale (0.5780012607574463,-0.45048871636390686) 
source_data subject_idx 105 has shape : (91, 17, 384), with range scale (0.5554128289222717,-0.614891767501831) 
source_data subject_idx 106 has shape : (92, 17, 384), with range scale (0.7811171412467957,-0.9906891584396362) 
source_data subject_idx 107 has shape : (90, 17, 384), with range scale (0.6523552536964417,-0.6484967470169067) 
source_data subject_idx 108 has shape : (90, 17, 384), with range scale (0.9993579983711243,-1.1295974254608154) 
source dataset idx :  2
run custom EA
generate new r_op
source_data subject_idx 0 has shape : (576, 17, 384), with range scale (0.716140627861023,-1.0298913717269897) 
source_data subject_idx 1 has shape : (576, 17, 384), with range scale (0.9762287735939026,-0.8352589011192322) 
source_data subject_idx 2 has shape : (576, 17, 384), with range scale (1.0710777044296265,-1.444108009338379) 
source_data subject_idx 3 has shape : (576, 17, 384), with range scale (0.9218441843986511,-1.0728968381881714) 
source_data subject_idx 4 has shape : (576, 17, 384), with range scale (1.322721004486084,-1.6325982809066772) 
source_data subject_idx 5 has shape : (576, 17, 384), with range scale (1.0932258367538452,-0.9982351660728455) 
source_data subject_idx 6 has shape : (576, 17, 384), with range scale (0.454509973526001,-0.45308664441108704) 
source_data subject_idx 7 has shape : (576, 17, 384), with range scale (1.096022129058838,-1.0179657936096191) 
source_data subject_idx 8 has shape : (576, 17, 384), with range scale (0.4593527913093567,-0.49064207077026367) 
only use r-op for subjects [0]
use exist r_op
unlabel data subject_idx 0 has shape : (200, 17, 384), with range scale (0.5421113967895508,-0.6338673233985901) 
Loading trainer: MultiDatasetMCDV1
Params :  FREEZE: False
NAME: deepsleep
PARAMS:
  F1: 8
  F2: 8
  avg_pool_1: 4
  avg_pool_2: 8
  drop_prob: 0.25
  kern_length_1: 64
  kern_length_2: 16
  num_ch: 17
  samples: 384
PRETRAINED: False
PRETRAINED_PATH: 
Building F
Building CommonFeature
Backbone: deepsleep
params set up :  {'kern_length_1': 64, 'kern_length_2': 16, 'num_ch': 17, 'samples': 384, 'F1': 8, 'F2': 8, 'drop_prob': 0.25, 'avg_pool_1': 4, 'avg_pool_2': 8}
pretrain :  False
pretrain path : 
Building Target Classifier
use max norm constraint on last FC
use max norm constraint on last FC
Building SourceClassifiers
source domains label size :  [2, 4, 4]
use max norm constraint on last FC
use max norm constraint on last FC
use max norm constraint on last FC
there is n_step_F :  5
save checkpoint keys :  dict_keys(['epoch', 'global_step', 'pytorch-lightning_version', 'state_dict', 'callbacks', 'optimizer_states', 'lr_schedulers'])
combine predict folder :  /data1/wduong_experiment_data/EEG_Dassl_Lightning//NeurIPS_competition/task_2_final_2/LA_EA/tune/1//no_aug/no_norm/deepsleep_mcdV1/dataset_B_0/model/predict_folder/increment_fold_1/test_fold_1/valid_fold_1
use data manager for domain adaptation
Loading dataset: MultiDataset
data root :  /data1/wduong_experiment_data/EEG_Dassl_Lightning/da_dataset/NeurIPS_competition
dataset dir :  final_MI_B_1
file name :  dataset_B_0/NeurIPS_TL.mat
r_op file path :  /data1/wduong_experiment_data/EEG_Dassl_Lightning/da_dataset/NeurIPS_competition/final_MI_B_1/dataset_B_0/dataset_B_0_r_op.mat

there is test file 
run custom EA
only use r-op for subjects [0]
only use r-op for subjects [0]
only use r-op for subjects [0]
use exist r_op
use exist r_op
use exist r_op
train subjects :  [0]
Train subject 0 has shape : (96, 1, 17, 384), with range scale (0.9934844374656677,-0.9528900980949402) 
test subjects :  [0]
test subject 0 has shape : (24, 1, 17, 384), with range scale (0.8502951264381409,-0.833778977394104)  
valid subjects :  [0]
valid subject 0 has shape : (24, 1, 17, 384), with range scale (0.8502951264381409,-0.833778977394104)  
the labels ratio of whole dataset : [3.6923076923076925, 4.363636363636363, 3.84, 4.173913043478261]
source dataset idx :  0
run custom EA
generate new r_op
source_data subject_idx 0 has shape : (200, 17, 384), with range scale (2.8882222175598145,-3.0118398666381836) 
source_data subject_idx 1 has shape : (200, 17, 384), with range scale (2.012194871902466,-1.471892237663269) 
source_data subject_idx 2 has shape : (200, 17, 384), with range scale (0.39883995056152344,-0.47107645869255066) 
source_data subject_idx 3 has shape : (200, 17, 384), with range scale (0.633466899394989,-0.8988378643989563) 
source_data subject_idx 4 has shape : (200, 17, 384), with range scale (1.3011571168899536,-1.2901395559310913) 
source_data subject_idx 5 has shape : (200, 17, 384), with range scale (0.6116749048233032,-0.5340460538864136) 
source_data subject_idx 6 has shape : (240, 17, 384), with range scale (1.6593918800354004,-1.945071816444397) 
source_data subject_idx 7 has shape : (200, 17, 384), with range scale (0.52070552110672,-0.6748800277709961) 
source_data subject_idx 8 has shape : (240, 17, 384), with range scale (0.9757770895957947,-0.611278235912323) 
source_data subject_idx 9 has shape : (200, 17, 384), with range scale (0.7230930924415588,-0.6379406452178955) 
source_data subject_idx 10 has shape : (200, 17, 384), with range scale (2.196751594543457,-2.3680875301361084) 
source_data subject_idx 11 has shape : (200, 17, 384), with range scale (0.5474781394004822,-0.4567890167236328) 
source_data subject_idx 12 has shape : (200, 17, 384), with range scale (0.34184280037879944,-0.3546203076839447) 
source_data subject_idx 13 has shape : (200, 17, 384), with range scale (0.4874683618545532,-0.5128428936004639) 
source_data subject_idx 14 has shape : (200, 17, 384), with range scale (0.6301130056381226,-0.5653321743011475) 
source_data subject_idx 15 has shape : (200, 17, 384), with range scale (0.843874990940094,-0.9753001928329468) 
source_data subject_idx 16 has shape : (200, 17, 384), with range scale (0.6573670506477356,-0.6639305353164673) 
source_data subject_idx 17 has shape : (200, 17, 384), with range scale (1.275315761566162,-1.3497552871704102) 
source_data subject_idx 18 has shape : (200, 17, 384), with range scale (1.5794085264205933,-1.4551502466201782) 
source_data subject_idx 19 has shape : (200, 17, 384), with range scale (0.5881903171539307,-0.5797205567359924) 
source_data subject_idx 20 has shape : (200, 17, 384), with range scale (1.0885236263275146,-0.7935687303543091) 
source_data subject_idx 21 has shape : (200, 17, 384), with range scale (1.9916812181472778,-1.3703601360321045) 
source_data subject_idx 22 has shape : (200, 17, 384), with range scale (1.3182650804519653,-1.0296597480773926) 
source_data subject_idx 23 has shape : (200, 17, 384), with range scale (0.9592158198356628,-0.9697363376617432) 
source_data subject_idx 24 has shape : (200, 17, 384), with range scale (1.1470407247543335,-1.1388038396835327) 
source_data subject_idx 25 has shape : (200, 17, 384), with range scale (2.2241201400756836,-2.4356601238250732) 
source_data subject_idx 26 has shape : (200, 17, 384), with range scale (1.592162847518921,-1.2840940952301025) 
source_data subject_idx 27 has shape : (200, 17, 384), with range scale (1.3226505517959595,-1.0074076652526855) 
source_data subject_idx 28 has shape : (200, 17, 384), with range scale (1.7132503986358643,-1.5864579677581787) 
source_data subject_idx 29 has shape : (200, 17, 384), with range scale (0.5230404138565063,-0.6324833035469055) 
source_data subject_idx 30 has shape : (200, 17, 384), with range scale (0.49305006861686707,-0.4982423782348633) 
source_data subject_idx 31 has shape : (200, 17, 384), with range scale (0.588959276676178,-0.8800286650657654) 
source_data subject_idx 32 has shape : (200, 17, 384), with range scale (0.7126017808914185,-0.9526523351669312) 
source_data subject_idx 33 has shape : (200, 17, 384), with range scale (2.3252944946289062,-2.73030161857605) 
source_data subject_idx 34 has shape : (200, 17, 384), with range scale (2.032393217086792,-2.653068780899048) 
source_data subject_idx 35 has shape : (200, 17, 384), with range scale (2.496364116668701,-2.437655448913574) 
source_data subject_idx 36 has shape : (200, 17, 384), with range scale (1.0227330923080444,-0.7400245666503906) 
source_data subject_idx 37 has shape : (200, 17, 384), with range scale (0.5067989230155945,-0.5049859285354614) 
source_data subject_idx 38 has shape : (200, 17, 384), with range scale (1.0809292793273926,-1.2355200052261353) 
source_data subject_idx 39 has shape : (200, 17, 384), with range scale (0.7384615540504456,-0.7018154859542847) 
source_data subject_idx 40 has shape : (200, 17, 384), with range scale (1.3897559642791748,-1.1106163263320923) 
source_data subject_idx 41 has shape : (200, 17, 384), with range scale (0.47946929931640625,-0.5571277737617493) 
source_data subject_idx 42 has shape : (200, 17, 384), with range scale (1.4097098112106323,-1.0699217319488525) 
source_data subject_idx 43 has shape : (200, 17, 384), with range scale (1.3387291431427002,-1.1521470546722412) 
source_data subject_idx 44 has shape : (200, 17, 384), with range scale (0.8694338798522949,-0.8605979084968567) 
source_data subject_idx 45 has shape : (200, 17, 384), with range scale (0.9423102140426636,-0.885471522808075) 
source_data subject_idx 46 has shape : (200, 17, 384), with range scale (1.4963183403015137,-1.6483010053634644) 
source_data subject_idx 47 has shape : (200, 17, 384), with range scale (1.4078161716461182,-1.5489822626113892) 
source_data subject_idx 48 has shape : (200, 17, 384), with range scale (1.2182726860046387,-0.811068594455719) 
source dataset idx :  1
run custom EA
generate new r_op
source_data subject_idx 0 has shape : (92, 17, 384), with range scale (0.7169162034988403,-0.6664949655532837) 
source_data subject_idx 1 has shape : (89, 17, 384), with range scale (0.7367219924926758,-0.9459208250045776) 
source_data subject_idx 2 has shape : (92, 17, 384), with range scale (0.9302616119384766,-0.9795837998390198) 
source_data subject_idx 3 has shape : (91, 17, 384), with range scale (0.691114604473114,-0.7401592135429382) 
source_data subject_idx 4 has shape : (88, 17, 384), with range scale (0.9459317922592163,-1.1025806665420532) 
source_data subject_idx 5 has shape : (92, 17, 384), with range scale (0.8528969287872314,-1.0217312574386597) 
source_data subject_idx 6 has shape : (91, 17, 384), with range scale (0.5388573408126831,-0.5337445735931396) 
source_data subject_idx 7 has shape : (89, 17, 384), with range scale (1.4369562864303589,-1.223192811012268) 
source_data subject_idx 8 has shape : (91, 17, 384), with range scale (0.4977075457572937,-0.4644436240196228) 
source_data subject_idx 9 has shape : (91, 17, 384), with range scale (0.42410993576049805,-0.552099883556366) 
source_data subject_idx 10 has shape : (91, 17, 384), with range scale (1.1383635997772217,-1.4176443815231323) 
source_data subject_idx 11 has shape : (89, 17, 384), with range scale (1.0658844709396362,-0.8994742631912231) 
source_data subject_idx 12 has shape : (91, 17, 384), with range scale (0.6188948750495911,-0.6889960765838623) 
source_data subject_idx 13 has shape : (88, 17, 384), with range scale (0.3236307203769684,-0.4282187223434448) 
source_data subject_idx 14 has shape : (91, 17, 384), with range scale (0.41625848412513733,-0.5230375528335571) 
source_data subject_idx 15 has shape : (88, 17, 384), with range scale (0.4929223954677582,-0.5623812675476074) 
source_data subject_idx 16 has shape : (89, 17, 384), with range scale (0.88502037525177,-1.196359634399414) 
source_data subject_idx 17 has shape : (90, 17, 384), with range scale (0.46859344840049744,-0.48558470606803894) 
source_data subject_idx 18 has shape : (91, 17, 384), with range scale (0.4752838909626007,-0.45331206917762756) 
source_data subject_idx 19 has shape : (90, 17, 384), with range scale (0.6349341869354248,-0.7902240753173828) 
source_data subject_idx 20 has shape : (90, 17, 384), with range scale (0.4959060847759247,-0.5121389627456665) 
source_data subject_idx 21 has shape : (91, 17, 384), with range scale (0.6096289753913879,-0.7651546597480774) 
source_data subject_idx 22 has shape : (89, 17, 384), with range scale (0.8464249968528748,-0.8947135210037231) 
source_data subject_idx 23 has shape : (90, 17, 384), with range scale (0.7144237160682678,-0.8370522260665894) 
source_data subject_idx 24 has shape : (88, 17, 384), with range scale (0.9057577848434448,-1.0708329677581787) 
source_data subject_idx 25 has shape : (93, 17, 384), with range scale (0.7831981778144836,-0.7814754247665405) 
source_data subject_idx 26 has shape : (91, 17, 384), with range scale (1.2667361497879028,-1.2867064476013184) 
source_data subject_idx 27 has shape : (89, 17, 384), with range scale (0.715073823928833,-0.8704080581665039) 
source_data subject_idx 28 has shape : (91, 17, 384), with range scale (0.823622465133667,-0.7710578441619873) 
source_data subject_idx 29 has shape : (90, 17, 384), with range scale (1.7067055702209473,-1.362501621246338) 
source_data subject_idx 30 has shape : (89, 17, 384), with range scale (0.42109474539756775,-0.5971027612686157) 
source_data subject_idx 31 has shape : (89, 17, 384), with range scale (1.1272733211517334,-0.9254766702651978) 
source_data subject_idx 32 has shape : (91, 17, 384), with range scale (0.4515339732170105,-0.49986064434051514) 
source_data subject_idx 33 has shape : (89, 17, 384), with range scale (0.8349516987800598,-0.8060201406478882) 
source_data subject_idx 34 has shape : (88, 17, 384), with range scale (0.5930517911911011,-0.667640209197998) 
source_data subject_idx 35 has shape : (91, 17, 384), with range scale (1.008338451385498,-1.0509880781173706) 
source_data subject_idx 36 has shape : (91, 17, 384), with range scale (0.593373715877533,-0.5770897269248962) 
source_data subject_idx 37 has shape : (90, 17, 384), with range scale (0.3337509334087372,-0.3894091546535492) 
source_data subject_idx 38 has shape : (90, 17, 384), with range scale (0.5131454467773438,-0.39244702458381653) 
source_data subject_idx 39 has shape : (89, 17, 384), with range scale (0.8909652233123779,-1.5867822170257568) 
source_data subject_idx 40 has shape : (91, 17, 384), with range scale (0.6203176379203796,-0.5695602893829346) 
source_data subject_idx 41 has shape : (88, 17, 384), with range scale (0.9914578795433044,-0.6623650789260864) 
source_data subject_idx 42 has shape : (90, 17, 384), with range scale (1.3082313537597656,-1.2687772512435913) 
source_data subject_idx 43 has shape : (89, 17, 384), with range scale (0.39732423424720764,-0.4900325536727905) 
source_data subject_idx 44 has shape : (89, 17, 384), with range scale (0.8021134734153748,-1.0494554042816162) 
source_data subject_idx 45 has shape : (91, 17, 384), with range scale (0.6604734063148499,-0.5932362079620361) 
source_data subject_idx 46 has shape : (91, 17, 384), with range scale (0.5637867450714111,-0.6177029609680176) 
source_data subject_idx 47 has shape : (88, 17, 384), with range scale (0.6126500964164734,-0.6881211400032043) 
source_data subject_idx 48 has shape : (92, 17, 384), with range scale (0.9746087789535522,-0.9049380421638489) 
source_data subject_idx 49 has shape : (89, 17, 384), with range scale (0.7907715439796448,-1.0917167663574219) 
source_data subject_idx 50 has shape : (93, 17, 384), with range scale (1.0379266738891602,-1.188753366470337) 
source_data subject_idx 51 has shape : (92, 17, 384), with range scale (0.7975730895996094,-0.8419255018234253) 
source_data subject_idx 52 has shape : (89, 17, 384), with range scale (0.9716087579727173,-0.8925856351852417) 
source_data subject_idx 53 has shape : (90, 17, 384), with range scale (0.7912880182266235,-0.8501782417297363) 
source_data subject_idx 54 has shape : (90, 17, 384), with range scale (0.4885285794734955,-0.3597244322299957) 
source_data subject_idx 55 has shape : (89, 17, 384), with range scale (0.9037812352180481,-0.7423575520515442) 
source_data subject_idx 56 has shape : (92, 17, 384), with range scale (1.4165902137756348,-0.8528302907943726) 
source_data subject_idx 57 has shape : (91, 17, 384), with range scale (0.8686171770095825,-1.0360792875289917) 
source_data subject_idx 58 has shape : (92, 17, 384), with range scale (1.8695253133773804,-0.7935270071029663) 
source_data subject_idx 59 has shape : (92, 17, 384), with range scale (0.5022420287132263,-0.5183480978012085) 
source_data subject_idx 60 has shape : (88, 17, 384), with range scale (0.8774799704551697,-0.8143843412399292) 
source_data subject_idx 61 has shape : (90, 17, 384), with range scale (0.4195600748062134,-0.5917611122131348) 
source_data subject_idx 62 has shape : (90, 17, 384), with range scale (2.23943829536438,-1.4211475849151611) 
source_data subject_idx 63 has shape : (91, 17, 384), with range scale (0.5610853433609009,-0.5430169701576233) 
source_data subject_idx 64 has shape : (92, 17, 384), with range scale (0.6622500419616699,-0.6672776341438293) 
source_data subject_idx 65 has shape : (90, 17, 384), with range scale (1.1588901281356812,-1.3947761058807373) 
source_data subject_idx 66 has shape : (89, 17, 384), with range scale (1.156064748764038,-1.1673425436019897) 
source_data subject_idx 67 has shape : (90, 17, 384), with range scale (0.7678646445274353,-0.5782241821289062) 
source_data subject_idx 68 has shape : (92, 17, 384), with range scale (0.4321843385696411,-0.5818220376968384) 
source_data subject_idx 69 has shape : (89, 17, 384), with range scale (1.0627270936965942,-1.1566270589828491) 
source_data subject_idx 70 has shape : (89, 17, 384), with range scale (1.0456321239471436,-0.9711074829101562) 
source_data subject_idx 71 has shape : (90, 17, 384), with range scale (1.066978096961975,-1.185381531715393) 
source_data subject_idx 72 has shape : (90, 17, 384), with range scale (0.5864176154136658,-0.5077543258666992) 
source_data subject_idx 73 has shape : (91, 17, 384), with range scale (0.6305578947067261,-0.7793805003166199) 
source_data subject_idx 74 has shape : (91, 17, 384), with range scale (0.6688997149467468,-0.7725189328193665) 
source_data subject_idx 75 has shape : (90, 17, 384), with range scale (0.3052671551704407,-0.37482795119285583) 
source_data subject_idx 76 has shape : (89, 17, 384), with range scale (0.7272578477859497,-0.6320812106132507) 
source_data subject_idx 77 has shape : (91, 17, 384), with range scale (1.5900516510009766,-1.3911101818084717) 
source_data subject_idx 78 has shape : (91, 17, 384), with range scale (0.6965444087982178,-0.5931110382080078) 
source_data subject_idx 79 has shape : (89, 17, 384), with range scale (1.467740535736084,-1.0494499206542969) 
source_data subject_idx 80 has shape : (90, 17, 384), with range scale (0.9545451402664185,-1.0810126066207886) 
source_data subject_idx 81 has shape : (89, 17, 384), with range scale (0.6345996260643005,-0.7612450122833252) 
source_data subject_idx 82 has shape : (90, 17, 384), with range scale (0.8933464884757996,-0.9619231820106506) 
source_data subject_idx 83 has shape : (91, 17, 384), with range scale (0.8108646869659424,-1.161116123199463) 
source_data subject_idx 84 has shape : (90, 17, 384), with range scale (0.6444645524024963,-0.5144601464271545) 
source_data subject_idx 85 has shape : (91, 17, 384), with range scale (1.1594910621643066,-1.0914311408996582) 
source_data subject_idx 86 has shape : (89, 17, 384), with range scale (0.689849853515625,-0.5512941479682922) 
source_data subject_idx 87 has shape : (114, 17, 384), with range scale (0.4337463974952698,-0.4795781373977661) 
source_data subject_idx 88 has shape : (90, 17, 384), with range scale (0.9034557938575745,-0.9589319825172424) 
source_data subject_idx 89 has shape : (90, 17, 384), with range scale (0.8137968182563782,-0.9145379066467285) 
source_data subject_idx 90 has shape : (90, 17, 384), with range scale (0.7387031316757202,-0.7604924440383911) 
source_data subject_idx 91 has shape : (111, 17, 384), with range scale (0.5104097127914429,-0.5557769536972046) 
source_data subject_idx 92 has shape : (90, 17, 384), with range scale (0.5296695828437805,-0.39493680000305176) 
source_data subject_idx 93 has shape : (90, 17, 384), with range scale (0.9362726807594299,-0.5925340056419373) 
source_data subject_idx 94 has shape : (91, 17, 384), with range scale (0.9929652214050293,-1.108001470565796) 
source_data subject_idx 95 has shape : (92, 17, 384), with range scale (0.8198074698448181,-0.7674327492713928) 
source_data subject_idx 96 has shape : (90, 17, 384), with range scale (0.549396276473999,-0.869248628616333) 
source_data subject_idx 97 has shape : (92, 17, 384), with range scale (0.4608597755432129,-0.557570219039917) 
source_data subject_idx 98 has shape : (91, 17, 384), with range scale (1.3270875215530396,-1.2842411994934082) 
source_data subject_idx 99 has shape : (72, 17, 384), with range scale (0.6997339129447937,-0.5448974967002869) 
source_data subject_idx 100 has shape : (88, 17, 384), with range scale (0.3013438582420349,-0.33602175116539) 
source_data subject_idx 101 has shape : (89, 17, 384), with range scale (1.3008520603179932,-1.2512694597244263) 
source_data subject_idx 102 has shape : (90, 17, 384), with range scale (0.6922404766082764,-0.739229679107666) 
source_data subject_idx 103 has shape : (88, 17, 384), with range scale (0.45946475863456726,-0.6984744071960449) 
source_data subject_idx 104 has shape : (89, 17, 384), with range scale (0.5780012607574463,-0.45048871636390686) 
source_data subject_idx 105 has shape : (91, 17, 384), with range scale (0.5554128289222717,-0.614891767501831) 
source_data subject_idx 106 has shape : (92, 17, 384), with range scale (0.7811171412467957,-0.9906891584396362) 
source_data subject_idx 107 has shape : (90, 17, 384), with range scale (0.6523552536964417,-0.6484967470169067) 
source_data subject_idx 108 has shape : (90, 17, 384), with range scale (0.9993579983711243,-1.1295974254608154) 
source dataset idx :  2
run custom EA
generate new r_op
source_data subject_idx 0 has shape : (576, 17, 384), with range scale (0.716140627861023,-1.0298913717269897) 
source_data subject_idx 1 has shape : (576, 17, 384), with range scale (0.9762287735939026,-0.8352589011192322) 
source_data subject_idx 2 has shape : (576, 17, 384), with range scale (1.0710777044296265,-1.444108009338379) 
source_data subject_idx 3 has shape : (576, 17, 384), with range scale (0.9218441843986511,-1.0728968381881714) 
source_data subject_idx 4 has shape : (576, 17, 384), with range scale (1.322721004486084,-1.6325982809066772) 
source_data subject_idx 5 has shape : (576, 17, 384), with range scale (1.0932258367538452,-0.9982351660728455) 
source_data subject_idx 6 has shape : (576, 17, 384), with range scale (0.454509973526001,-0.45308664441108704) 
source_data subject_idx 7 has shape : (576, 17, 384), with range scale (1.096022129058838,-1.0179657936096191) 
source_data subject_idx 8 has shape : (576, 17, 384), with range scale (0.4593527913093567,-0.49064207077026367) 
only use r-op for subjects [0]
use exist r_op
unlabel data subject_idx 0 has shape : (200, 17, 384), with range scale (0.5421113967895508,-0.6338673233985901) 
Loading trainer: MultiDatasetMCDV1
Params :  FREEZE: False
NAME: deepsleep
PARAMS:
  F1: 8
  F2: 8
  avg_pool_1: 4
  avg_pool_2: 8
  drop_prob: 0.25
  kern_length_1: 64
  kern_length_2: 16
  num_ch: 17
  samples: 384
PRETRAINED: False
PRETRAINED_PATH: 
Building F
Building CommonFeature
Backbone: deepsleep
params set up :  {'kern_length_1': 64, 'kern_length_2': 16, 'num_ch': 17, 'samples': 384, 'F1': 8, 'F2': 8, 'drop_prob': 0.25, 'avg_pool_1': 4, 'avg_pool_2': 8}
pretrain :  False
pretrain path : 
Building Target Classifier
use max norm constraint on last FC
use max norm constraint on last FC
Building SourceClassifiers
source domains label size :  [2, 4, 4]
use max norm constraint on last FC
use max norm constraint on last FC
use max norm constraint on last FC
there is n_step_F :  5
save checkpoint keys :  dict_keys(['epoch', 'global_step', 'pytorch-lightning_version', 'state_dict', 'callbacks', 'optimizer_states', 'lr_schedulers'])
combine predict folder :  /data1/wduong_experiment_data/EEG_Dassl_Lightning//NeurIPS_competition/task_2_final_2/LA_EA/tune/1//no_aug/no_norm/deepsleep_mcdV1/dataset_B_0/model/predict_folder/increment_fold_1/test_fold_1/valid_fold_2
use data manager for domain adaptation
Loading dataset: MultiDataset
data root :  /data1/wduong_experiment_data/EEG_Dassl_Lightning/da_dataset/NeurIPS_competition
dataset dir :  final_MI_B_1
file name :  dataset_B_0/NeurIPS_TL.mat
r_op file path :  /data1/wduong_experiment_data/EEG_Dassl_Lightning/da_dataset/NeurIPS_competition/final_MI_B_1/dataset_B_0/dataset_B_0_r_op.mat

there is test file 
run custom EA
only use r-op for subjects [0]
only use r-op for subjects [0]
only use r-op for subjects [0]
use exist r_op
use exist r_op
use exist r_op
train subjects :  [0]
Train subject 0 has shape : (96, 1, 17, 384), with range scale (0.9934844374656677,-0.9528900980949402) 
test subjects :  [0]
test subject 0 has shape : (24, 1, 17, 384), with range scale (0.3826163709163666,-0.463559627532959)  
valid subjects :  [0]
valid subject 0 has shape : (24, 1, 17, 384), with range scale (0.3826163709163666,-0.463559627532959)  
the labels ratio of whole dataset : [4.363636363636363, 3.84, 4.0, 3.84]
source dataset idx :  0
run custom EA
generate new r_op
source_data subject_idx 0 has shape : (200, 17, 384), with range scale (2.8882222175598145,-3.0118398666381836) 
source_data subject_idx 1 has shape : (200, 17, 384), with range scale (2.012194871902466,-1.471892237663269) 
source_data subject_idx 2 has shape : (200, 17, 384), with range scale (0.39883995056152344,-0.47107645869255066) 
source_data subject_idx 3 has shape : (200, 17, 384), with range scale (0.633466899394989,-0.8988378643989563) 
source_data subject_idx 4 has shape : (200, 17, 384), with range scale (1.3011571168899536,-1.2901395559310913) 
source_data subject_idx 5 has shape : (200, 17, 384), with range scale (0.6116749048233032,-0.5340460538864136) 
source_data subject_idx 6 has shape : (240, 17, 384), with range scale (1.6593918800354004,-1.945071816444397) 
source_data subject_idx 7 has shape : (200, 17, 384), with range scale (0.52070552110672,-0.6748800277709961) 
source_data subject_idx 8 has shape : (240, 17, 384), with range scale (0.9757770895957947,-0.611278235912323) 
source_data subject_idx 9 has shape : (200, 17, 384), with range scale (0.7230930924415588,-0.6379406452178955) 
source_data subject_idx 10 has shape : (200, 17, 384), with range scale (2.196751594543457,-2.3680875301361084) 
source_data subject_idx 11 has shape : (200, 17, 384), with range scale (0.5474781394004822,-0.4567890167236328) 
source_data subject_idx 12 has shape : (200, 17, 384), with range scale (0.34184280037879944,-0.3546203076839447) 
source_data subject_idx 13 has shape : (200, 17, 384), with range scale (0.4874683618545532,-0.5128428936004639) 
source_data subject_idx 14 has shape : (200, 17, 384), with range scale (0.6301130056381226,-0.5653321743011475) 
source_data subject_idx 15 has shape : (200, 17, 384), with range scale (0.843874990940094,-0.9753001928329468) 
source_data subject_idx 16 has shape : (200, 17, 384), with range scale (0.6573670506477356,-0.6639305353164673) 
source_data subject_idx 17 has shape : (200, 17, 384), with range scale (1.275315761566162,-1.3497552871704102) 
source_data subject_idx 18 has shape : (200, 17, 384), with range scale (1.5794085264205933,-1.4551502466201782) 
source_data subject_idx 19 has shape : (200, 17, 384), with range scale (0.5881903171539307,-0.5797205567359924) 
source_data subject_idx 20 has shape : (200, 17, 384), with range scale (1.0885236263275146,-0.7935687303543091) 
source_data subject_idx 21 has shape : (200, 17, 384), with range scale (1.9916812181472778,-1.3703601360321045) 
source_data subject_idx 22 has shape : (200, 17, 384), with range scale (1.3182650804519653,-1.0296597480773926) 
source_data subject_idx 23 has shape : (200, 17, 384), with range scale (0.9592158198356628,-0.9697363376617432) 
source_data subject_idx 24 has shape : (200, 17, 384), with range scale (1.1470407247543335,-1.1388038396835327) 
source_data subject_idx 25 has shape : (200, 17, 384), with range scale (2.2241201400756836,-2.4356601238250732) 
source_data subject_idx 26 has shape : (200, 17, 384), with range scale (1.592162847518921,-1.2840940952301025) 
source_data subject_idx 27 has shape : (200, 17, 384), with range scale (1.3226505517959595,-1.0074076652526855) 
source_data subject_idx 28 has shape : (200, 17, 384), with range scale (1.7132503986358643,-1.5864579677581787) 
source_data subject_idx 29 has shape : (200, 17, 384), with range scale (0.5230404138565063,-0.6324833035469055) 
source_data subject_idx 30 has shape : (200, 17, 384), with range scale (0.49305006861686707,-0.4982423782348633) 
source_data subject_idx 31 has shape : (200, 17, 384), with range scale (0.588959276676178,-0.8800286650657654) 
source_data subject_idx 32 has shape : (200, 17, 384), with range scale (0.7126017808914185,-0.9526523351669312) 
source_data subject_idx 33 has shape : (200, 17, 384), with range scale (2.3252944946289062,-2.73030161857605) 
source_data subject_idx 34 has shape : (200, 17, 384), with range scale (2.032393217086792,-2.653068780899048) 
source_data subject_idx 35 has shape : (200, 17, 384), with range scale (2.496364116668701,-2.437655448913574) 
source_data subject_idx 36 has shape : (200, 17, 384), with range scale (1.0227330923080444,-0.7400245666503906) 
source_data subject_idx 37 has shape : (200, 17, 384), with range scale (0.5067989230155945,-0.5049859285354614) 
source_data subject_idx 38 has shape : (200, 17, 384), with range scale (1.0809292793273926,-1.2355200052261353) 
source_data subject_idx 39 has shape : (200, 17, 384), with range scale (0.7384615540504456,-0.7018154859542847) 
source_data subject_idx 40 has shape : (200, 17, 384), with range scale (1.3897559642791748,-1.1106163263320923) 
source_data subject_idx 41 has shape : (200, 17, 384), with range scale (0.47946929931640625,-0.5571277737617493) 
source_data subject_idx 42 has shape : (200, 17, 384), with range scale (1.4097098112106323,-1.0699217319488525) 
source_data subject_idx 43 has shape : (200, 17, 384), with range scale (1.3387291431427002,-1.1521470546722412) 
source_data subject_idx 44 has shape : (200, 17, 384), with range scale (0.8694338798522949,-0.8605979084968567) 
source_data subject_idx 45 has shape : (200, 17, 384), with range scale (0.9423102140426636,-0.885471522808075) 
source_data subject_idx 46 has shape : (200, 17, 384), with range scale (1.4963183403015137,-1.6483010053634644) 
source_data subject_idx 47 has shape : (200, 17, 384), with range scale (1.4078161716461182,-1.5489822626113892) 
source_data subject_idx 48 has shape : (200, 17, 384), with range scale (1.2182726860046387,-0.811068594455719) 
source dataset idx :  1
run custom EA
generate new r_op
source_data subject_idx 0 has shape : (92, 17, 384), with range scale (0.7169162034988403,-0.6664949655532837) 
source_data subject_idx 1 has shape : (89, 17, 384), with range scale (0.7367219924926758,-0.9459208250045776) 
source_data subject_idx 2 has shape : (92, 17, 384), with range scale (0.9302616119384766,-0.9795837998390198) 
source_data subject_idx 3 has shape : (91, 17, 384), with range scale (0.691114604473114,-0.7401592135429382) 
source_data subject_idx 4 has shape : (88, 17, 384), with range scale (0.9459317922592163,-1.1025806665420532) 
source_data subject_idx 5 has shape : (92, 17, 384), with range scale (0.8528969287872314,-1.0217312574386597) 
source_data subject_idx 6 has shape : (91, 17, 384), with range scale (0.5388573408126831,-0.5337445735931396) 
source_data subject_idx 7 has shape : (89, 17, 384), with range scale (1.4369562864303589,-1.223192811012268) 
source_data subject_idx 8 has shape : (91, 17, 384), with range scale (0.4977075457572937,-0.4644436240196228) 
source_data subject_idx 9 has shape : (91, 17, 384), with range scale (0.42410993576049805,-0.552099883556366) 
source_data subject_idx 10 has shape : (91, 17, 384), with range scale (1.1383635997772217,-1.4176443815231323) 
source_data subject_idx 11 has shape : (89, 17, 384), with range scale (1.0658844709396362,-0.8994742631912231) 
source_data subject_idx 12 has shape : (91, 17, 384), with range scale (0.6188948750495911,-0.6889960765838623) 
source_data subject_idx 13 has shape : (88, 17, 384), with range scale (0.3236307203769684,-0.4282187223434448) 
source_data subject_idx 14 has shape : (91, 17, 384), with range scale (0.41625848412513733,-0.5230375528335571) 
source_data subject_idx 15 has shape : (88, 17, 384), with range scale (0.4929223954677582,-0.5623812675476074) 
source_data subject_idx 16 has shape : (89, 17, 384), with range scale (0.88502037525177,-1.196359634399414) 
source_data subject_idx 17 has shape : (90, 17, 384), with range scale (0.46859344840049744,-0.48558470606803894) 
source_data subject_idx 18 has shape : (91, 17, 384), with range scale (0.4752838909626007,-0.45331206917762756) 
source_data subject_idx 19 has shape : (90, 17, 384), with range scale (0.6349341869354248,-0.7902240753173828) 
source_data subject_idx 20 has shape : (90, 17, 384), with range scale (0.4959060847759247,-0.5121389627456665) 
source_data subject_idx 21 has shape : (91, 17, 384), with range scale (0.6096289753913879,-0.7651546597480774) 
source_data subject_idx 22 has shape : (89, 17, 384), with range scale (0.8464249968528748,-0.8947135210037231) 
source_data subject_idx 23 has shape : (90, 17, 384), with range scale (0.7144237160682678,-0.8370522260665894) 
source_data subject_idx 24 has shape : (88, 17, 384), with range scale (0.9057577848434448,-1.0708329677581787) 
source_data subject_idx 25 has shape : (93, 17, 384), with range scale (0.7831981778144836,-0.7814754247665405) 
source_data subject_idx 26 has shape : (91, 17, 384), with range scale (1.2667361497879028,-1.2867064476013184) 
source_data subject_idx 27 has shape : (89, 17, 384), with range scale (0.715073823928833,-0.8704080581665039) 
source_data subject_idx 28 has shape : (91, 17, 384), with range scale (0.823622465133667,-0.7710578441619873) 
source_data subject_idx 29 has shape : (90, 17, 384), with range scale (1.7067055702209473,-1.362501621246338) 
source_data subject_idx 30 has shape : (89, 17, 384), with range scale (0.42109474539756775,-0.5971027612686157) 
source_data subject_idx 31 has shape : (89, 17, 384), with range scale (1.1272733211517334,-0.9254766702651978) 
source_data subject_idx 32 has shape : (91, 17, 384), with range scale (0.4515339732170105,-0.49986064434051514) 
source_data subject_idx 33 has shape : (89, 17, 384), with range scale (0.8349516987800598,-0.8060201406478882) 
source_data subject_idx 34 has shape : (88, 17, 384), with range scale (0.5930517911911011,-0.667640209197998) 
source_data subject_idx 35 has shape : (91, 17, 384), with range scale (1.008338451385498,-1.0509880781173706) 
source_data subject_idx 36 has shape : (91, 17, 384), with range scale (0.593373715877533,-0.5770897269248962) 
source_data subject_idx 37 has shape : (90, 17, 384), with range scale (0.3337509334087372,-0.3894091546535492) 
source_data subject_idx 38 has shape : (90, 17, 384), with range scale (0.5131454467773438,-0.39244702458381653) 
source_data subject_idx 39 has shape : (89, 17, 384), with range scale (0.8909652233123779,-1.5867822170257568) 
source_data subject_idx 40 has shape : (91, 17, 384), with range scale (0.6203176379203796,-0.5695602893829346) 
source_data subject_idx 41 has shape : (88, 17, 384), with range scale (0.9914578795433044,-0.6623650789260864) 
source_data subject_idx 42 has shape : (90, 17, 384), with range scale (1.3082313537597656,-1.2687772512435913) 
source_data subject_idx 43 has shape : (89, 17, 384), with range scale (0.39732423424720764,-0.4900325536727905) 
source_data subject_idx 44 has shape : (89, 17, 384), with range scale (0.8021134734153748,-1.0494554042816162) 
source_data subject_idx 45 has shape : (91, 17, 384), with range scale (0.6604734063148499,-0.5932362079620361) 
source_data subject_idx 46 has shape : (91, 17, 384), with range scale (0.5637867450714111,-0.6177029609680176) 
source_data subject_idx 47 has shape : (88, 17, 384), with range scale (0.6126500964164734,-0.6881211400032043) 
source_data subject_idx 48 has shape : (92, 17, 384), with range scale (0.9746087789535522,-0.9049380421638489) 
source_data subject_idx 49 has shape : (89, 17, 384), with range scale (0.7907715439796448,-1.0917167663574219) 
source_data subject_idx 50 has shape : (93, 17, 384), with range scale (1.0379266738891602,-1.188753366470337) 
source_data subject_idx 51 has shape : (92, 17, 384), with range scale (0.7975730895996094,-0.8419255018234253) 
source_data subject_idx 52 has shape : (89, 17, 384), with range scale (0.9716087579727173,-0.8925856351852417) 
source_data subject_idx 53 has shape : (90, 17, 384), with range scale (0.7912880182266235,-0.8501782417297363) 
source_data subject_idx 54 has shape : (90, 17, 384), with range scale (0.4885285794734955,-0.3597244322299957) 
source_data subject_idx 55 has shape : (89, 17, 384), with range scale (0.9037812352180481,-0.7423575520515442) 
source_data subject_idx 56 has shape : (92, 17, 384), with range scale (1.4165902137756348,-0.8528302907943726) 
source_data subject_idx 57 has shape : (91, 17, 384), with range scale (0.8686171770095825,-1.0360792875289917) 
source_data subject_idx 58 has shape : (92, 17, 384), with range scale (1.8695253133773804,-0.7935270071029663) 
source_data subject_idx 59 has shape : (92, 17, 384), with range scale (0.5022420287132263,-0.5183480978012085) 
source_data subject_idx 60 has shape : (88, 17, 384), with range scale (0.8774799704551697,-0.8143843412399292) 
source_data subject_idx 61 has shape : (90, 17, 384), with range scale (0.4195600748062134,-0.5917611122131348) 
source_data subject_idx 62 has shape : (90, 17, 384), with range scale (2.23943829536438,-1.4211475849151611) 
source_data subject_idx 63 has shape : (91, 17, 384), with range scale (0.5610853433609009,-0.5430169701576233) 
source_data subject_idx 64 has shape : (92, 17, 384), with range scale (0.6622500419616699,-0.6672776341438293) 
source_data subject_idx 65 has shape : (90, 17, 384), with range scale (1.1588901281356812,-1.3947761058807373) 
source_data subject_idx 66 has shape : (89, 17, 384), with range scale (1.156064748764038,-1.1673425436019897) 
source_data subject_idx 67 has shape : (90, 17, 384), with range scale (0.7678646445274353,-0.5782241821289062) 
source_data subject_idx 68 has shape : (92, 17, 384), with range scale (0.4321843385696411,-0.5818220376968384) 
source_data subject_idx 69 has shape : (89, 17, 384), with range scale (1.0627270936965942,-1.1566270589828491) 
source_data subject_idx 70 has shape : (89, 17, 384), with range scale (1.0456321239471436,-0.9711074829101562) 
source_data subject_idx 71 has shape : (90, 17, 384), with range scale (1.066978096961975,-1.185381531715393) 
source_data subject_idx 72 has shape : (90, 17, 384), with range scale (0.5864176154136658,-0.5077543258666992) 
source_data subject_idx 73 has shape : (91, 17, 384), with range scale (0.6305578947067261,-0.7793805003166199) 
source_data subject_idx 74 has shape : (91, 17, 384), with range scale (0.6688997149467468,-0.7725189328193665) 
source_data subject_idx 75 has shape : (90, 17, 384), with range scale (0.3052671551704407,-0.37482795119285583) 
source_data subject_idx 76 has shape : (89, 17, 384), with range scale (0.7272578477859497,-0.6320812106132507) 
source_data subject_idx 77 has shape : (91, 17, 384), with range scale (1.5900516510009766,-1.3911101818084717) 
source_data subject_idx 78 has shape : (91, 17, 384), with range scale (0.6965444087982178,-0.5931110382080078) 
source_data subject_idx 79 has shape : (89, 17, 384), with range scale (1.467740535736084,-1.0494499206542969) 
source_data subject_idx 80 has shape : (90, 17, 384), with range scale (0.9545451402664185,-1.0810126066207886) 
source_data subject_idx 81 has shape : (89, 17, 384), with range scale (0.6345996260643005,-0.7612450122833252) 
source_data subject_idx 82 has shape : (90, 17, 384), with range scale (0.8933464884757996,-0.9619231820106506) 
source_data subject_idx 83 has shape : (91, 17, 384), with range scale (0.8108646869659424,-1.161116123199463) 
source_data subject_idx 84 has shape : (90, 17, 384), with range scale (0.6444645524024963,-0.5144601464271545) 
source_data subject_idx 85 has shape : (91, 17, 384), with range scale (1.1594910621643066,-1.0914311408996582) 
source_data subject_idx 86 has shape : (89, 17, 384), with range scale (0.689849853515625,-0.5512941479682922) 
source_data subject_idx 87 has shape : (114, 17, 384), with range scale (0.4337463974952698,-0.4795781373977661) 
source_data subject_idx 88 has shape : (90, 17, 384), with range scale (0.9034557938575745,-0.9589319825172424) 
source_data subject_idx 89 has shape : (90, 17, 384), with range scale (0.8137968182563782,-0.9145379066467285) 
source_data subject_idx 90 has shape : (90, 17, 384), with range scale (0.7387031316757202,-0.7604924440383911) 
source_data subject_idx 91 has shape : (111, 17, 384), with range scale (0.5104097127914429,-0.5557769536972046) 
source_data subject_idx 92 has shape : (90, 17, 384), with range scale (0.5296695828437805,-0.39493680000305176) 
source_data subject_idx 93 has shape : (90, 17, 384), with range scale (0.9362726807594299,-0.5925340056419373) 
source_data subject_idx 94 has shape : (91, 17, 384), with range scale (0.9929652214050293,-1.108001470565796) 
source_data subject_idx 95 has shape : (92, 17, 384), with range scale (0.8198074698448181,-0.7674327492713928) 
source_data subject_idx 96 has shape : (90, 17, 384), with range scale (0.549396276473999,-0.869248628616333) 
source_data subject_idx 97 has shape : (92, 17, 384), with range scale (0.4608597755432129,-0.557570219039917) 
source_data subject_idx 98 has shape : (91, 17, 384), with range scale (1.3270875215530396,-1.2842411994934082) 
source_data subject_idx 99 has shape : (72, 17, 384), with range scale (0.6997339129447937,-0.5448974967002869) 
source_data subject_idx 100 has shape : (88, 17, 384), with range scale (0.3013438582420349,-0.33602175116539) 
source_data subject_idx 101 has shape : (89, 17, 384), with range scale (1.3008520603179932,-1.2512694597244263) 
source_data subject_idx 102 has shape : (90, 17, 384), with range scale (0.6922404766082764,-0.739229679107666) 
source_data subject_idx 103 has shape : (88, 17, 384), with range scale (0.45946475863456726,-0.6984744071960449) 
source_data subject_idx 104 has shape : (89, 17, 384), with range scale (0.5780012607574463,-0.45048871636390686) 
source_data subject_idx 105 has shape : (91, 17, 384), with range scale (0.5554128289222717,-0.614891767501831) 
source_data subject_idx 106 has shape : (92, 17, 384), with range scale (0.7811171412467957,-0.9906891584396362) 
source_data subject_idx 107 has shape : (90, 17, 384), with range scale (0.6523552536964417,-0.6484967470169067) 
source_data subject_idx 108 has shape : (90, 17, 384), with range scale (0.9993579983711243,-1.1295974254608154) 
source dataset idx :  2
run custom EA
generate new r_op
source_data subject_idx 0 has shape : (576, 17, 384), with range scale (0.716140627861023,-1.0298913717269897) 
source_data subject_idx 1 has shape : (576, 17, 384), with range scale (0.9762287735939026,-0.8352589011192322) 
source_data subject_idx 2 has shape : (576, 17, 384), with range scale (1.0710777044296265,-1.444108009338379) 
source_data subject_idx 3 has shape : (576, 17, 384), with range scale (0.9218441843986511,-1.0728968381881714) 
source_data subject_idx 4 has shape : (576, 17, 384), with range scale (1.322721004486084,-1.6325982809066772) 
source_data subject_idx 5 has shape : (576, 17, 384), with range scale (1.0932258367538452,-0.9982351660728455) 
source_data subject_idx 6 has shape : (576, 17, 384), with range scale (0.454509973526001,-0.45308664441108704) 
source_data subject_idx 7 has shape : (576, 17, 384), with range scale (1.096022129058838,-1.0179657936096191) 
source_data subject_idx 8 has shape : (576, 17, 384), with range scale (0.4593527913093567,-0.49064207077026367) 
only use r-op for subjects [0]
use exist r_op
unlabel data subject_idx 0 has shape : (200, 17, 384), with range scale (0.5421113967895508,-0.6338673233985901) 
Loading trainer: MultiDatasetMCDV1
Params :  FREEZE: False
NAME: deepsleep
PARAMS:
  F1: 8
  F2: 8
  avg_pool_1: 4
  avg_pool_2: 8
  drop_prob: 0.25
  kern_length_1: 64
  kern_length_2: 16
  num_ch: 17
  samples: 384
PRETRAINED: False
PRETRAINED_PATH: 
Building F
Building CommonFeature
Backbone: deepsleep
params set up :  {'kern_length_1': 64, 'kern_length_2': 16, 'num_ch': 17, 'samples': 384, 'F1': 8, 'F2': 8, 'drop_prob': 0.25, 'avg_pool_1': 4, 'avg_pool_2': 8}
pretrain :  False
pretrain path : 
Building Target Classifier
use max norm constraint on last FC
use max norm constraint on last FC
Building SourceClassifiers
source domains label size :  [2, 4, 4]
use max norm constraint on last FC
use max norm constraint on last FC
use max norm constraint on last FC
there is n_step_F :  5
save checkpoint keys :  dict_keys(['epoch', 'global_step', 'pytorch-lightning_version', 'state_dict', 'callbacks', 'optimizer_states', 'lr_schedulers'])
combine predict folder :  /data1/wduong_experiment_data/EEG_Dassl_Lightning//NeurIPS_competition/task_2_final_2/LA_EA/tune/1//no_aug/no_norm/deepsleep_mcdV1/dataset_B_0/model/predict_folder/increment_fold_1/test_fold_1/valid_fold_3
use data manager for domain adaptation
Loading dataset: MultiDataset
data root :  /data1/wduong_experiment_data/EEG_Dassl_Lightning/da_dataset/NeurIPS_competition
dataset dir :  final_MI_B_1
file name :  dataset_B_0/NeurIPS_TL.mat
r_op file path :  /data1/wduong_experiment_data/EEG_Dassl_Lightning/da_dataset/NeurIPS_competition/final_MI_B_1/dataset_B_0/dataset_B_0_r_op.mat

there is test file 
run custom EA
only use r-op for subjects [0]
only use r-op for subjects [0]
only use r-op for subjects [0]
use exist r_op
use exist r_op
use exist r_op
train subjects :  [0]
Train subject 0 has shape : (96, 1, 17, 384), with range scale (0.9934844374656677,-0.9528900980949402) 
test subjects :  [0]
test subject 0 has shape : (24, 1, 17, 384), with range scale (0.429892897605896,-0.48409950733184814)  
valid subjects :  [0]
valid subject 0 has shape : (24, 1, 17, 384), with range scale (0.429892897605896,-0.48409950733184814)  
the labels ratio of whole dataset : [4.363636363636363, 4.571428571428571, 3.6923076923076925, 3.5555555555555554]
source dataset idx :  0
run custom EA
generate new r_op
source_data subject_idx 0 has shape : (200, 17, 384), with range scale (2.8882222175598145,-3.0118398666381836) 
source_data subject_idx 1 has shape : (200, 17, 384), with range scale (2.012194871902466,-1.471892237663269) 
source_data subject_idx 2 has shape : (200, 17, 384), with range scale (0.39883995056152344,-0.47107645869255066) 
source_data subject_idx 3 has shape : (200, 17, 384), with range scale (0.633466899394989,-0.8988378643989563) 
source_data subject_idx 4 has shape : (200, 17, 384), with range scale (1.3011571168899536,-1.2901395559310913) 
source_data subject_idx 5 has shape : (200, 17, 384), with range scale (0.6116749048233032,-0.5340460538864136) 
source_data subject_idx 6 has shape : (240, 17, 384), with range scale (1.6593918800354004,-1.945071816444397) 
source_data subject_idx 7 has shape : (200, 17, 384), with range scale (0.52070552110672,-0.6748800277709961) 
source_data subject_idx 8 has shape : (240, 17, 384), with range scale (0.9757770895957947,-0.611278235912323) 
source_data subject_idx 9 has shape : (200, 17, 384), with range scale (0.7230930924415588,-0.6379406452178955) 
source_data subject_idx 10 has shape : (200, 17, 384), with range scale (2.196751594543457,-2.3680875301361084) 
source_data subject_idx 11 has shape : (200, 17, 384), with range scale (0.5474781394004822,-0.4567890167236328) 
source_data subject_idx 12 has shape : (200, 17, 384), with range scale (0.34184280037879944,-0.3546203076839447) 
source_data subject_idx 13 has shape : (200, 17, 384), with range scale (0.4874683618545532,-0.5128428936004639) 
source_data subject_idx 14 has shape : (200, 17, 384), with range scale (0.6301130056381226,-0.5653321743011475) 
source_data subject_idx 15 has shape : (200, 17, 384), with range scale (0.843874990940094,-0.9753001928329468) 
source_data subject_idx 16 has shape : (200, 17, 384), with range scale (0.6573670506477356,-0.6639305353164673) 
source_data subject_idx 17 has shape : (200, 17, 384), with range scale (1.275315761566162,-1.3497552871704102) 
source_data subject_idx 18 has shape : (200, 17, 384), with range scale (1.5794085264205933,-1.4551502466201782) 
source_data subject_idx 19 has shape : (200, 17, 384), with range scale (0.5881903171539307,-0.5797205567359924) 
source_data subject_idx 20 has shape : (200, 17, 384), with range scale (1.0885236263275146,-0.7935687303543091) 
source_data subject_idx 21 has shape : (200, 17, 384), with range scale (1.9916812181472778,-1.3703601360321045) 
source_data subject_idx 22 has shape : (200, 17, 384), with range scale (1.3182650804519653,-1.0296597480773926) 
source_data subject_idx 23 has shape : (200, 17, 384), with range scale (0.9592158198356628,-0.9697363376617432) 
source_data subject_idx 24 has shape : (200, 17, 384), with range scale (1.1470407247543335,-1.1388038396835327) 
source_data subject_idx 25 has shape : (200, 17, 384), with range scale (2.2241201400756836,-2.4356601238250732) 
source_data subject_idx 26 has shape : (200, 17, 384), with range scale (1.592162847518921,-1.2840940952301025) 
source_data subject_idx 27 has shape : (200, 17, 384), with range scale (1.3226505517959595,-1.0074076652526855) 
source_data subject_idx 28 has shape : (200, 17, 384), with range scale (1.7132503986358643,-1.5864579677581787) 
source_data subject_idx 29 has shape : (200, 17, 384), with range scale (0.5230404138565063,-0.6324833035469055) 
source_data subject_idx 30 has shape : (200, 17, 384), with range scale (0.49305006861686707,-0.4982423782348633) 
source_data subject_idx 31 has shape : (200, 17, 384), with range scale (0.588959276676178,-0.8800286650657654) 
source_data subject_idx 32 has shape : (200, 17, 384), with range scale (0.7126017808914185,-0.9526523351669312) 
source_data subject_idx 33 has shape : (200, 17, 384), with range scale (2.3252944946289062,-2.73030161857605) 
source_data subject_idx 34 has shape : (200, 17, 384), with range scale (2.032393217086792,-2.653068780899048) 
source_data subject_idx 35 has shape : (200, 17, 384), with range scale (2.496364116668701,-2.437655448913574) 
source_data subject_idx 36 has shape : (200, 17, 384), with range scale (1.0227330923080444,-0.7400245666503906) 
source_data subject_idx 37 has shape : (200, 17, 384), with range scale (0.5067989230155945,-0.5049859285354614) 
source_data subject_idx 38 has shape : (200, 17, 384), with range scale (1.0809292793273926,-1.2355200052261353) 
source_data subject_idx 39 has shape : (200, 17, 384), with range scale (0.7384615540504456,-0.7018154859542847) 
source_data subject_idx 40 has shape : (200, 17, 384), with range scale (1.3897559642791748,-1.1106163263320923) 
source_data subject_idx 41 has shape : (200, 17, 384), with range scale (0.47946929931640625,-0.5571277737617493) 
source_data subject_idx 42 has shape : (200, 17, 384), with range scale (1.4097098112106323,-1.0699217319488525) 
source_data subject_idx 43 has shape : (200, 17, 384), with range scale (1.3387291431427002,-1.1521470546722412) 
source_data subject_idx 44 has shape : (200, 17, 384), with range scale (0.8694338798522949,-0.8605979084968567) 
source_data subject_idx 45 has shape : (200, 17, 384), with range scale (0.9423102140426636,-0.885471522808075) 
source_data subject_idx 46 has shape : (200, 17, 384), with range scale (1.4963183403015137,-1.6483010053634644) 
source_data subject_idx 47 has shape : (200, 17, 384), with range scale (1.4078161716461182,-1.5489822626113892) 
source_data subject_idx 48 has shape : (200, 17, 384), with range scale (1.2182726860046387,-0.811068594455719) 
source dataset idx :  1
run custom EA
generate new r_op
source_data subject_idx 0 has shape : (92, 17, 384), with range scale (0.7169162034988403,-0.6664949655532837) 
source_data subject_idx 1 has shape : (89, 17, 384), with range scale (0.7367219924926758,-0.9459208250045776) 
source_data subject_idx 2 has shape : (92, 17, 384), with range scale (0.9302616119384766,-0.9795837998390198) 
source_data subject_idx 3 has shape : (91, 17, 384), with range scale (0.691114604473114,-0.7401592135429382) 
source_data subject_idx 4 has shape : (88, 17, 384), with range scale (0.9459317922592163,-1.1025806665420532) 
source_data subject_idx 5 has shape : (92, 17, 384), with range scale (0.8528969287872314,-1.0217312574386597) 
source_data subject_idx 6 has shape : (91, 17, 384), with range scale (0.5388573408126831,-0.5337445735931396) 
source_data subject_idx 7 has shape : (89, 17, 384), with range scale (1.4369562864303589,-1.223192811012268) 
source_data subject_idx 8 has shape : (91, 17, 384), with range scale (0.4977075457572937,-0.4644436240196228) 
source_data subject_idx 9 has shape : (91, 17, 384), with range scale (0.42410993576049805,-0.552099883556366) 
source_data subject_idx 10 has shape : (91, 17, 384), with range scale (1.1383635997772217,-1.4176443815231323) 
source_data subject_idx 11 has shape : (89, 17, 384), with range scale (1.0658844709396362,-0.8994742631912231) 
source_data subject_idx 12 has shape : (91, 17, 384), with range scale (0.6188948750495911,-0.6889960765838623) 
source_data subject_idx 13 has shape : (88, 17, 384), with range scale (0.3236307203769684,-0.4282187223434448) 
source_data subject_idx 14 has shape : (91, 17, 384), with range scale (0.41625848412513733,-0.5230375528335571) 
source_data subject_idx 15 has shape : (88, 17, 384), with range scale (0.4929223954677582,-0.5623812675476074) 
source_data subject_idx 16 has shape : (89, 17, 384), with range scale (0.88502037525177,-1.196359634399414) 
source_data subject_idx 17 has shape : (90, 17, 384), with range scale (0.46859344840049744,-0.48558470606803894) 
source_data subject_idx 18 has shape : (91, 17, 384), with range scale (0.4752838909626007,-0.45331206917762756) 
source_data subject_idx 19 has shape : (90, 17, 384), with range scale (0.6349341869354248,-0.7902240753173828) 
source_data subject_idx 20 has shape : (90, 17, 384), with range scale (0.4959060847759247,-0.5121389627456665) 
source_data subject_idx 21 has shape : (91, 17, 384), with range scale (0.6096289753913879,-0.7651546597480774) 
source_data subject_idx 22 has shape : (89, 17, 384), with range scale (0.8464249968528748,-0.8947135210037231) 
source_data subject_idx 23 has shape : (90, 17, 384), with range scale (0.7144237160682678,-0.8370522260665894) 
source_data subject_idx 24 has shape : (88, 17, 384), with range scale (0.9057577848434448,-1.0708329677581787) 
source_data subject_idx 25 has shape : (93, 17, 384), with range scale (0.7831981778144836,-0.7814754247665405) 
source_data subject_idx 26 has shape : (91, 17, 384), with range scale (1.2667361497879028,-1.2867064476013184) 
source_data subject_idx 27 has shape : (89, 17, 384), with range scale (0.715073823928833,-0.8704080581665039) 
source_data subject_idx 28 has shape : (91, 17, 384), with range scale (0.823622465133667,-0.7710578441619873) 
source_data subject_idx 29 has shape : (90, 17, 384), with range scale (1.7067055702209473,-1.362501621246338) 
source_data subject_idx 30 has shape : (89, 17, 384), with range scale (0.42109474539756775,-0.5971027612686157) 
source_data subject_idx 31 has shape : (89, 17, 384), with range scale (1.1272733211517334,-0.9254766702651978) 
source_data subject_idx 32 has shape : (91, 17, 384), with range scale (0.4515339732170105,-0.49986064434051514) 
source_data subject_idx 33 has shape : (89, 17, 384), with range scale (0.8349516987800598,-0.8060201406478882) 
source_data subject_idx 34 has shape : (88, 17, 384), with range scale (0.5930517911911011,-0.667640209197998) 
source_data subject_idx 35 has shape : (91, 17, 384), with range scale (1.008338451385498,-1.0509880781173706) 
source_data subject_idx 36 has shape : (91, 17, 384), with range scale (0.593373715877533,-0.5770897269248962) 
source_data subject_idx 37 has shape : (90, 17, 384), with range scale (0.3337509334087372,-0.3894091546535492) 
source_data subject_idx 38 has shape : (90, 17, 384), with range scale (0.5131454467773438,-0.39244702458381653) 
source_data subject_idx 39 has shape : (89, 17, 384), with range scale (0.8909652233123779,-1.5867822170257568) 
source_data subject_idx 40 has shape : (91, 17, 384), with range scale (0.6203176379203796,-0.5695602893829346) 
source_data subject_idx 41 has shape : (88, 17, 384), with range scale (0.9914578795433044,-0.6623650789260864) 
source_data subject_idx 42 has shape : (90, 17, 384), with range scale (1.3082313537597656,-1.2687772512435913) 
source_data subject_idx 43 has shape : (89, 17, 384), with range scale (0.39732423424720764,-0.4900325536727905) 
source_data subject_idx 44 has shape : (89, 17, 384), with range scale (0.8021134734153748,-1.0494554042816162) 
source_data subject_idx 45 has shape : (91, 17, 384), with range scale (0.6604734063148499,-0.5932362079620361) 
source_data subject_idx 46 has shape : (91, 17, 384), with range scale (0.5637867450714111,-0.6177029609680176) 
source_data subject_idx 47 has shape : (88, 17, 384), with range scale (0.6126500964164734,-0.6881211400032043) 
source_data subject_idx 48 has shape : (92, 17, 384), with range scale (0.9746087789535522,-0.9049380421638489) 
source_data subject_idx 49 has shape : (89, 17, 384), with range scale (0.7907715439796448,-1.0917167663574219) 
source_data subject_idx 50 has shape : (93, 17, 384), with range scale (1.0379266738891602,-1.188753366470337) 
source_data subject_idx 51 has shape : (92, 17, 384), with range scale (0.7975730895996094,-0.8419255018234253) 
source_data subject_idx 52 has shape : (89, 17, 384), with range scale (0.9716087579727173,-0.8925856351852417) 
source_data subject_idx 53 has shape : (90, 17, 384), with range scale (0.7912880182266235,-0.8501782417297363) 
source_data subject_idx 54 has shape : (90, 17, 384), with range scale (0.4885285794734955,-0.3597244322299957) 
source_data subject_idx 55 has shape : (89, 17, 384), with range scale (0.9037812352180481,-0.7423575520515442) 
source_data subject_idx 56 has shape : (92, 17, 384), with range scale (1.4165902137756348,-0.8528302907943726) 
source_data subject_idx 57 has shape : (91, 17, 384), with range scale (0.8686171770095825,-1.0360792875289917) 
source_data subject_idx 58 has shape : (92, 17, 384), with range scale (1.8695253133773804,-0.7935270071029663) 
source_data subject_idx 59 has shape : (92, 17, 384), with range scale (0.5022420287132263,-0.5183480978012085) 
source_data subject_idx 60 has shape : (88, 17, 384), with range scale (0.8774799704551697,-0.8143843412399292) 
source_data subject_idx 61 has shape : (90, 17, 384), with range scale (0.4195600748062134,-0.5917611122131348) 
source_data subject_idx 62 has shape : (90, 17, 384), with range scale (2.23943829536438,-1.4211475849151611) 
source_data subject_idx 63 has shape : (91, 17, 384), with range scale (0.5610853433609009,-0.5430169701576233) 
source_data subject_idx 64 has shape : (92, 17, 384), with range scale (0.6622500419616699,-0.6672776341438293) 
source_data subject_idx 65 has shape : (90, 17, 384), with range scale (1.1588901281356812,-1.3947761058807373) 
source_data subject_idx 66 has shape : (89, 17, 384), with range scale (1.156064748764038,-1.1673425436019897) 
source_data subject_idx 67 has shape : (90, 17, 384), with range scale (0.7678646445274353,-0.5782241821289062) 
source_data subject_idx 68 has shape : (92, 17, 384), with range scale (0.4321843385696411,-0.5818220376968384) 
source_data subject_idx 69 has shape : (89, 17, 384), with range scale (1.0627270936965942,-1.1566270589828491) 
source_data subject_idx 70 has shape : (89, 17, 384), with range scale (1.0456321239471436,-0.9711074829101562) 
source_data subject_idx 71 has shape : (90, 17, 384), with range scale (1.066978096961975,-1.185381531715393) 
source_data subject_idx 72 has shape : (90, 17, 384), with range scale (0.5864176154136658,-0.5077543258666992) 
source_data subject_idx 73 has shape : (91, 17, 384), with range scale (0.6305578947067261,-0.7793805003166199) 
source_data subject_idx 74 has shape : (91, 17, 384), with range scale (0.6688997149467468,-0.7725189328193665) 
source_data subject_idx 75 has shape : (90, 17, 384), with range scale (0.3052671551704407,-0.37482795119285583) 
source_data subject_idx 76 has shape : (89, 17, 384), with range scale (0.7272578477859497,-0.6320812106132507) 
source_data subject_idx 77 has shape : (91, 17, 384), with range scale (1.5900516510009766,-1.3911101818084717) 
source_data subject_idx 78 has shape : (91, 17, 384), with range scale (0.6965444087982178,-0.5931110382080078) 
source_data subject_idx 79 has shape : (89, 17, 384), with range scale (1.467740535736084,-1.0494499206542969) 
source_data subject_idx 80 has shape : (90, 17, 384), with range scale (0.9545451402664185,-1.0810126066207886) 
source_data subject_idx 81 has shape : (89, 17, 384), with range scale (0.6345996260643005,-0.7612450122833252) 
source_data subject_idx 82 has shape : (90, 17, 384), with range scale (0.8933464884757996,-0.9619231820106506) 
source_data subject_idx 83 has shape : (91, 17, 384), with range scale (0.8108646869659424,-1.161116123199463) 
source_data subject_idx 84 has shape : (90, 17, 384), with range scale (0.6444645524024963,-0.5144601464271545) 
source_data subject_idx 85 has shape : (91, 17, 384), with range scale (1.1594910621643066,-1.0914311408996582) 
source_data subject_idx 86 has shape : (89, 17, 384), with range scale (0.689849853515625,-0.5512941479682922) 
source_data subject_idx 87 has shape : (114, 17, 384), with range scale (0.4337463974952698,-0.4795781373977661) 
source_data subject_idx 88 has shape : (90, 17, 384), with range scale (0.9034557938575745,-0.9589319825172424) 
source_data subject_idx 89 has shape : (90, 17, 384), with range scale (0.8137968182563782,-0.9145379066467285) 
source_data subject_idx 90 has shape : (90, 17, 384), with range scale (0.7387031316757202,-0.7604924440383911) 
source_data subject_idx 91 has shape : (111, 17, 384), with range scale (0.5104097127914429,-0.5557769536972046) 
source_data subject_idx 92 has shape : (90, 17, 384), with range scale (0.5296695828437805,-0.39493680000305176) 
source_data subject_idx 93 has shape : (90, 17, 384), with range scale (0.9362726807594299,-0.5925340056419373) 
source_data subject_idx 94 has shape : (91, 17, 384), with range scale (0.9929652214050293,-1.108001470565796) 
source_data subject_idx 95 has shape : (92, 17, 384), with range scale (0.8198074698448181,-0.7674327492713928) 
source_data subject_idx 96 has shape : (90, 17, 384), with range scale (0.549396276473999,-0.869248628616333) 
source_data subject_idx 97 has shape : (92, 17, 384), with range scale (0.4608597755432129,-0.557570219039917) 
source_data subject_idx 98 has shape : (91, 17, 384), with range scale (1.3270875215530396,-1.2842411994934082) 
source_data subject_idx 99 has shape : (72, 17, 384), with range scale (0.6997339129447937,-0.5448974967002869) 
source_data subject_idx 100 has shape : (88, 17, 384), with range scale (0.3013438582420349,-0.33602175116539) 
source_data subject_idx 101 has shape : (89, 17, 384), with range scale (1.3008520603179932,-1.2512694597244263) 
source_data subject_idx 102 has shape : (90, 17, 384), with range scale (0.6922404766082764,-0.739229679107666) 
source_data subject_idx 103 has shape : (88, 17, 384), with range scale (0.45946475863456726,-0.6984744071960449) 
source_data subject_idx 104 has shape : (89, 17, 384), with range scale (0.5780012607574463,-0.45048871636390686) 
source_data subject_idx 105 has shape : (91, 17, 384), with range scale (0.5554128289222717,-0.614891767501831) 
source_data subject_idx 106 has shape : (92, 17, 384), with range scale (0.7811171412467957,-0.9906891584396362) 
source_data subject_idx 107 has shape : (90, 17, 384), with range scale (0.6523552536964417,-0.6484967470169067) 
source_data subject_idx 108 has shape : (90, 17, 384), with range scale (0.9993579983711243,-1.1295974254608154) 
source dataset idx :  2
run custom EA
generate new r_op
source_data subject_idx 0 has shape : (576, 17, 384), with range scale (0.716140627861023,-1.0298913717269897) 
source_data subject_idx 1 has shape : (576, 17, 384), with range scale (0.9762287735939026,-0.8352589011192322) 
source_data subject_idx 2 has shape : (576, 17, 384), with range scale (1.0710777044296265,-1.444108009338379) 
source_data subject_idx 3 has shape : (576, 17, 384), with range scale (0.9218441843986511,-1.0728968381881714) 
source_data subject_idx 4 has shape : (576, 17, 384), with range scale (1.322721004486084,-1.6325982809066772) 
source_data subject_idx 5 has shape : (576, 17, 384), with range scale (1.0932258367538452,-0.9982351660728455) 
source_data subject_idx 6 has shape : (576, 17, 384), with range scale (0.454509973526001,-0.45308664441108704) 
source_data subject_idx 7 has shape : (576, 17, 384), with range scale (1.096022129058838,-1.0179657936096191) 
source_data subject_idx 8 has shape : (576, 17, 384), with range scale (0.4593527913093567,-0.49064207077026367) 
only use r-op for subjects [0]
use exist r_op
unlabel data subject_idx 0 has shape : (200, 17, 384), with range scale (0.5421113967895508,-0.6338673233985901) 
Loading trainer: MultiDatasetMCDV1
Params :  FREEZE: False
NAME: deepsleep
PARAMS:
  F1: 8
  F2: 8
  avg_pool_1: 4
  avg_pool_2: 8
  drop_prob: 0.25
  kern_length_1: 64
  kern_length_2: 16
  num_ch: 17
  samples: 384
PRETRAINED: False
PRETRAINED_PATH: 
Building F
Building CommonFeature
Backbone: deepsleep
params set up :  {'kern_length_1': 64, 'kern_length_2': 16, 'num_ch': 17, 'samples': 384, 'F1': 8, 'F2': 8, 'drop_prob': 0.25, 'avg_pool_1': 4, 'avg_pool_2': 8}
pretrain :  False
pretrain path : 
Building Target Classifier
use max norm constraint on last FC
use max norm constraint on last FC
Building SourceClassifiers
source domains label size :  [2, 4, 4]
use max norm constraint on last FC
use max norm constraint on last FC
use max norm constraint on last FC
there is n_step_F :  5
save checkpoint keys :  dict_keys(['epoch', 'global_step', 'pytorch-lightning_version', 'state_dict', 'callbacks', 'optimizer_states', 'lr_schedulers'])
combine predict folder :  /data1/wduong_experiment_data/EEG_Dassl_Lightning//NeurIPS_competition/task_2_final_2/LA_EA/tune/1//no_aug/no_norm/deepsleep_mcdV1/dataset_B_0/model/predict_folder/increment_fold_1/test_fold_1/valid_fold_4
use data manager for domain adaptation
Loading dataset: MultiDataset
data root :  /data1/wduong_experiment_data/EEG_Dassl_Lightning/da_dataset/NeurIPS_competition
dataset dir :  final_MI_B_1
file name :  dataset_B_0/NeurIPS_TL.mat
r_op file path :  /data1/wduong_experiment_data/EEG_Dassl_Lightning/da_dataset/NeurIPS_competition/final_MI_B_1/dataset_B_0/dataset_B_0_r_op.mat

there is test file 
run custom EA
only use r-op for subjects [0]
only use r-op for subjects [0]
only use r-op for subjects [0]
use exist r_op
use exist r_op
use exist r_op
train subjects :  [0]
Train subject 0 has shape : (96, 1, 17, 384), with range scale (0.9934844374656677,-0.9528900980949402) 
test subjects :  [0]
test subject 0 has shape : (24, 1, 17, 384), with range scale (0.39506351947784424,-0.4846454858779907)  
valid subjects :  [0]
valid subject 0 has shape : (24, 1, 17, 384), with range scale (0.39506351947784424,-0.4846454858779907)  
the labels ratio of whole dataset : [4.0, 3.4285714285714284, 4.363636363636363, 4.363636363636363]
source dataset idx :  0
run custom EA
generate new r_op
source_data subject_idx 0 has shape : (200, 17, 384), with range scale (2.8882222175598145,-3.0118398666381836) 
source_data subject_idx 1 has shape : (200, 17, 384), with range scale (2.012194871902466,-1.471892237663269) 
source_data subject_idx 2 has shape : (200, 17, 384), with range scale (0.39883995056152344,-0.47107645869255066) 
source_data subject_idx 3 has shape : (200, 17, 384), with range scale (0.633466899394989,-0.8988378643989563) 
source_data subject_idx 4 has shape : (200, 17, 384), with range scale (1.3011571168899536,-1.2901395559310913) 
source_data subject_idx 5 has shape : (200, 17, 384), with range scale (0.6116749048233032,-0.5340460538864136) 
source_data subject_idx 6 has shape : (240, 17, 384), with range scale (1.6593918800354004,-1.945071816444397) 
source_data subject_idx 7 has shape : (200, 17, 384), with range scale (0.52070552110672,-0.6748800277709961) 
source_data subject_idx 8 has shape : (240, 17, 384), with range scale (0.9757770895957947,-0.611278235912323) 
source_data subject_idx 9 has shape : (200, 17, 384), with range scale (0.7230930924415588,-0.6379406452178955) 
source_data subject_idx 10 has shape : (200, 17, 384), with range scale (2.196751594543457,-2.3680875301361084) 
source_data subject_idx 11 has shape : (200, 17, 384), with range scale (0.5474781394004822,-0.4567890167236328) 
source_data subject_idx 12 has shape : (200, 17, 384), with range scale (0.34184280037879944,-0.3546203076839447) 
source_data subject_idx 13 has shape : (200, 17, 384), with range scale (0.4874683618545532,-0.5128428936004639) 
source_data subject_idx 14 has shape : (200, 17, 384), with range scale (0.6301130056381226,-0.5653321743011475) 
source_data subject_idx 15 has shape : (200, 17, 384), with range scale (0.843874990940094,-0.9753001928329468) 
source_data subject_idx 16 has shape : (200, 17, 384), with range scale (0.6573670506477356,-0.6639305353164673) 
source_data subject_idx 17 has shape : (200, 17, 384), with range scale (1.275315761566162,-1.3497552871704102) 
source_data subject_idx 18 has shape : (200, 17, 384), with range scale (1.5794085264205933,-1.4551502466201782) 
source_data subject_idx 19 has shape : (200, 17, 384), with range scale (0.5881903171539307,-0.5797205567359924) 
source_data subject_idx 20 has shape : (200, 17, 384), with range scale (1.0885236263275146,-0.7935687303543091) 
source_data subject_idx 21 has shape : (200, 17, 384), with range scale (1.9916812181472778,-1.3703601360321045) 
source_data subject_idx 22 has shape : (200, 17, 384), with range scale (1.3182650804519653,-1.0296597480773926) 
source_data subject_idx 23 has shape : (200, 17, 384), with range scale (0.9592158198356628,-0.9697363376617432) 
source_data subject_idx 24 has shape : (200, 17, 384), with range scale (1.1470407247543335,-1.1388038396835327) 
source_data subject_idx 25 has shape : (200, 17, 384), with range scale (2.2241201400756836,-2.4356601238250732) 
source_data subject_idx 26 has shape : (200, 17, 384), with range scale (1.592162847518921,-1.2840940952301025) 
source_data subject_idx 27 has shape : (200, 17, 384), with range scale (1.3226505517959595,-1.0074076652526855) 
source_data subject_idx 28 has shape : (200, 17, 384), with range scale (1.7132503986358643,-1.5864579677581787) 
source_data subject_idx 29 has shape : (200, 17, 384), with range scale (0.5230404138565063,-0.6324833035469055) 
source_data subject_idx 30 has shape : (200, 17, 384), with range scale (0.49305006861686707,-0.4982423782348633) 
source_data subject_idx 31 has shape : (200, 17, 384), with range scale (0.588959276676178,-0.8800286650657654) 
source_data subject_idx 32 has shape : (200, 17, 384), with range scale (0.7126017808914185,-0.9526523351669312) 
source_data subject_idx 33 has shape : (200, 17, 384), with range scale (2.3252944946289062,-2.73030161857605) 
source_data subject_idx 34 has shape : (200, 17, 384), with range scale (2.032393217086792,-2.653068780899048) 
source_data subject_idx 35 has shape : (200, 17, 384), with range scale (2.496364116668701,-2.437655448913574) 
source_data subject_idx 36 has shape : (200, 17, 384), with range scale (1.0227330923080444,-0.7400245666503906) 
source_data subject_idx 37 has shape : (200, 17, 384), with range scale (0.5067989230155945,-0.5049859285354614) 
source_data subject_idx 38 has shape : (200, 17, 384), with range scale (1.0809292793273926,-1.2355200052261353) 
source_data subject_idx 39 has shape : (200, 17, 384), with range scale (0.7384615540504456,-0.7018154859542847) 
source_data subject_idx 40 has shape : (200, 17, 384), with range scale (1.3897559642791748,-1.1106163263320923) 
source_data subject_idx 41 has shape : (200, 17, 384), with range scale (0.47946929931640625,-0.5571277737617493) 
source_data subject_idx 42 has shape : (200, 17, 384), with range scale (1.4097098112106323,-1.0699217319488525) 
source_data subject_idx 43 has shape : (200, 17, 384), with range scale (1.3387291431427002,-1.1521470546722412) 
source_data subject_idx 44 has shape : (200, 17, 384), with range scale (0.8694338798522949,-0.8605979084968567) 
source_data subject_idx 45 has shape : (200, 17, 384), with range scale (0.9423102140426636,-0.885471522808075) 
source_data subject_idx 46 has shape : (200, 17, 384), with range scale (1.4963183403015137,-1.6483010053634644) 
source_data subject_idx 47 has shape : (200, 17, 384), with range scale (1.4078161716461182,-1.5489822626113892) 
source_data subject_idx 48 has shape : (200, 17, 384), with range scale (1.2182726860046387,-0.811068594455719) 
source dataset idx :  1
run custom EA
generate new r_op
source_data subject_idx 0 has shape : (92, 17, 384), with range scale (0.7169162034988403,-0.6664949655532837) 
source_data subject_idx 1 has shape : (89, 17, 384), with range scale (0.7367219924926758,-0.9459208250045776) 
source_data subject_idx 2 has shape : (92, 17, 384), with range scale (0.9302616119384766,-0.9795837998390198) 
source_data subject_idx 3 has shape : (91, 17, 384), with range scale (0.691114604473114,-0.7401592135429382) 
source_data subject_idx 4 has shape : (88, 17, 384), with range scale (0.9459317922592163,-1.1025806665420532) 
source_data subject_idx 5 has shape : (92, 17, 384), with range scale (0.8528969287872314,-1.0217312574386597) 
source_data subject_idx 6 has shape : (91, 17, 384), with range scale (0.5388573408126831,-0.5337445735931396) 
source_data subject_idx 7 has shape : (89, 17, 384), with range scale (1.4369562864303589,-1.223192811012268) 
source_data subject_idx 8 has shape : (91, 17, 384), with range scale (0.4977075457572937,-0.4644436240196228) 
source_data subject_idx 9 has shape : (91, 17, 384), with range scale (0.42410993576049805,-0.552099883556366) 
source_data subject_idx 10 has shape : (91, 17, 384), with range scale (1.1383635997772217,-1.4176443815231323) 
source_data subject_idx 11 has shape : (89, 17, 384), with range scale (1.0658844709396362,-0.8994742631912231) 
source_data subject_idx 12 has shape : (91, 17, 384), with range scale (0.6188948750495911,-0.6889960765838623) 
source_data subject_idx 13 has shape : (88, 17, 384), with range scale (0.3236307203769684,-0.4282187223434448) 
source_data subject_idx 14 has shape : (91, 17, 384), with range scale (0.41625848412513733,-0.5230375528335571) 
source_data subject_idx 15 has shape : (88, 17, 384), with range scale (0.4929223954677582,-0.5623812675476074) 
source_data subject_idx 16 has shape : (89, 17, 384), with range scale (0.88502037525177,-1.196359634399414) 
source_data subject_idx 17 has shape : (90, 17, 384), with range scale (0.46859344840049744,-0.48558470606803894) 
source_data subject_idx 18 has shape : (91, 17, 384), with range scale (0.4752838909626007,-0.45331206917762756) 
source_data subject_idx 19 has shape : (90, 17, 384), with range scale (0.6349341869354248,-0.7902240753173828) 
source_data subject_idx 20 has shape : (90, 17, 384), with range scale (0.4959060847759247,-0.5121389627456665) 
source_data subject_idx 21 has shape : (91, 17, 384), with range scale (0.6096289753913879,-0.7651546597480774) 
source_data subject_idx 22 has shape : (89, 17, 384), with range scale (0.8464249968528748,-0.8947135210037231) 
source_data subject_idx 23 has shape : (90, 17, 384), with range scale (0.7144237160682678,-0.8370522260665894) 
source_data subject_idx 24 has shape : (88, 17, 384), with range scale (0.9057577848434448,-1.0708329677581787) 
source_data subject_idx 25 has shape : (93, 17, 384), with range scale (0.7831981778144836,-0.7814754247665405) 
source_data subject_idx 26 has shape : (91, 17, 384), with range scale (1.2667361497879028,-1.2867064476013184) 
source_data subject_idx 27 has shape : (89, 17, 384), with range scale (0.715073823928833,-0.8704080581665039) 
source_data subject_idx 28 has shape : (91, 17, 384), with range scale (0.823622465133667,-0.7710578441619873) 
source_data subject_idx 29 has shape : (90, 17, 384), with range scale (1.7067055702209473,-1.362501621246338) 
source_data subject_idx 30 has shape : (89, 17, 384), with range scale (0.42109474539756775,-0.5971027612686157) 
source_data subject_idx 31 has shape : (89, 17, 384), with range scale (1.1272733211517334,-0.9254766702651978) 
source_data subject_idx 32 has shape : (91, 17, 384), with range scale (0.4515339732170105,-0.49986064434051514) 
source_data subject_idx 33 has shape : (89, 17, 384), with range scale (0.8349516987800598,-0.8060201406478882) 
source_data subject_idx 34 has shape : (88, 17, 384), with range scale (0.5930517911911011,-0.667640209197998) 
source_data subject_idx 35 has shape : (91, 17, 384), with range scale (1.008338451385498,-1.0509880781173706) 
source_data subject_idx 36 has shape : (91, 17, 384), with range scale (0.593373715877533,-0.5770897269248962) 
source_data subject_idx 37 has shape : (90, 17, 384), with range scale (0.3337509334087372,-0.3894091546535492) 
source_data subject_idx 38 has shape : (90, 17, 384), with range scale (0.5131454467773438,-0.39244702458381653) 
source_data subject_idx 39 has shape : (89, 17, 384), with range scale (0.8909652233123779,-1.5867822170257568) 
source_data subject_idx 40 has shape : (91, 17, 384), with range scale (0.6203176379203796,-0.5695602893829346) 
source_data subject_idx 41 has shape : (88, 17, 384), with range scale (0.9914578795433044,-0.6623650789260864) 
source_data subject_idx 42 has shape : (90, 17, 384), with range scale (1.3082313537597656,-1.2687772512435913) 
source_data subject_idx 43 has shape : (89, 17, 384), with range scale (0.39732423424720764,-0.4900325536727905) 
source_data subject_idx 44 has shape : (89, 17, 384), with range scale (0.8021134734153748,-1.0494554042816162) 
source_data subject_idx 45 has shape : (91, 17, 384), with range scale (0.6604734063148499,-0.5932362079620361) 
source_data subject_idx 46 has shape : (91, 17, 384), with range scale (0.5637867450714111,-0.6177029609680176) 
source_data subject_idx 47 has shape : (88, 17, 384), with range scale (0.6126500964164734,-0.6881211400032043) 
source_data subject_idx 48 has shape : (92, 17, 384), with range scale (0.9746087789535522,-0.9049380421638489) 
source_data subject_idx 49 has shape : (89, 17, 384), with range scale (0.7907715439796448,-1.0917167663574219) 
source_data subject_idx 50 has shape : (93, 17, 384), with range scale (1.0379266738891602,-1.188753366470337) 
source_data subject_idx 51 has shape : (92, 17, 384), with range scale (0.7975730895996094,-0.8419255018234253) 
source_data subject_idx 52 has shape : (89, 17, 384), with range scale (0.9716087579727173,-0.8925856351852417) 
source_data subject_idx 53 has shape : (90, 17, 384), with range scale (0.7912880182266235,-0.8501782417297363) 
source_data subject_idx 54 has shape : (90, 17, 384), with range scale (0.4885285794734955,-0.3597244322299957) 
source_data subject_idx 55 has shape : (89, 17, 384), with range scale (0.9037812352180481,-0.7423575520515442) 
source_data subject_idx 56 has shape : (92, 17, 384), with range scale (1.4165902137756348,-0.8528302907943726) 
source_data subject_idx 57 has shape : (91, 17, 384), with range scale (0.8686171770095825,-1.0360792875289917) 
source_data subject_idx 58 has shape : (92, 17, 384), with range scale (1.8695253133773804,-0.7935270071029663) 
source_data subject_idx 59 has shape : (92, 17, 384), with range scale (0.5022420287132263,-0.5183480978012085) 
source_data subject_idx 60 has shape : (88, 17, 384), with range scale (0.8774799704551697,-0.8143843412399292) 
source_data subject_idx 61 has shape : (90, 17, 384), with range scale (0.4195600748062134,-0.5917611122131348) 
source_data subject_idx 62 has shape : (90, 17, 384), with range scale (2.23943829536438,-1.4211475849151611) 
source_data subject_idx 63 has shape : (91, 17, 384), with range scale (0.5610853433609009,-0.5430169701576233) 
source_data subject_idx 64 has shape : (92, 17, 384), with range scale (0.6622500419616699,-0.6672776341438293) 
source_data subject_idx 65 has shape : (90, 17, 384), with range scale (1.1588901281356812,-1.3947761058807373) 
source_data subject_idx 66 has shape : (89, 17, 384), with range scale (1.156064748764038,-1.1673425436019897) 
source_data subject_idx 67 has shape : (90, 17, 384), with range scale (0.7678646445274353,-0.5782241821289062) 
source_data subject_idx 68 has shape : (92, 17, 384), with range scale (0.4321843385696411,-0.5818220376968384) 
source_data subject_idx 69 has shape : (89, 17, 384), with range scale (1.0627270936965942,-1.1566270589828491) 
source_data subject_idx 70 has shape : (89, 17, 384), with range scale (1.0456321239471436,-0.9711074829101562) 
source_data subject_idx 71 has shape : (90, 17, 384), with range scale (1.066978096961975,-1.185381531715393) 
source_data subject_idx 72 has shape : (90, 17, 384), with range scale (0.5864176154136658,-0.5077543258666992) 
source_data subject_idx 73 has shape : (91, 17, 384), with range scale (0.6305578947067261,-0.7793805003166199) 
source_data subject_idx 74 has shape : (91, 17, 384), with range scale (0.6688997149467468,-0.7725189328193665) 
source_data subject_idx 75 has shape : (90, 17, 384), with range scale (0.3052671551704407,-0.37482795119285583) 
source_data subject_idx 76 has shape : (89, 17, 384), with range scale (0.7272578477859497,-0.6320812106132507) 
source_data subject_idx 77 has shape : (91, 17, 384), with range scale (1.5900516510009766,-1.3911101818084717) 
source_data subject_idx 78 has shape : (91, 17, 384), with range scale (0.6965444087982178,-0.5931110382080078) 
source_data subject_idx 79 has shape : (89, 17, 384), with range scale (1.467740535736084,-1.0494499206542969) 
source_data subject_idx 80 has shape : (90, 17, 384), with range scale (0.9545451402664185,-1.0810126066207886) 
source_data subject_idx 81 has shape : (89, 17, 384), with range scale (0.6345996260643005,-0.7612450122833252) 
source_data subject_idx 82 has shape : (90, 17, 384), with range scale (0.8933464884757996,-0.9619231820106506) 
source_data subject_idx 83 has shape : (91, 17, 384), with range scale (0.8108646869659424,-1.161116123199463) 
source_data subject_idx 84 has shape : (90, 17, 384), with range scale (0.6444645524024963,-0.5144601464271545) 
source_data subject_idx 85 has shape : (91, 17, 384), with range scale (1.1594910621643066,-1.0914311408996582) 
source_data subject_idx 86 has shape : (89, 17, 384), with range scale (0.689849853515625,-0.5512941479682922) 
source_data subject_idx 87 has shape : (114, 17, 384), with range scale (0.4337463974952698,-0.4795781373977661) 
source_data subject_idx 88 has shape : (90, 17, 384), with range scale (0.9034557938575745,-0.9589319825172424) 
source_data subject_idx 89 has shape : (90, 17, 384), with range scale (0.8137968182563782,-0.9145379066467285) 
source_data subject_idx 90 has shape : (90, 17, 384), with range scale (0.7387031316757202,-0.7604924440383911) 
source_data subject_idx 91 has shape : (111, 17, 384), with range scale (0.5104097127914429,-0.5557769536972046) 
source_data subject_idx 92 has shape : (90, 17, 384), with range scale (0.5296695828437805,-0.39493680000305176) 
source_data subject_idx 93 has shape : (90, 17, 384), with range scale (0.9362726807594299,-0.5925340056419373) 
source_data subject_idx 94 has shape : (91, 17, 384), with range scale (0.9929652214050293,-1.108001470565796) 
source_data subject_idx 95 has shape : (92, 17, 384), with range scale (0.8198074698448181,-0.7674327492713928) 
source_data subject_idx 96 has shape : (90, 17, 384), with range scale (0.549396276473999,-0.869248628616333) 
source_data subject_idx 97 has shape : (92, 17, 384), with range scale (0.4608597755432129,-0.557570219039917) 
source_data subject_idx 98 has shape : (91, 17, 384), with range scale (1.3270875215530396,-1.2842411994934082) 
source_data subject_idx 99 has shape : (72, 17, 384), with range scale (0.6997339129447937,-0.5448974967002869) 
source_data subject_idx 100 has shape : (88, 17, 384), with range scale (0.3013438582420349,-0.33602175116539) 
source_data subject_idx 101 has shape : (89, 17, 384), with range scale (1.3008520603179932,-1.2512694597244263) 
source_data subject_idx 102 has shape : (90, 17, 384), with range scale (0.6922404766082764,-0.739229679107666) 
source_data subject_idx 103 has shape : (88, 17, 384), with range scale (0.45946475863456726,-0.6984744071960449) 
source_data subject_idx 104 has shape : (89, 17, 384), with range scale (0.5780012607574463,-0.45048871636390686) 
source_data subject_idx 105 has shape : (91, 17, 384), with range scale (0.5554128289222717,-0.614891767501831) 
source_data subject_idx 106 has shape : (92, 17, 384), with range scale (0.7811171412467957,-0.9906891584396362) 
source_data subject_idx 107 has shape : (90, 17, 384), with range scale (0.6523552536964417,-0.6484967470169067) 
source_data subject_idx 108 has shape : (90, 17, 384), with range scale (0.9993579983711243,-1.1295974254608154) 
source dataset idx :  2
run custom EA
generate new r_op
source_data subject_idx 0 has shape : (576, 17, 384), with range scale (0.716140627861023,-1.0298913717269897) 
source_data subject_idx 1 has shape : (576, 17, 384), with range scale (0.9762287735939026,-0.8352589011192322) 
source_data subject_idx 2 has shape : (576, 17, 384), with range scale (1.0710777044296265,-1.444108009338379) 
source_data subject_idx 3 has shape : (576, 17, 384), with range scale (0.9218441843986511,-1.0728968381881714) 
source_data subject_idx 4 has shape : (576, 17, 384), with range scale (1.322721004486084,-1.6325982809066772) 
source_data subject_idx 5 has shape : (576, 17, 384), with range scale (1.0932258367538452,-0.9982351660728455) 
source_data subject_idx 6 has shape : (576, 17, 384), with range scale (0.454509973526001,-0.45308664441108704) 
source_data subject_idx 7 has shape : (576, 17, 384), with range scale (1.096022129058838,-1.0179657936096191) 
source_data subject_idx 8 has shape : (576, 17, 384), with range scale (0.4593527913093567,-0.49064207077026367) 
only use r-op for subjects [0]
use exist r_op
unlabel data subject_idx 0 has shape : (200, 17, 384), with range scale (0.5421113967895508,-0.6338673233985901) 
Loading trainer: MultiDatasetMCDV1
Params :  FREEZE: False
NAME: deepsleep
PARAMS:
  F1: 8
  F2: 8
  avg_pool_1: 4
  avg_pool_2: 8
  drop_prob: 0.25
  kern_length_1: 64
  kern_length_2: 16
  num_ch: 17
  samples: 384
PRETRAINED: False
PRETRAINED_PATH: 
Building F
Building CommonFeature
Backbone: deepsleep
params set up :  {'kern_length_1': 64, 'kern_length_2': 16, 'num_ch': 17, 'samples': 384, 'F1': 8, 'F2': 8, 'drop_prob': 0.25, 'avg_pool_1': 4, 'avg_pool_2': 8}
pretrain :  False
pretrain path : 
Building Target Classifier
use max norm constraint on last FC
use max norm constraint on last FC
Building SourceClassifiers
source domains label size :  [2, 4, 4]
use max norm constraint on last FC
use max norm constraint on last FC
use max norm constraint on last FC
there is n_step_F :  5
save checkpoint keys :  dict_keys(['epoch', 'global_step', 'pytorch-lightning_version', 'state_dict', 'callbacks', 'optimizer_states', 'lr_schedulers'])
combine predict folder :  /data1/wduong_experiment_data/EEG_Dassl_Lightning//NeurIPS_competition/task_2_final_2/LA_EA/tune/1//no_aug/no_norm/deepsleep_mcdV1/dataset_B_0/model/predict_folder/increment_fold_1/test_fold_1/valid_fold_5
